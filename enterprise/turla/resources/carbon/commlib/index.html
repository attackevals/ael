<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-H74RC38PBM"></script>
    <script data-cfasync="false">window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-H74RC38PBM');</script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="turbo-root" content="/ael">
    <meta name="turbo-cache-control" content="no-cache" data-turbo-track="reload" data-track-token="3.6.0.785352632664">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 3.6.0">

    <!-- Primary Meta Tags -->
    <title>CommLibDLL</title>
    <meta name="title" content="CommLibDLL">
    <meta name="description" content="This library will be injected into a Windows process and used to communication with the C2 server.">

    <!-- Canonical -->
    <link rel="canonical" href="https://attackevals.github.io/ael/enterprise/turla/resources/carbon/commlib/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://attackevals.github.io/ael/enterprise/turla/resources/carbon/commlib/">
    <meta property="og:title" content="CommLibDLL">
    <meta property="og:description" content="This library will be injected into a Windows process and used to communication with the C2 server.">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://attackevals.github.io/ael/enterprise/turla/resources/carbon/commlib/">
    <meta property="twitter:title" content="CommLibDLL">
    <meta property="twitter:description" content="This library will be injected into a Windows process and used to communication with the C2 server.">

    <script data-cfasync="false">(function () { var el = document.documentElement, m = localStorage.getItem("doc_theme"), wm = window.matchMedia; if (m === "dark" || (!m && wm && wm("(prefers-color-scheme: dark)").matches)) { el.classList.add("dark") } else { el.classList.remove("dark") } })();</script>

    <link href="../../../../../favicon.png" rel="icon">
    <link href="../../../../../resources/css/retype.css?v=3.6.0.785352632664" rel="stylesheet">

    <script data-cfasync="false" src="../../../../../resources/js/config.js?v=3.6.0.785352632664" data-turbo-eval="false" defer></script>
    <script data-cfasync="false" src="../../../../../resources/js/retype.js?v=3.6.0" data-turbo-eval="false" defer></script>
    <script id="lunr-js" data-cfasync="false" src="../../../../../resources/js/lunr.js?v=3.6.0.785352632664" data-turbo-eval="false" defer></script>
</head>
<body>
    <div id="docs-app" class="relative text-base antialiased text-gray-700 bg-white font-body dark:bg-dark-850 dark:text-dark-300">
        <div class="absolute bottom-0 left-0 bg-gray-100 dark:bg-dark-800" style="top: 5rem; right: 50%"></div>
    
        <header id="docs-site-header" class="sticky top-0 z-30 flex w-full h-16 bg-white border-b border-gray-200 md:h-20 dark:bg-dark-850 dark:border-dark-650">
            <div class="container relative flex items-center justify-between pr-6 grow md:justify-start">
                <!-- Mobile menu button skeleton -->
                <button v-cloak class="skeleton docs-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
                <div v-cloak id="docs-sidebar-toggle"></div>
        
                <!-- Logo -->
                <div class="flex items-center justify-between h-full py-2 md:w-75">
                    <div class="flex items-center px-2 md:px-6">
                        <a id="docs-site-logo" href="../../../../../" class="flex items-center leading-snug text-xl">
                            <span class="w-10 mr-2 grow-0 shrink-0 overflow-hidden">
                                <img class="max-h-10 dark:hidden md:inline-block" src="../../../../../images/attackevals-logo.png">
                                <img class="max-h-10 hidden dark:inline-block" src="../../../../../images/attackevals-logo.png">
                            </span>
                            <span class="dark:text-white font-semibold line-clamp-1 md:line-clamp-2">ATTACK Evaluation Library</span>
                        </a>
                    </div>
        
                    <span class="hidden h-8 border-r md:inline-block dark:border-dark-650"></span>
                </div>
        
                <div class="flex justify-between md:grow">
                    <!-- Top Nav -->
                    <nav class="hidden md:flex">
                        <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://attackevals.mitre-engenuity.org">Attack Evaluations</a>
                            </li>
        
                        </ul>
                    </nav>
        
                    <!-- Header Right Skeleton -->
                    <div v-cloak class="flex justify-end grow skeleton">
        
                        <!-- Search input mock -->
                        <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                            <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                            </div>
                            <input class="w-full h-10 placeholder-gray-400 transition-colors duration-200 ease-in bg-gray-200 border border-transparent rounded md:text-sm hover:bg-white hover:border-gray-300 focus:outline-none focus:bg-white focus:border-gray-500 dark:bg-dark-600 dark:border-dark-600 dark:placeholder-dark-400" style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search">
                        </div>
        
                        <!-- Mobile search button -->
                        <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                        </div>
        
                        <!-- Dark mode switch placeholder -->
                        <div class="w-10 h-10 lg:ml-2"></div>
        
                        <!-- History button -->
                        <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                        </div>
                    </div>
        
                    <div v-cloak class="flex justify-end grow">
                        <div id="docs-mobile-search-button"></div>
                        <doc-search-desktop></doc-search-desktop>
        
                        <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                        <doc-history></doc-history>
                    </div>
                </div>
            </div>
        </header>
    
        <div class="container relative flex bg-white">
            <!-- Sidebar Skeleton -->
            <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-gray-100 border-gray-200 sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton dark:bg-dark-800 dark:border-dark-650">
            
                <!-- Render this div, if config.showSidebarFilter is `true` -->
                <div class="flex items-center h-16 px-6">
                    <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-white border border-gray-200 rounded shadow-none text-sm focus:outline-none focus:border-gray-600 dark:bg-dark-600 dark:border-dark-600" type="text" placeholder="Filter">
                </div>
            
                <div class="pl-6 mt-1 mb-4">
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                </div>
            
            </div>
            
            <!-- Sidebar component -->
            <doc-sidebar v-cloak>
                <template #sidebar-footer>
                    <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-dark-650">
            
                        <div class="py-3 px-6 md:hidden border-b dark:border-dark-650">
                            <nav>
                                <ul class="flex flex-wrap justify-center items-center">
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://attackevals.mitre-engenuity.org">Attack Evaluations</a>
                                    </li>
            
                                </ul>
                            </nav>
                        </div>
                    </div>
                </template>
            </doc-sidebar>
    
            <div class="grow min-w-0 dark:bg-dark-850">
                <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
                <div class="flex">
                    <div class="min-w-0 p-4 grow md:px-16">
                        <main class="relative pb-12 lg:pt-2">
                            <div class="docs-markdown" id="docs-content">
                                <!-- Rendered if sidebar right is enabled -->
                                <div id="docs-sidebar-right-toggle"></div>
                                <nav class="breadcrumb" aria-label="Breadcrumb">
                                    <ol role="list">
                                        <li class="pr-4">
                                            <a href="../../../../../" class="pr-4">
                                                ATT&​CK Evaluations Library
                                            </a>
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                                                <path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                            </svg>
                                        </li>
                                        <li class="pr-4">
                                            <span class="pr-4">
                                                Enterprise
                                            </span>
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                                                <path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                            </svg>
                                        </li>
                                        <li class="pr-4">
                                            <a href="../../../../../enterprise/turla/" class="pr-4">
                                                Turla
                                            </a>
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                                                <path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                            </svg>
                                        </li>
                                        <li class="pr-4">
                                            <a href="../../../../../enterprise/turla/resources/" class="pr-4">
                                                Resources
                                            </a>
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                                                <path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                            </svg>
                                        </li>
                                        <li class="pr-4">
                                            <a href="../../../../../enterprise/turla/resources/carbon/" class="pr-4">
                                                Carbon DLL
                                            </a>
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                                                <path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                            </svg>
                                        </li>
                                        <li class="pr-4">
                                            <a href="../../../../../enterprise/turla/resources/carbon/commlib/" class="pr-4">
                                                Comm​Lib​DLL
                                            </a>
                                        </li>
                                    </ol>
                                </nav>
                
                                <!-- Page content  -->
<doc-anchor-target id="commlibdll" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#commlibdll">#</doc-anchor-trigger>
        <span>CommLibDLL</span>
    </h1>
</doc-anchor-target>
<div class="-mt-3 mb-12 flex flex-wrap text-sm text-gray-400 dark:text-dark-350 items-center">
    <div>In&nbsp;</div>
    <div><a href="../../categories/enterprise/">enterprise</a></div>
</div>

<doc-anchor-target id="overview">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#overview">#</doc-anchor-trigger>
        <span>Overview</span>
    </h2>
</doc-anchor-target>
<p>This library will be injected into a Windows process and used to communication with the C2 server. Communication may be direct, or be routed through a different instance of this library on a seperate computer. The messages received from the C2 server are primarily tasks from the C2 server, which are stored in a file for the Carbon Orchestrator to run. This library also checks for task results from the Orchestrator and sends those results to the C2 server.</p>
<doc-anchor-target id="c2-communications">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#c2-communications">#</doc-anchor-trigger>
        <span>C2 Communications</span>
    </h2>
</doc-anchor-target>
<p>The communication library DLL supports two modes of communication with the C2:</p>
<ul>
<li>direct C2 channel using HTTP</li>
<li>peer-to-peer C2 communication using named pipes</li>
</ul>
<doc-anchor-target id="http-communications">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#http-communications">#</doc-anchor-trigger>
        <span>HTTP Communications</span>
    </h3>
</doc-anchor-target>
<p>The library module will determine the C2 server address, port, and URL path from the options provided in the config file.
A heartbeat request is sent to the C2 addr/url to check that the server is alive. If alive, the module will then use the <code v-pre>PHPSESSID</code> cookie in future requests with the appropriate implant ID value to tell the C2 server who the beacon is for.</p>
<p>HTTP <code v-pre>GET</code> requests are sent to request tasking, and <code v-pre>POST</code> requests are used to send task output.</p>
<p>For tasking, the server will send an HTML response with the base64-encoded encrypted task information placed as the <code v-pre>value</code> HTML tag value. The task information will contain payload and command information, which the module will use to do the following:</p>
<ul>
<li>write the payload to disk at the specific location (if a payload is provided)</li>
<li>build a task config file containing the payload location (if a payload is provided) and the command to run. The task config file will be placed in the <code v-pre>C:\Program Files\Windows NT\Nlts\a67s3ofc[task id].txt</code> filepath. For instance, if the task id is <code v-pre>15</code>, the config file will be placed in <code v-pre>C:\Program Files\Windows NT\Nlts\a67s3ofc15.txt</code></li>
<li>append the following line to the task list file at <code v-pre>C:\Program Files\Windows NT\0511\workdict.xml</code>:
<ul>
<li><code v-pre>task_id | payload_path (optional) | task_config_path | task_output_path | task_log_path</code></li>
<li>example: <code v-pre>12 | C:\\users\\public\\testpayload | C:\Program Files\Windows NT\Nlts\a67s3ofc15.txt | C:\Program Files\Windows NT\2028\15.yml | C:\Program Files\Windows NT\2028\15.log</code></li>
</ul>
</li>
</ul>
<p>For task output, the comms lib module will look for available task output info in the task output metadata file (configurable during compilation, currently set to <code v-pre>C:\Program Files\Windows NT\2028\traverse.gif</code>). This file contains lines of the following format:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">task_id | num_files (currently only 1 is supported) | path_to_output_file | implant_id</code></pre>
</doc-codeblock></div>
<p>Example:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">15 | 1 | C:\Program Files\Windows NT\2028\15.log | SOMEUUID</code></pre>
</doc-codeblock></div>
<p>The implant will upload the contents of the task output file and clear the task output metadata file.</p>
<doc-anchor-target id="named-pipe-peer-to-peer">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#named-pipe-peer-to-peer">#</doc-anchor-trigger>
        <span>Named Pipe Peer-to-Peer</span>
    </h3>
</doc-anchor-target>
<p>To configure named pipe peer-to-peer options, you can adjust the options under the <code v-pre>[TRANSPORT]</code> section of the main configuration file:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">[TRANSPORT]
system_pipe = dsnap
spstatus = yes
adaptable = no
p2p_client = false
peer_pipe = \\peerhost\pipe\dsnap</code></pre>
</doc-codeblock></div>
<ul>
<li>Currently, <code v-pre>spstatus</code> and <code v-pre>adaptable</code> are not used and can be ignored.</li>
<li><code v-pre>system_pipe</code> refers to the name of the pipe used on all machines for peer-to-peer comms</li>
<li><code v-pre>p2p_client</code> toggles whether or not the implant will use named-pipe p2p or HTTP comms to reach the C2 server. To enable, set the value to <code v-pre>true</code> or <code v-pre>yes</code>.</li>
<li><code v-pre>peer_pipe</code> indicates the full pipe address (including hostname and pipename) of the peer to connect to for named pipe p2p communication. Note that this pipe address must align with whatever the <code v-pre>system_pipe</code> value is for the configuration file of the <strong>peer</strong></li>
</ul>
<p>If the module is running in HTTP comms mode, it will mark itself as available for p2p requests by listening on the pipe specified in <code v-pre>system_pipe</code>. Peers can then connect to this pipe if the address is provided in <code v-pre>peer_pipe</code> in their config file. P2p clients will send beacon requests and task output to p2p listeners, who will then relay this information to the C2 server on behalf of the client, returning any server responses such as tasking and payloads. P2p clients will also listen on their own local named pipe (indicated by <code v-pre>system_pipe</code> for responses from ther peers.</p>
<p>Note that because no usernames/passwords are explicitly used, any pipe connection will be done under the user context of the process running the comms library DLL module. Thus, operators must make sure that the p2p participants can access each other&#x27;s named pipes.</p>
<doc-anchor-target id="encryption">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#encryption">#</doc-anchor-trigger>
        <span>Encryption</span>
    </h2>
</doc-anchor-target>
<p>The comms library module uses CAST-128 encryption with some of its files and C2 communication<sup><a href="https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/" class="outbound" target="_blank"><span>1</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></sup>:</p>
<ul>
<li>CAST-128 encryption is used to encrypt/decrypt certain files on disk:
<ul>
<li>main implant configuration file <code v-pre>C:\Program Files\Windows NT\setuplst.xml</code></li>
<li>the pending task file for the orchestrator to pick up (<code v-pre>C:\Program Files\Windows NT\0511\workdict.xml</code>)</li>
<li>associated task configuration files (<code v-pre>C:\Program Files\Windows NT\Nlts\a67s3ofc[task id].txt</code>)</li>
<li>task output files (<code v-pre>C:\Program Files\Windows NT\2028\[task id].log</code>)</li>
<li>metadata file containing info on task output to submit to the C2 server (<code v-pre>C:\Program Files\Windows NT\2028\traverse.gif</code>)</li>
</ul>
</li>
<li>Named pipe peer-to-peer communication between hosts is encrypted using CAST-128<sup><a href="https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/" class="outbound" target="_blank"><span>1</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></sup></li>
<li>The embedded base64 blob in HTML responses from the C2 server contains a 2-part concatenated ciphertext blob. The first 256 bytes contain an RSA ciphertext, which when decrypted provides a base64-encoded random CAST-128 symmetric key. This key is then used to decrypt the rest of the ciphertext blob, which contains the actual task information. The RSA private key used for the first round of decryption is included in the configuration file and is set to (DER-encoded base64):</li>
</ul>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">MIIEoQIBAAKCAQEAxcvv98NsuX1Fuff9LDyV5fpp/MAbPvIYiMyoups9uhJz7v0E4MRCZQoM6w49rjmMTgsps3TJe8IR/6waEOTzevVBmma2LFd6Q+wlOnfdHFLa2YjCUyY1fvBP+7poc9U/hjf4mLs9hGih8wBUEPZtNYerA/aZM2bwpH7JjTXdQmCZ0Y7WalNn3me+Y9mEXQS16+uxXX3uEjB0zg9J+18H5dDRe40O91pLToAGKw/+s3bs9wuvLw0sArUQusC0T/msUOAawPgUDDv008w1PJblHRnDq6u1R1WD73VjDo1cGd/OfZH166JkVLiOXsrcgYL820cr1BuQuBoMthER5QUs7wIBEQKCAQAdFnYc6Ah1oXsx78NZVDQpWYgOlLi2buV9h4I5j0zXmU1IytsR/r54RT4ikScwNaOxH8JeJ8NG59V4bCHzbPahJBEtS1cGhVW+sck9TdzAZomYdf51o7ySqt6V9cQRCMWTvO/aOacqD2McNMERjaal/Vzp/p4PFqrrA5YcS6+Y0bZRa2DUwrhC4w6O6F+2TTuCeJy8QvYZ4FUc+mOh28c8pAHpvOnPUCI9LD27ksjwvkwzQCQH+8+lIebQuRqmQR/bsphPHJhmAxNiXP2BdfL/WkdkxM9VIKQQyZpjYHa48nlCTop/uu9vyydVr1gkp9OOmPth9nbjk8AAliElbD51AoGBAOJOrCsLobcz2YakqoxLeBbuTjWNnSsC/U5GdG7UMOjW3ZtBFX0TrQMpGmW3r9UH94tWHVrl7iCWsn2BspARw1xAoTYzIvCiYoR51qiFGRrlncmr6WQE+esbgRVJHS+BuDNhr7OxXlE5726OZHvOBlMxK5sFLJ47yh7L0oWdti1zAoGBAN+/ohjrHzIW7KGNAtOgTD2GaVIC5jmScOPCjc9A8Tqlyyk4P8Jh8sW4ny/eRtNGcVt3oJJ5O4dvgnGtvQige3dtgHJz332A97lWsGp6W7w74uFSiAKZFz0umWchrQVIHS9Y/2E8GbbvY63wJG+6OqStPn0BljBwyaEZdN4VoiOVAoGAXS90Ebl+0vc7c603KrWp61MRJRwxqEyGa4ZsLaKqujpbP+2fb7zOxRDswHjP7k6TG0GTneY04D4NQrzvLEOMrYQGJWBZrmD7Y7myvdxzv8f1rWTnoaeyM6Hp25aTjAg8ydzt/rJyIXI1acIpYCeoQF+KbQIhblTawWL8VSLSiy8CgYEAqxoSi4afYooAP0223hErPht9ty9kwp0pJqPV2rkw8JzmpwzldocjD6tMjgRURzXeNuMCUeQ8lL6vC6L594nH08w1DDp9ulOQQm932PQoCGoH2XtY8u2KPdhXML9mMTclYHE7wtObMYni0E45+xXwnAwCm9QJcFY/1Yvv9R+aGzUCgYBSb0kAPXlL7ZkwuTxfbvc10/93Ks8LDd5WaAb+gnTDFhqFGjNYNRsSF3S09oqfoITt0t4ufZfu4uqtDMFfCCmLA6K2J3asFSFV9A57f4NNtNivgMeoJFsWmLiW0obQRCbpQ1DY3AcgYPuiI8sTS0bobizCA3MenIWpyMlXT71VvQ==</code></pre>
</doc-codeblock></div>
<p>Carbon DLL has used a similar encryption setup for C2 responses in the past<sup><a href="https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/" class="outbound" target="_blank"><span>1</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></sup>, with additional components such as an intermediary signature block.</p>
<p>Carbon DLL has used hardcoded encryption keys in the past. For the comms library module, the CAST-128 symmetric key for file encryption is hardcoded as the following (hex-encoded):
<code v-pre>f2d4560891bd948692c28d2a9391e7d9</code></p>
<p>Note that in all cases, CAST-128 encryption was done in CBC mode, and RSA encryption was done with OAEP padding and SHA1 hash.</p>
<p>The 2048-bit RSA public/private key pair used for this implant was generated using Crypto++&#x27;s <code v-pre>GenerateRandomWithKeySize</code> method and then
encoded to DER format. To convert from DER to PEM format, you can use the following <code v-pre>openssl</code> commands:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">openssl rsa -RSAPublicKey_in -in rsa-public.key -inform DER -outform PEM -out public.pem -pubout
openssl rsa -in rsa-private.key -inform DER -outform PEM -out private.pem

# Used in c2 handler
openssl pkey -in private.pem -traditional -out privatepkcs1.pem</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="logging">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#logging">#</doc-anchor-trigger>
        <span>Logging</span>
    </h2>
</doc-anchor-target>
<p>To assist operators in troubleshooting, the comms lib will log errors and debugging output to the following file on the target host: <code v-pre>C:\Program Files\Windows NT\2028\dsntport.dat</code>. Each log file line is base64-encoded and CAST-128 encrypted with the following format:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">base64(cast128encrypt(log contents))</code></pre>
</doc-codeblock></div>
<p>The CAST-128 encryption key is the same hardcoded key used to encrypt/decrypt other files.</p>
<p>To decrypt the logs on a Linux machine, you can use the <code v-pre>decrypt_logs.py</code> utility:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">python3 decrypt_logs.py -p path/to/commslib/log -o plaintext/output/log/path</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="how-to-run">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#how-to-run">#</doc-anchor-trigger>
        <span>How to Run</span>
    </h2>
</doc-anchor-target>
<p>The primary DLL will be injected into browsers by the Carbon Orchestrator DLL.</p>
<doc-anchor-target id="how-to-perform-cleanup">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#how-to-perform-cleanup">#</doc-anchor-trigger>
        <span>How to Perform Cleanup</span>
    </h2>
</doc-anchor-target>
<p>There is no required cleanup for testing the library. However, for cleaning up Carbon in execution, see the cleanup file at <code v-pre>turla/Resources/cleanup/Carbon/carbon_cleanup.ps1</code>.</p>
<doc-anchor-target id="how-to-build">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#how-to-build">#</doc-anchor-trigger>
        <span>How to Build</span>
    </h2>
</doc-anchor-target>
<p>This program is using CMake to compile and CL compiler for Windows.</p>
<p>The module requires the Crypto++ library to be built and linked at compile-time. <code v-pre>vcpkg</code> was used to install crypto++ for x64-windows, and the installation directory is set as the <code v-pre>VCPKG_ROOT</code> system environment variable.</p>
<doc-anchor-target id="via-commandline">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#via-commandline">#</doc-anchor-trigger>
        <span>Via Commandline</span>
    </h3>
</doc-anchor-target>
<p>Build the comms library DLL using the following cmake commands in administrator Powershell from the <code v-pre>Resources\Carbon\CommLib</code> directory. If you want to adjust certain preprocessor directives for the Carbon home directory, config file path on disk, and finished tasks path directory, you can do so in the compilation command:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">cmake -S . -B build -D CARBON_HOME_DIR=&quot;C:\\Program Files\\Windows NT&quot; -D CONFIG_FILE_PATH=&quot;C:\\Program Files\\Windows NT\\setuplst.xml&quot; -D FINISHED_TASKS_PATH=&quot;C:\\Program Files\\Windows NT\\2028\\traverse.gif&quot;;

cmake --build build --config Release;

cp .\build\src\Release\commlib.dll .\bin\commlib.dll;</code></pre>
</doc-codeblock></div>
<p>To remove symbols, you can use the <code v-pre>strip</code> command:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">strip -s bin\commlib.dll</code></pre>
</doc-codeblock></div>
<p>To verify symbol removal, you can run <code v-pre>strings</code> or <code v-pre>objdump --syms bin\commlib.dll</code> - you should see an empty symbols table.</p>
<p>Note that the above compilation command will also build the unit tests, which you can run via:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">cd build;
ctest --output-on-failure;</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="on-windows-in-vscode-through-visual-studio-tools">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#on-windows-in-vscode-through-visual-studio-tools">#</doc-anchor-trigger>
        <span>On Windows in VSCode Through Visual Studio Tools</span>
    </h3>
</doc-anchor-target>
<ol>
<li>Make sure you have the extentions:
<ul>
<li>CMake</li>
<li>CMake Tools</li>
</ul>
</li>
<li>Setup VSCode to Use MSVC
<ul>
<li>See <a href="https://code.visualstudio.com/docs/cpp/config-msvc">https://code.visualstudio.com/docs/cpp/config-msvc</a></li>
</ul>
<ol>
<li>Install Build Tools for Visual Studio 2022</li>
<li>From the Start Menu, open &quot;Developer Command Prompt for VS 2022&quot;</li>
<li>Navigate to folder with code, then use <code v-pre>code .</code> to open VS Code.</li>
</ol>
<ul>
<li>Alternative option is to setup tasks.json as described on the website. Compiler path in c_cpp_properties.json will also need to change to         &quot;compilerPath&quot;: &quot;C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Tools\MSVC\14.33.31629\bin\Hostx86\x86\cl.exe&quot;</li>
</ul>
</li>
<li>Make sure CMake is installed on your machine
<ul>
<li><code v-pre>choco install cmake --installargs '&quot;ADD_CMAKE_TO_PATH=System&quot;'</code></li>
<li>You will need to restart the shell to use cmake.</li>
<li>If cmake was already installed but not on your path, fully uninstall and install with the above arguments.</li>
</ul>
</li>
<li>Install vcpkg with these commands:
<ol>
<li><code v-pre>cd C:\</code></li>
<li><code v-pre>git clone https://github.com/Microsoft/vcpkg.git</code></li>
<li><code v-pre>cd vcpkg</code></li>
<li><code v-pre>./bootstrap-vcpkg.sh</code></li>
<li><code v-pre>./vcpkg integrate install</code></li>
<li>Set a system level environment variable named <code v-pre>VCKPG_ROOT</code> to the root of your installation directory. For example, <code v-pre>VCPKG_ROOT = C:\Users\dev\vcpkg</code>.</li>
<li>The projects dependencies (cryptopp) will now automatically be installed at build time.</li>
</ol>
</li>
<li>Some settings are required for CMake in VSCode:
<ul>
<li>CMake: CMake Path
<ul>
<li>Set to where ever the cmake executable is located</li>
<li>Mine is at <code v-pre>C:\Program Files\Cmake\bin\cmake.exe</code>.</li>
</ul>
</li>
<li>CMake: Generator
<ul>
<li>Make sure this is empty</li>
</ul>
</li>
</ul>
</li>
<li>In Command Palette, run <code v-pre>CMake: Build</code>. Run on any compiler.</li>
</ol>
<doc-anchor-target id="common-compiling-errors">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#common-compiling-errors">#</doc-anchor-trigger>
        <span>Common Compiling Errors</span>
    </h2>
</doc-anchor-target>
<p>For all problems: start by deleting the build folder than using the <code v-pre>CMake: Delete Cache and Reconfigure</code> command. With most changes below, this is needed to actually register the change.</p>
<ul>
<li>If the compiler complains that &quot;cryptopp::cryptopp&quot; does not exist, change
src/CMakeLists.txt on line 37 and 39 from &quot;cryptopp::cryptopp&quot; to &quot;cryptopp-static&quot;.</li>
<li>If the compilation process says it cannot find cryptopp package, manually install cryptopp on the system with matching compiler triplet.
Example: <code v-pre>vcpkg.exe install cryptopp:x64-windows</code>.</li>
<li>If the compiler complains about a missing external symbol within cryptopp, named something like __std_find_trivial_1, change to a different compiler version. Windows compiler version 17.3 seems to be troublesome with cryptopp, but not always. Do the full refresh described above after the compiler change.</li>
</ul>
<doc-anchor-target id="how-to-test">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#how-to-test">#</doc-anchor-trigger>
        <span>How to Test</span>
    </h2>
</doc-anchor-target>
<p>To setup testing, you must have the C2 server up and running on a seperate machine, and this code must be run from VS Code in administrator mode. The environment variable VCPKG_ROOT must already be set when opening powershell.</p>
<p>Tests are also run through CMake. Make sure CMake is installed with the instructions above.</p>
<p>For the tests to run properly, a C2 server providing tasks needs to be at 10.0.2.11:8080 with a resource at /javascript/view.php. To change the address of the C2 server, edit values in dummyConfigFile.txt and testing.h.</p>
<doc-anchor-target id="on-windows-in-vscode">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#on-windows-in-vscode">#</doc-anchor-trigger>
        <span>On Windows in VSCode</span>
    </h4>
</doc-anchor-target>
<p>In Command Palette, run <code v-pre>CMake: Run Tests</code>.</p>
<doc-anchor-target id="in-a-shell-in-windows-powershell">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#in-a-shell-in-windows-powershell">#</doc-anchor-trigger>
        <span>In a Shell in Windows Powershell</span>
    </h4>
</doc-anchor-target>
<p>Once the package is built, run <code v-pre>$ cd build</code> then <code v-pre>$ ctest</code></p>
<doc-anchor-target id="cti-sources">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#cti-sources">#</doc-anchor-trigger>
        <span>CTI Sources</span>
    </h2>
</doc-anchor-target>
<ol>
<li><a href="https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/">https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/</a></li>
<li><a href="https://www.ncsc.admin.ch/ncsc/en/home/dokumentation/berichte/fachberichte/technical-report_apt_case_ruag.html">https://www.ncsc.admin.ch/ncsc/en/home/dokumentation/berichte/fachberichte/technical-report_apt_case_ruag.html</a></li>
</ol>
<doc-anchor-target id="missing-items">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#missing-items">#</doc-anchor-trigger>
        <span>Missing Items</span>
    </h2>
</doc-anchor-target>
<ul>
<li>Some details differ from the CTI. This includes the checks of other websites before connection to the C2 server. Our version of the communications library also does not execute any commands, always passes them on to the orchestrator.</li>
</ul>
<doc-anchor-target id="external-libraries-and-tools-used">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#external-libraries-and-tools-used">#</doc-anchor-trigger>
        <span>External Libraries and Tools Used</span>
    </h2>
</doc-anchor-target>
<ul>
<li>CMake is used for compilation, which is distributed under the OSI-approved BSD 3-clause License. None of the CMake code is included in the files.</li>
<li>Vcpkg is used but not packaged with this code. The software is managed by Microsoft and licensed under the MIT License, authorizing free use of the software.</li>
</ul>

                                
                                <!-- Required only on API pages -->
                                <doc-toolbar-member-filter-no-results></doc-toolbar-member-filter-no-results>
                            </div>
                            <footer class="clear-both">
                            
                                <nav class="flex mt-14">
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 h-full flex items-center break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-l-lg transition-colors duration-150 relative hover:z-5" href="../../../../../enterprise/turla/resources/carbon/orchestrator/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                            <span>
                                                <span class="block text-xs font-normal text-gray-400 dark:text-dark-400">Previous</span>
                                                <span class="block mt-1">Carbon-​DLL Orchestrator DLL</span>
                                            </span>
                                        </a>
                                    </div>
                            
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 -mx-px h-full flex items-center justify-end break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-r-lg transition-colors duration-150 relative hover:z-5" href="../../../../../enterprise/turla/resources/epic/">
                                            <span>
                                                <span class="block text-xs font-normal text-right text-gray-400 dark:text-dark-400">Next</span>
                                                <span class="block mt-1">EPIC</span>
                                            </span>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19.92 12.38a1 1 0 00-.22-1.09l-7-7a.996.996 0 10-1.41 1.41l5.3 5.3H5c-.55 0-1 .45-1 1s.45 1 1 1h11.59l-5.29 5.29a.996.996 0 000 1.41c.19.2.44.3.7.3s.51-.1.71-.29l7-7c.09-.09.16-.21.21-.33z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        </a>
                                    </div>
                                </nav>
                            </footer>
                        </main>
                
                        <div class="border-t dark:border-dark-650 pt-6 mb-8">
                            <footer class="flex flex-wrap items-center justify-between">
                                <div>
                                    <ul class="flex flex-wrap items-center text-sm">
                                        <li>
                                            <a class="inline-flex items-center mr-4 py-2 text-sm whitespace-nowrap transition-colors duration-200 ease-linear text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 md:mb-0" href="https://github.com/attackevals/ael">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                                    <g fill="currentColor">
                                                        <symbol id="mark-github-icon-symbol" viewBox="0 0 16 16"><path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"/></symbol><use xlink:href="#mark-github-icon-symbol" />
                                                    </g>
                                                </svg>
                                                <span>ATTACK Evaluations Library GitHub</span>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="docs-copyright py-2 text-gray-500 dark:text-dark-350 text-sm leading-relaxed"><p>© Copyright 2024. All rights reserved.</p></div>
                            </footer>
                        </div>
                    </div>
                
                    <!-- Rendered if sidebar right is enabled -->
                    <!-- Sidebar right skeleton-->
                    <div v-cloak class="fixed top-0 bottom-0 right-0 translate-x-full bg-white border-gray-200 lg:sticky lg:border-l lg:shrink-0 lg:pt-6 lg:transform-none sm:w-1/2 lg:w-64 lg:z-0 md:w-104 sidebar-right skeleton dark:bg-dark-850 dark:border-dark-650">
                        <div class="pl-5">
                            <div class="w-32 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-48 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-40 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                        </div>
                    </div>
                
                    <!-- User should be able to hide sidebar right -->
                    <doc-sidebar-right v-cloak></doc-sidebar-right>
                </div>

            </div>
        </div>
    
        <doc-search-mobile></doc-search-mobile>
        <doc-back-to-top></doc-back-to-top>
    </div>


    <div id="docs-overlay-target"></div>

    <script data-cfasync="false">window.__DOCS__ = { "title": "CommLibDLL", level: 5, icon: "file", hasPrism: false, hasMermaid: false, hasMath: false, tocDepth: 23 }</script>
</body>
</html>
