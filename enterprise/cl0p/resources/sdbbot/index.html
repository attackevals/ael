<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ST8G6EL3M2"></script>
    <script data-cfasync="false">window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-ST8G6EL3M2');</script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="turbo-root" content="/ael">
    <meta name="turbo-cache-control" content="no-cache" data-turbo-track="reload" data-track-token="3.6.0.796247571474">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 3.6.0">

    <!-- Primary Meta Tags -->
    <title>SDBBot</title>
    <meta name="title" content="SDBBot">
    <meta name="description" content="SDBBot Diagram">

    <!-- Canonical -->
    <link rel="canonical" href="https://attackevals.github.io/ael/enterprise/cl0p/resources/sdbbot/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://attackevals.github.io/ael/enterprise/cl0p/resources/sdbbot/">
    <meta property="og:title" content="SDBBot">
    <meta property="og:description" content="SDBBot Diagram">
    <meta property="og:image" content="https://attackevals.github.io/ael/enterprise/cl0p/resources/sdbbot/docs/sdbbot.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://attackevals.github.io/ael/enterprise/cl0p/resources/sdbbot/">
    <meta property="twitter:title" content="SDBBot">
    <meta property="twitter:description" content="SDBBot Diagram">
    <meta property="twitter:image" content="https://attackevals.github.io/ael/enterprise/cl0p/resources/sdbbot/docs/sdbbot.png">

    <script data-cfasync="false">(function () { var el = document.documentElement, m = localStorage.getItem("doc_theme"), wm = window.matchMedia; if (m === "dark" || (!m && wm && wm("(prefers-color-scheme: dark)").matches)) { el.classList.add("dark") } else { el.classList.remove("dark") } })();</script>

    <link href="../../../../favicon.png" rel="icon">
    <link href="../../../../resources/css/retype.css?v=3.6.0.796247571474" rel="stylesheet">

    <script data-cfasync="false" src="../../../../resources/js/config.js?v=3.6.0.796247571474" data-turbo-eval="false" defer></script>
    <script data-cfasync="false" src="../../../../resources/js/retype.js?v=3.6.0" data-turbo-eval="false" defer></script>
    <script id="lunr-js" data-cfasync="false" src="../../../../resources/js/lunr.js?v=3.6.0.796247571474" data-turbo-eval="false" defer></script>
    <script id="prism-js" data-cfasync="false" src="../../../../resources/js/prism.js?v=3.6.0.796247571474" defer></script>
</head>
<body>
    <div id="docs-app" class="relative text-base antialiased text-gray-700 bg-white font-body dark:bg-dark-850 dark:text-dark-300">
        <div class="absolute bottom-0 left-0 bg-gray-100 dark:bg-dark-800" style="top: 5rem; right: 50%"></div>
    
        <header id="docs-site-header" class="sticky top-0 z-30 flex w-full h-16 bg-white border-b border-gray-200 md:h-20 dark:bg-dark-850 dark:border-dark-650">
            <div class="container relative flex items-center justify-between pr-6 grow md:justify-start">
                <!-- Mobile menu button skeleton -->
                <button v-cloak class="skeleton docs-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
                <div v-cloak id="docs-sidebar-toggle"></div>
        
                <!-- Logo -->
                <div class="flex items-center justify-between h-full py-2 md:w-75">
                    <div class="flex items-center px-2 md:px-6">
                        <a id="docs-site-logo" href="../../../../" class="flex items-center leading-snug text-xl">
                            <span class="w-10 mr-2 grow-0 shrink-0 overflow-hidden">
                                <img class="max-h-10 dark:hidden md:inline-block" src="../../../../images/attackevals-logo.png">
                                <img class="max-h-10 hidden dark:inline-block" src="../../../../images/attackevals-logo.png">
                            </span>
                            <span class="dark:text-white font-semibold line-clamp-1 md:line-clamp-2">ATTACK Evaluation Library</span>
                        </a>
                    </div>
        
                    <span class="hidden h-8 border-r md:inline-block dark:border-dark-650"></span>
                </div>
        
                <div class="flex justify-between md:grow">
                    <!-- Top Nav -->
                    <nav class="hidden md:flex">
                        <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://attackevals.mitre-engenuity.org">Attack Evaluations</a>
                            </li>
        
                        </ul>
                    </nav>
        
                    <!-- Header Right Skeleton -->
                    <div v-cloak class="flex justify-end grow skeleton">
        
                        <!-- Search input mock -->
                        <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                            <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                            </div>
                            <input class="w-full h-10 placeholder-gray-400 transition-colors duration-200 ease-in bg-gray-200 border border-transparent rounded md:text-sm hover:bg-white hover:border-gray-300 focus:outline-none focus:bg-white focus:border-gray-500 dark:bg-dark-600 dark:border-dark-600 dark:placeholder-dark-400" style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search">
                        </div>
        
                        <!-- Mobile search button -->
                        <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                        </div>
        
                        <!-- Dark mode switch placeholder -->
                        <div class="w-10 h-10 lg:ml-2"></div>
        
                        <!-- History button -->
                        <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                        </div>
                    </div>
        
                    <div v-cloak class="flex justify-end grow">
                        <div id="docs-mobile-search-button"></div>
                        <doc-search-desktop></doc-search-desktop>
        
                        <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                        <doc-history></doc-history>
                    </div>
                </div>
            </div>
        </header>
    
        <div class="container relative flex bg-white">
            <!-- Sidebar Skeleton -->
            <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-gray-100 border-gray-200 sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton dark:bg-dark-800 dark:border-dark-650">
            
                <!-- Render this div, if config.showSidebarFilter is `true` -->
                <div class="flex items-center h-16 px-6">
                    <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-white border border-gray-200 rounded shadow-none text-sm focus:outline-none focus:border-gray-600 dark:bg-dark-600 dark:border-dark-600" type="text" placeholder="Filter">
                </div>
            
                <div class="pl-6 mt-1 mb-4">
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                </div>
            
            </div>
            
            <!-- Sidebar component -->
            <doc-sidebar v-cloak>
                <template #sidebar-footer>
                    <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-dark-650">
            
                        <div class="py-3 px-6 md:hidden border-b dark:border-dark-650">
                            <nav>
                                <ul class="flex flex-wrap justify-center items-center">
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://attackevals.mitre-engenuity.org">Attack Evaluations</a>
                                    </li>
            
                                </ul>
                            </nav>
                        </div>
                    </div>
                </template>
            </doc-sidebar>
    
            <div class="grow min-w-0 dark:bg-dark-850">
                <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
                <div class="flex">
                    <div class="min-w-0 p-4 grow md:px-16">
                        <main class="relative pb-12 lg:pt-2">
                            <div class="docs-markdown" id="docs-content">
                                <!-- Rendered if sidebar right is enabled -->
                                <div id="docs-sidebar-right-toggle"></div>
                                <nav class="breadcrumb" aria-label="Breadcrumb">
                                    <ol role="list">
                                        <li class="pr-4">
                                            <a href="../../../../" class="pr-4">
                                                ATT&​CK Evaluations Library
                                            </a>
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                                                <path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                            </svg>
                                        </li>
                                        <li class="pr-4">
                                            <span class="pr-4">
                                                Enterprise
                                            </span>
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                                                <path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                            </svg>
                                        </li>
                                        <li class="pr-4">
                                            <a href="../../../../enterprise/cl0p/" class="pr-4">
                                                CL​0​P
                                            </a>
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                                                <path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                            </svg>
                                        </li>
                                        <li class="pr-4">
                                            <a href="../../../../enterprise/cl0p/resources/" class="pr-4">
                                                Resources
                                            </a>
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                                                <path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                            </svg>
                                        </li>
                                        <li class="pr-4">
                                            <a href="../../../../enterprise/cl0p/resources/sdbbot/" class="pr-4">
                                                SDB​Bot
                                            </a>
                                        </li>
                                    </ol>
                                </nav>
                
                                <!-- Page content  -->
<doc-anchor-target id="sdbbot" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#sdbbot">#</doc-anchor-trigger>
        <span>SDBBot</span>
    </h1>
</doc-anchor-target>
<p><figure class="content-center">
    <img src="docs/sdbbot.png" alt="SDBBot Diagram">
    <figcaption class="caption">SDBBot Diagram</figcaption>
</figure>
</p>
<p>SDBBot is a multi-stage payload with four primary components:</p>
<ol>
<li><a href="src/installer">Installer</a></li>
<li><a href="src/loader">Loader</a></li>
<li><a href="src/shellcode">Shellcode</a></li>
<li><a href="src/rat/">RAT</a></li>
</ol>
<p>The installer uses the registry to stash the shellcode and lay persistence via
IFEO. Once IFEO triggers the persistence, the loader DLL is executed. It then
retrieves the stashed shellcode and executes it. The shellcode maps the RAT
into memory.</p>
<doc-anchor-target id="installer">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#installer">#</doc-anchor-trigger>
        <span>Installer</span>
    </h2>
</doc-anchor-target>
<p>The SDBBot installer is responsible for laying persistence on a victim host.
It takes the following steps to establish the infection chain:</p>
<ol>
<li>Drops a <a href="src/loader">custom Application Verifier DLL</a> to the configured location.</li>
<li>Drops a symlink in <code v-pre>C:\Windows\System32</code> which points to the verifier DLL.</li>
<li>Registers the symlink as a verifier DLL through <a href="https://learn.microsoft.com/en-us/previous-versions/windows/desktop/xperf/image-file-execution-options" class="outbound" target="_blank"><span>Image File Execution Options</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a>
for the target host process (<code v-pre>winlogon</code> by default).</li>
<li>Registers the PE loading shellcode, later used by the custom verifier DLL,
to an HKLU key.</li>
</ol>
<p>With this persistence in place, the host process will be forced to load the
custom verifier DLL any time a new instance is launched. In the default case
of <code v-pre>winlogon</code>, this will only happen at boot.</p>
<doc-anchor-target id="loader">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#loader">#</doc-anchor-trigger>
        <span>Loader</span>
    </h2>
</doc-anchor-target>
<p>The loader DLL is a custom Application Verifier DLL responsible for retrieving
the PE loading shellcode from the registry and executing it. It takes the
following steps to establish the infection chain:</p>
<ol>
<li>Once a process configured to use the loader DLL as an IFEO <code v-pre>VerifierDLL</code> is
instantiated, the OS will force the loader DLL to be loaded into it.</li>
<li>Uses the Application Verifier mechanisms to place an IAT hook on
<code v-pre>NtSetProcessInformation</code>. Later, this IAT hook will call an export from the
RAT DLL.</li>
<li>Verifier DLLs have a special <code v-pre>DllMain</code> reason code that is called early in
loading process. At this time, the loader DLL retrieves the PE loading
shellcode from the registry and executes it. At this point the RAT DLL is
mapped into memory but not yet running.</li>
<li>Once the shellcode runs successfully the loader DLL will wipe and free it.
This is the last step that takes place at early load.</li>
<li>Once the process starts normal execution (fully loaded) and
<code v-pre>NtSetProcessInformation</code> is called, the hook creates a new thread passing the
RAT execution.</li>
</ol>
<doc-anchor-target id="shellcode">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#shellcode">#</doc-anchor-trigger>
        <span>Shellcode</span>
    </h2>
</doc-anchor-target>
<p>The loader shellcode is a PE loader implemented in position-independent code.
Essentially it is a custom version of sRDI tailored for the early load event
of Application Verifier DLLs. It takes the following steps to establish the
infection chain:</p>
<ol>
<li>Self extracts the embedded RAT DLL.</li>
<li>Loads the RAT on top of the signed decoy DLL specified
(<code v-pre>setupapi.dll</code> by default).</li>
<li>Updates the Process Environment Block to have the correct entrypoint for
the RAT.</li>
<li>Returns some information to the loader DLL.</li>
</ol>
<p>In contrast to sRDI, the PE loader shellcode does <em>not</em> call the RAT&#x27;s
<code v-pre>DllMain</code> function. Rather, since the shellcode is executed prior to the
OS initializing dependencies we just update the PEB and let the OS call
<code v-pre>DllMain</code> on our behalf. The loader DLL is then responsible for executing the
RAT&#x27;s primary export.</p>
<doc-anchor-target id="rat">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#rat">#</doc-anchor-trigger>
        <span>RAT</span>
    </h2>
</doc-anchor-target>
<p>The RAT is the final stage of the SDBBot infection. It is responsible for
maintaining a channel with the C2 server and executing post-exploitation
commands. On startup, the RAT will attempt to create a named mutex to ensure
that only one instance of the RAT is running. If the mutex creation fails,
the RAT will exit.</p>
<ul>
<li>The RAT will perform initial discovery actions by capturing the following information and returning it to the C2:
<ul>
<li>Domain name</li>
<li>Computer name</li>
<li>Username</li>
<li>Country code</li>
<li>Windows version</li>
<li>If the user is an administrator or not</li>
</ul>
</li>
<li>The RAT is capable of downloading, uploading and deleting files and running custom processes on the victim computer</li>
</ul>
<doc-anchor-target id="packet-structure">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#packet-structure">#</doc-anchor-trigger>
        <span>Packet Structure</span>
    </h3>
</doc-anchor-target>
<doc-anchor-target id="tasking-packet">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#tasking-packet">#</doc-anchor-trigger>
        <span>Tasking Packet</span>
    </h4>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-json"><code v-pre class="language-json">{
&quot;header&quot;:&quot;0xC0DE0000&quot;,   // string
&quot;command&quot;:(Command Value),    // int
&quot;Other/requirements&quot;:&quot;(file paths, target executables, etc.)&quot;    // string
}</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="task-createdownload-file-from-c2">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#task-createdownload-file-from-c2">#</doc-anchor-trigger>
        <span>Task Create/Download file FROM C2</span>
    </h4>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-json"><code v-pre class="language-json">{
&quot;header&quot;:&quot;0xC0DE0000&quot;,   // string
&quot;command&quot;:15, // int
&quot;filePath&quot;:&quot;path/to/file/destination&quot;, // string
&quot;fileContents&quot;:&quot;Base64 encoded file content&quot;,  // string
}</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="task-upload-file-to-c2">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#task-upload-file-to-c2">#</doc-anchor-trigger>
        <span>Task Upload File TO C2</span>
    </h4>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-json"><code v-pre class="language-json">{
&quot;header&quot;:&quot;0xC0DE0000&quot;,   // string
&quot;command&quot;:24, // int
&quot;filePath&quot;:&quot;path/to/file/destination&quot;, // string
}</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="task-delete-file-from-disk">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#task-delete-file-from-disk">#</doc-anchor-trigger>
        <span>Task Delete File From Disk</span>
    </h4>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-json"><code v-pre class="language-json">{
&quot;header&quot;:&quot;0xC0DE0000&quot;,   // string
&quot;command&quot;:26, // int
&quot;filePath&quot;:&quot;path/to/file/destination&quot;, // string
}</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="task-execute-a-command">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#task-execute-a-command">#</doc-anchor-trigger>
        <span>Task Execute a Command</span>
    </h4>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-json"><code v-pre class="language-json">{
&quot;header&quot;:&quot;0xC0DE0000&quot;,   // string
&quot;command&quot;:2,  // int
&quot;execute&quot;:&quot;command to execute&quot;,   // string

}</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="implant-response-packet">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#implant-response-packet">#</doc-anchor-trigger>
        <span>Implant Response Packet</span>
    </h4>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-json"><code v-pre class="language-json">{
&quot;header&quot;:&quot;0xC0DE0000&quot;,   // string
&quot;command&quot;:&quot;(Command Value)&quot;,    // string
&quot;response&quot;:&quot;(command output, file data, etc.)&quot; // string
}</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="implant-recon-packet">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#implant-recon-packet">#</doc-anchor-trigger>
        <span>Implant Recon Packet</span>
    </h4>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-json"><code v-pre class="language-json">{
&quot;header&quot;:&quot;0xC0DE0000&quot;,   // string
&quot;command&quot;:&quot;42&quot;  //string
&quot;ver&quot;:&quot;2.0&quot;,  // string
&quot;domain&quot;:&quot;Domain name&quot;,  // string
&quot;pc&quot;:&quot;Computer name&quot;,    // string
&quot;geo&quot;:&quot;two letter country code&quot;,  // string
&quot;os&quot;:&quot;OS Build info&quot;, // string
&quot;rights&quot;:&quot;admin&quot;/&quot;user&quot;, // string
&quot;proxyenabled&quot;:0,  // boolean
}</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="packet-encryption">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#packet-encryption">#</doc-anchor-trigger>
        <span>Packet Encryption</span>
    </h4>
</doc-anchor-target>
<p>Encryption can be toggled on/off using the CmakePresets setting <code v-pre>RAT_ENCRYPT_COMMS</code>. The key used
for encryption is located at <code v-pre>Settings::key</code> in <code v-pre>settings.cpp</code>.
Encryption consists of:</p>
<ul>
<li>XORing the payload data (string)</li>
<li>Then Base64 encoding that string</li>
</ul>
<doc-anchor-target id="loggingtroubleshooting">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#loggingtroubleshooting">#</doc-anchor-trigger>
        <span>Logging/Troubleshooting</span>
    </h3>
</doc-anchor-target>
<p>When compiled in debug mode, the SDBBot RAT will create a log file in the image execution directory. The log file name is <code v-pre>mswinsdr64.log</code>.</p>
<doc-anchor-target id="decoding-the-log-file">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#decoding-the-log-file">#</doc-anchor-trigger>
        <span>Decoding the log file</span>
    </h4>
</doc-anchor-target>
<p>The log file is base64 encoded and XOR encrypted. The log file decryptor can be found here: <a href="../log_decryptor/">log_decryptor</a></p>
<p>The XOR key used to decrypt the log file is <code v-pre>0x0F, 0x00, 0x00, 0x0D</code>:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">python3 aes_base64_log_decryptor.py -i mswinsdr64.log -o dec_mswinsdr64.log -k 0F00000D --xor</code></pre>
</doc-codeblock></div>
<p>View the contents of the decrypted log file:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">cat dec_mswinsdr64.log</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="integration-test">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#integration-test">#</doc-anchor-trigger>
        <span>Integration Test</span>
    </h3>
</doc-anchor-target>
<p>TCP integration test located at <a href="tests/scripts/integration_test.ps1">integration_test.ps1</a>. You can run the test with the following command:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">.\integration_test.ps1</code></pre>
</doc-codeblock></div>
<p>The test will start a TCP listener on port 443 and wait for a connection, then send back a response.</p>
<doc-anchor-target id="build">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#build">#</doc-anchor-trigger>
        <span>Build <span class="docs-emoji">&#x1F3D7;&#xFE0F;</span></span>
    </h2>
</doc-anchor-target>
<p>SDBBot can be built in Debug or Release mode using the included
<code v-pre>CMakePreset.json</code> configurations.</p>
<doc-anchor-target id="dependencies">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#dependencies">#</doc-anchor-trigger>
        <span>Dependencies</span>
    </h3>
</doc-anchor-target>
<ul>
<li><code v-pre>CMake</code> version <code v-pre>3.26</code></li>
<li><code v-pre>CMakePresets.json</code> version <code v-pre>6</code> support (Visual Studio 17.7)</li>
</ul>
<doc-anchor-target id="quickstart">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#quickstart">#</doc-anchor-trigger>
        <span>Quickstart</span>
    </h3>
</doc-anchor-target>
<doc-anchor-target id="command-line">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#command-line">#</doc-anchor-trigger>
        <span>Command Line</span>
    </h4>
</doc-anchor-target>
<p>Build both Debug and Release configurations of SDBBot.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">cd cl0p/Resources/sdbbot
cmake.exe --workflow --preset cicd-debug
cmake.exe --workflow --preset cicd-release</code></pre>
</doc-codeblock></div>
<p>For simplicity, all of the generated artifacts can be bundled into the
top-level <code v-pre>install/</code> directory using the CMake installation facility.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">cmake.exe --install ./build --config release
cmake.exe --install ./build --config debug</code></pre>
</doc-codeblock></div>
<p><code v-pre>./install/Release/installer.dll</code> is the production payload for
SDBBot. <code v-pre>installer-runner.exe</code> will load the installer DLL and call its
export for simplified testing.</p>
<p>The remaining artifacts are simply for debugging and archival purposes. For
more information see the <doc-anchor-trigger to="#artifacts">Install section</doc-anchor-trigger></p>
<doc-anchor-target id="configuration">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#configuration">#</doc-anchor-trigger>
        <span>Configuration</span>
    </h3>
</doc-anchor-target>
<p>SDBBot has several CMake options available to change the compile-time
configuration of SDBBot. These options reside in the
<a href="cmake/sdbbot.cmake">SDBBot CMake configuration file</a>, and can be toggled in
<code v-pre>CMakePresets.json</code> using <code v-pre>cacheVariables</code>.</p>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th><strong>Variable</strong></th>
<th><strong>Default</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>INSTALLER_STUB_LOADER</td>
<td>OFF</td>
<td>Installer uses the stub version of the loader</td>
</tr>
<tr>
<td>INSTALLER_STUB_SHELLCODE</td>
<td>OFF</td>
<td>Installer uses the stub version of the shellcode</td>
</tr>
<tr>
<td>LOADER_STUB_INSTALLER</td>
<td>OFF</td>
<td>Loader uses the stub version of the installer</td>
</tr>
<tr>
<td>LOADER_STUB_SHELLCODE</td>
<td>OFF</td>
<td>Loader uses the stub version of the shellcode</td>
</tr>
<tr>
<td>SHELLCODE_STUB_RAT</td>
<td>OFF</td>
<td>Shellcode uses the stub version of the RAT</td>
</tr>
<tr>
<td>RAT_HOST_DLL</td>
<td>setupapi</td>
<td>DLL which the RAT will be overwritten on</td>
</tr>
<tr>
<td>RAT_HOST_DLL_EXPORT</td>
<td>SetupAddToSourceListW</td>
<td>Dummy export used to trigger host DLL linkage</td>
</tr>
<tr>
<td>LOADER_SHELLCODE_KEY</td>
<td>skw</td>
<td>Registry key where PE loader shellcode will be stashed</td>
</tr>
<tr>
<td>LOADER_SHELLCODE_VALUE</td>
<td>d</td>
<td>Registry key value containing PE loader shellcode</td>
</tr>
<tr>
<td>LOADER_SHELLCODE_DATA</td>
<td>0xcc,0xc3</td>
<td>Stub shellcode for testing (breakpoint then return)</td>
</tr>
<tr>
<td>IFEO_TARGET_PROCESS</td>
<td>winlogon.exe</td>
<td>IFEO injected persistence process</td>
</tr>
<tr>
<td>IFEO_FILTER_FULL_PATH</td>
<td>C:\\Windows\\System32\\winlogon.exe</td>
<td>Full path to the persistence process</td>
</tr>
<tr>
<td>LOADER_DROP_PATH</td>
<td>C:\\Windows\\temp\\tmp8AB2.tmp</td>
<td>Drop path for the loader DLL</td>
</tr>
<tr>
<td>LOADER_SYMLINK</td>
<td>msverload.dll</td>
<td>Name of the symlink that will redirect to loader DLL</td>
</tr>
<tr>
<td>RAT_ENCRYPT_COMMS</td>
<td>ON</td>
<td>Encrypt RAT communication</td>
</tr>
<tr>
<td>RAT_C2_IP_ADDRESS</td>
<td>223.246.0.70</td>
<td>C2 IP address for RAT</td>
</tr>
<tr>
<td>RAT_C2_PORT</td>
<td>8080</td>
<td>C2 TCP port for RAT</td>
</tr>
<tr>
<td>RAT_PACKET_HEADER</td>
<td>0x0000000F</td>
<td>C2 RAT packet headers</td>
</tr>
</tbody>
</table>
</div>
<doc-anchor-target id="build-presets">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#build-presets">#</doc-anchor-trigger>
        <span>Build Presets</span>
    </h3>
</doc-anchor-target>
<doc-anchor-target id="command-line-1">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#command-line-1">#</doc-anchor-trigger>
        <span>Command Line</span>
    </h4>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">cmake.exe --build --preset release # Or debug</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="visual-studio">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#visual-studio">#</doc-anchor-trigger>
        <span>Visual Studio</span>
    </h4>
</doc-anchor-target>
<p>After selecting the release configuration preset:
<code v-pre>Build -&gt; Build All</code></p>
<p><figure class="content-center">
    <img src="docs/build.png" alt="Build All screenshot">
    <figcaption class="caption">Build All screenshot</figcaption>
</figure>
</p>
<doc-anchor-target id="install">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#install">#</doc-anchor-trigger>
        <span>Install <span class="docs-emoji">&#x1F4E6;</span></span>
    </h2>
</doc-anchor-target>
<p>Installing SDBBot simply copies all of the artifacts from both Release
and Debug builds into the top-level <code v-pre>install/</code> directory. This is simply for
ease of use and distribution.</p>
<p>The final product should be a top-level directory named <code v-pre>install/</code> with the
following layout:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">
sdbbot/
├─ install/
   ├─ Debug/
   │  ├─ alternative-loader.dll
   │  ├─ alternative-loader.lib
   │  ├─ alternative-loader.pdb
   │  ├─ installer-runner.exe
   │  ├─ installer-runner.pdb
   │  ├─ installer.dll
   │  ├─ installer.lib
   │  ├─ installer.pdb
   │  ├─ loader-runner.exe
   │  ├─ loader-runner.pdb
   │  ├─ loader.dll
   │  ├─ loader.lib
   │  ├─ loader.pdb
   │  ├─ rat-runner.exe
   │  ├─ rat-runner.pdb
   │  ├─ rat.dll
   │  ├─ rat.lib
   │  ├─ rat.pdb
   │  ├─ shellcode-blob.bin
   │  ├─ shellcode-runner.exe
   │  ├─ shellcode-runner.pdb
   │  ├─ shellcode.exe
   │  ├─ shellcode.pdb
   ├─ Release/
      ├─ installer-runner.exe
      ├─ installer.dll
      ├─ installer.lib
      ├─ loader-runner.exe
      ├─ msverload.dll
      ├─ msverload.lib
      ├─ msverload_alt.dll
      ├─ msverload_alt.lib
      ├─ rat-runner.exe
      ├─ setupapi.dll
      ├─ setupapi.lib
      ├─ shellcode-blob.bin
      ├─ shellcode-runner.exe
      ├─ shellcode.exe</code></pre>
</doc-codeblock></div>
<div class="flex mb-6">
    <div class="shrink-0 w-1 rounded-tl rounded-bl bg-blue-300"></div>
    <div class="flex w-full py-4 border border-l-0 border-gray-300 rounded-tr rounded-br doc-alert bg-white dark:bg-dark-700 dark:border-dark-700" role="alert">
        <div class="flex items-center ml-4 h-7">
            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px text-blue-300" width="22" height="22" viewBox="0 0 24 24" role="presentation">
                <g fill="currentColor"><g>
                    <path d="M12 1C5.93 1 1 5.93 1 12s4.93 11 11 11 11-4.93 11-11S18.07 1 12 1zm0 20c-4.96 0-9-4.04-9-9s4.04-9 9-9 9 4.04 9 9-4.04 9-9 9z"></path>
                    <path d="M12 11c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1s1-.45 1-1v-4c0-.55-.45-1-1-1zM12.01 7c-.56 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path>
                    <path fill="none" d="M0 0h24v24H0z"></path>
                </g></g>
            </svg>
        </div>
        <div class="pr-5 ml-3 w-full">
            <h5>Important</h5>
<p>There are some differences in the functionality of SDBBot between Release
and Debug configurations. Please read the
<doc-anchor-trigger to="#troubleshoot-">Troubleshoot section</doc-anchor-trigger> for more information.</p>
        </div>
    </div>
</div>
<doc-anchor-target id="artifacts">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#artifacts">#</doc-anchor-trigger>
        <span>Artifacts</span>
    </h3>
</doc-anchor-target>
<ul>
<li><code v-pre>installer.dll</code> is the SDBBot persistence installer</li>
<li><code v-pre>installer-runner.exe</code> is a convenience runner for the installer DLL</li>
<li><code v-pre>msverload.dll</code> is the custom Application Verifier DLL</li>
<li><code v-pre>loader-runner.exe</code> is a convenience runner for the custom Application Verifier DLL</li>
<li><code v-pre>setupapi.dll</code> is the RAT DLL</li>
<li><code v-pre>rat-runner.exe</code> is a convenience runner for the RAT DLL</li>
<li><code v-pre>shellcode-runner.exe</code> is a convenience runner for the PE loader shellcode</li>
<li><code v-pre>shellcode-blob.bin</code> is the PE loader shellcode, with the RAT DLL embedded, and a plaintext prefix</li>
<li><code v-pre>msverload_alt.dll</code> is a standalone version of the custom Application Verifier DLL that can run via <code v-pre>rundll32</code></li>
</ul>
<div class="flex mb-6">
    <div class="shrink-0 w-1 rounded-tl rounded-bl bg-blue-500 dark:bg-blue-400"></div>
    <div class="flex w-full py-4 border border-l-0 border-gray-300 rounded-tr rounded-br doc-alert bg-white dark:bg-dark-700 dark:border-dark-700" role="alert">
        <div class="flex items-center ml-4 h-7">
            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px text-blue-500 dark:text-blue-400" width="22" height="22" viewBox="0 0 24 24" role="presentation">
                <g fill="currentColor"><g>
                    <path d="M12 1C5.93 1 1 5.93 1 12s4.93 11 11 11 11-4.93 11-11S18.07 1 12 1zm0 20c-4.96 0-9-4.04-9-9s4.04-9 9-9 9 4.04 9 9-4.04 9-9 9z"></path>
                    <path d="M12 11c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1s1-.45 1-1v-4c0-.55-.45-1-1-1zM12.01 7c-.56 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path>
                    <path fill="none" d="M0 0h24v24H0z"></path>
                </g></g>
            </svg>
        </div>
        <div class="pr-5 ml-3 w-full">
            <h5>Note</h5>
<p>The release version of several components have different names than their
debug version counterparts. This is to reduce any compilation artifacts
which leak the development naming scheme.</p>
        </div>
    </div>
</div>
<doc-anchor-target id="command-line-2">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#command-line-2">#</doc-anchor-trigger>
        <span>Command Line</span>
    </h4>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">cmake.exe --install ./build</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="visual-studio-1">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#visual-studio-1">#</doc-anchor-trigger>
        <span>Visual Studio</span>
    </h4>
</doc-anchor-target>
<p><code v-pre>Build -&gt; Install SDBBot</code></p>
<p><figure class="content-center">
    <img src="docs/build.png" alt="Build screenshot">
    <figcaption class="caption">Build screenshot</figcaption>
</figure>
</p>
<doc-anchor-target id="test">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#test">#</doc-anchor-trigger>
        <span>Test <span class="docs-emoji">&#x1F9EA;</span></span>
    </h2>
</doc-anchor-target>
<p>The included <doc-anchor-trigger to="#command-line">CMake workflows</doc-anchor-trigger> will build and test SDBBot with a
single command. This section details how to run tests independently from the
build process.</p>
<doc-anchor-target id="tools">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#tools">#</doc-anchor-trigger>
        <span>Tools</span>
    </h3>
</doc-anchor-target>
<p>SDBBot includes runners to test each layer of the final payload independently:</p>
<ul>
<li><code v-pre>installer-runner.exe</code> executes the installer DLL&#x27;s export directly</li>
<li><code v-pre>loader-runner.exe</code> executes the custom Application Verifier DLL&#x27;s export directly</li>
<li><code v-pre>rat-runner.exe</code> executes the RAT DLL&#x27;s export directly</li>
<li><code v-pre>rat-shellcode-runner.exe</code> executes the RAT DLL as an sRDI payload to check for shellcode loader incompatibilities</li>
<li><code v-pre>shellcode-runner.exe</code> executes the shellcode PE loader with the embedded RAT</li>
</ul>
<doc-anchor-target id="command-line-3">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#command-line-3">#</doc-anchor-trigger>
        <span>Command Line</span>
    </h4>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">ctest.exe --preset all</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="visual-studio-2">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#visual-studio-2">#</doc-anchor-trigger>
        <span>Visual Studio</span>
    </h4>
</doc-anchor-target>
<p><code v-pre>Test -&gt; Run test preset for SDBBot -&gt; all</code></p>
<p><figure class="content-center">
    <img src="docs/test.png" alt="Test screenshot">
    <figcaption class="caption">Test screenshot</figcaption>
</figure>
</p>
<p><code v-pre>Test Explorer</code> can also be used however test discovery can be unreliable
without a fresh build.</p>
<p><figure class="content-center">
    <img src="docs/test-explorer.png" alt="Test Explorer screenshot">
    <figcaption class="caption">Test Explorer screenshot</figcaption>
</figure>
</p>
<doc-anchor-target id="troubleshoot">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#troubleshoot">#</doc-anchor-trigger>
        <span>Troubleshoot <span class="docs-emoji">&#x1F914;</span></span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="logs">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#logs">#</doc-anchor-trigger>
        <span>Logs</span>
    </h3>
</doc-anchor-target>
<blockquote>
<p>[!Note]
Release versions of components will not drop a log file. For troubleshooting
scenarios, consider using the debug version of a component to make use of
symbols and logs.</p>
</blockquote>
<p>Some components will drop encrypted logs in their current working directory.
These logs can be used to trace execution at critical junctures and narrow
down issues.</p>
<doc-anchor-target id="test-tools">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#test-tools">#</doc-anchor-trigger>
        <span>Test Tools</span>
    </h3>
</doc-anchor-target>
<p>The included <doc-anchor-trigger to="#tools">test runners and payloads</doc-anchor-trigger> can be used to narrow down
issues. For example if there is an issue with the RAT, consider first
validating the RAT&#x27;s execution as a normal DLL using the <code v-pre>rat-runner</code>. If the
issue is reproducible the root cause can be assumed to be in the RAT itself.
Otherwise, the issue is likely due to an issue with the loader. The
<code v-pre>rat-shellcode-runner</code> and <code v-pre>shellcode-runner</code> can then be used to further
examine loader incompatibilities.</p>
<p>Runner targets are located in the <a href="tests/runners">tests directory</a>.</p>
<doc-anchor-target id="stubs">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#stubs">#</doc-anchor-trigger>
        <span>Stubs</span>
    </h3>
</doc-anchor-target>
<p>This project includes a number of stubs that were used early in development
for dependency isolation. These stubs may come in handy for further
development or troubleshooting. Consult the <a href="cmake/sdbbot.cmake">SDBBot CMake configuration</a>
file for more information.</p>
<p>Stub targets are located in the <a href="tests/stubs">tests directory</a>.</p>
<doc-anchor-target id="cti">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#cti">#</doc-anchor-trigger>
        <span>CTI <span class="docs-emoji">&#x1F4C4;</span></span>
    </h2>
</doc-anchor-target>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Reports</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://sensepost.com/blog/2020/masquerading-windows-processes-like-a-doubleagent./" class="outbound" target="_blank"><span>APT10: Tracking down the stealth activity of the A41APT campaign</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td><a href="https://www.proofpoint.com/us/threat-insight/post/ta505-distributes-new-sdbbot-remote-access-trojan-get2-downloader" class="outbound" target="_blank"><span>TA505 Distributes New SDBbot Remote Access Trojan with Get2 Downloader</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td><a href="https://securityintelligence.com/posts/ta505-continues-to-infect-networks-with-sdbbot-rat/" class="outbound" target="_blank"><span>TA505 Continues to Infect Networks With SDBbot RAT</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td><a href="https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/SDBOT" class="outbound" target="_blank"><span>Threat Encyclopedia</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td><a href="https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-clop" class="outbound" target="_blank"><span>Ransomware Spotlight: Clop</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td><a href="https://www.cybereason.com/blog/research/cybereason-vs.-clop-ransomware" class="outbound" target="_blank"><span>Cyberreason vs. Cl0p Ransomware</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
</tbody>
</table>
</div>
<doc-anchor-target id="references">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#references">#</doc-anchor-trigger>
        <span>References <span class="docs-emoji">&#x1F4DD;</span></span>
    </h2>
</doc-anchor-target>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Description</th>
<th>URL</th>
</tr>
</thead>
<tbody>
<tr>
<td>Application Verifier Custom Providers</td>
<td><a href="https://github.com/namazso/SecureUxTheme/blob/master/AVRF.md" class="outbound" target="_blank"><span>namazso/SecureUxTheme</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>C++ to Shellcode</td>
<td><a href="https://github.com/robleh/assemblyline" class="outbound" target="_blank"><span>robleh/assemblyline</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>Module Overloading</td>
<td><a href="https://github.com/hasherezade/module_overloading" class="outbound" target="_blank"><span>hasherezade/module_overloading</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>Module Overloading</td>
<td><a href="https://github.com/TheWover/donut" class="outbound" target="_blank"><span>TheWover/donut</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>PE Loader</td>
<td><a href="https://github.com/monoxgas/srdi" class="outbound" target="_blank"><span>monoxgas/sRDI</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>Application Verifier</td>
<td><a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/devtest/application-verifier" class="outbound" target="_blank"><span>Microsoft</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
<tr>
<td>Application Verifier</td>
<td><a href="https://sensepost.com/blog/2020/masquerading-windows-processes-like-a-doubleagent./" class="outbound" target="_blank"><span>Sensepost</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></td>
</tr>
</tbody>
</table>
</div>
<doc-anchor-target id="artifacts-removed">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#artifacts-removed">#</doc-anchor-trigger>
        <span>Artifacts removed</span>
    </h3>
</doc-anchor-target>
<ul>
<li>SDBBot log <code v-pre>mswinsdr64.log</code></li>
<li>CL0P log <code v-pre>Favbug.txt</code></li>
</ul>

                                
                                <!-- Required only on API pages -->
                                <doc-toolbar-member-filter-no-results></doc-toolbar-member-filter-no-results>
                            </div>
                            <footer class="clear-both">
                            
                                <nav class="flex mt-14">
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 h-full flex items-center break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-l-lg transition-colors duration-150 relative hover:z-5" href="../../../../enterprise/cl0p/resources/setup/traffic-redirection/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                            <span>
                                                <span class="block text-xs font-normal text-gray-400 dark:text-dark-400">Previous</span>
                                                <span class="block mt-1">Traffic Redirectors</span>
                                            </span>
                                        </a>
                                    </div>
                            
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 -mx-px h-full flex items-center justify-end break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-r-lg transition-colors duration-150 relative hover:z-5" href="../../../../enterprise/cl0p/resources/sdbbot/src/rat/">
                                            <span>
                                                <span class="block text-xs font-normal text-right text-gray-400 dark:text-dark-400">Next</span>
                                                <span class="block mt-1">Rat</span>
                                            </span>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19.92 12.38a1 1 0 00-.22-1.09l-7-7a.996.996 0 10-1.41 1.41l5.3 5.3H5c-.55 0-1 .45-1 1s.45 1 1 1h11.59l-5.29 5.29a.996.996 0 000 1.41c.19.2.44.3.7.3s.51-.1.71-.29l7-7c.09-.09.16-.21.21-.33z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        </a>
                                    </div>
                                </nav>
                            </footer>
                        </main>
                
                        <div class="border-t dark:border-dark-650 pt-6 mb-8">
                            <footer class="flex flex-wrap items-center justify-between">
                                <div>
                                    <ul class="flex flex-wrap items-center text-sm">
                                        <li>
                                            <a class="inline-flex items-center mr-4 py-2 text-sm whitespace-nowrap transition-colors duration-200 ease-linear text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 md:mb-0" href="https://github.com/attackevals/ael">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                                    <g fill="currentColor">
                                                        <symbol id="mark-github-icon-symbol" viewBox="0 0 16 16"><path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"/></symbol><use xlink:href="#mark-github-icon-symbol" />
                                                    </g>
                                                </svg>
                                                <span>ATTACK Evaluations Library GitHub</span>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="docs-copyright py-2 text-gray-500 dark:text-dark-350 text-sm leading-relaxed"><p>© Copyright 2025. All rights reserved.</p></div>
                            </footer>
                        </div>
                    </div>
                
                    <!-- Rendered if sidebar right is enabled -->
                    <!-- Sidebar right skeleton-->
                    <div v-cloak class="fixed top-0 bottom-0 right-0 translate-x-full bg-white border-gray-200 lg:sticky lg:border-l lg:shrink-0 lg:pt-6 lg:transform-none sm:w-1/2 lg:w-64 lg:z-0 md:w-104 sidebar-right skeleton dark:bg-dark-850 dark:border-dark-650">
                        <div class="pl-5">
                            <div class="w-32 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-48 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-40 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                        </div>
                    </div>
                
                    <!-- User should be able to hide sidebar right -->
                    <doc-sidebar-right v-cloak></doc-sidebar-right>
                </div>

            </div>
        </div>
    
        <doc-search-mobile></doc-search-mobile>
        <doc-back-to-top></doc-back-to-top>
    </div>


    <div id="docs-overlay-target"></div>

    <script data-cfasync="false">window.__DOCS__ = { "title": "SDBBot", level: 4, icon: "file", hasPrism: true, hasMermaid: false, hasMath: false, tocDepth: 23 }</script>
</body>
</html>
